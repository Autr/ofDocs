{"data":[{"page":{"entry":{"name":"ofNoise.h","filename":"ofNoise.h","absolute":"/Users/Gilbert/Code/openFrameworks/libs/openFrameworks/utils/ofNoise.h","path":"/openframeworks/utils/ofNoise_h","route":"/openframeworks/utils/ofNoise.h","dir":"../libs/openFrameworks/utils","ext":"h","type":"source","id":340,"parent":329,"breadcrumbs":[329,195],"siblings":[],"translations":{}},"document":"<span class=\"token macro property\">#<span class=\"token directive keyword\">pragma</span> once</span>\n\n\n<span class=\"token comment\" spellcheck=\"true\">/*\n * Mesa 3-D graphics library\n * Version:  6.5\n *\n * Copyright (C) 2006  Brian Paul   All Rights Reserved.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included\n * in all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n * OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL\n * BRIAN PAUL BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN\n * AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n */</span>\n\n<span class=\"token comment\" spellcheck=\"true\">/*\n * SimplexNoise1234\n * Copyright (c) 2003-2005, Stefan Gustavson\n *\n * Contact: stegu@itn.liu.se\n */</span>\n\n<span class=\"token comment\" spellcheck=\"true\">/** \\file\n    \\brief C implementation of Perlin Simplex Noise over 1,2,3, and 4 dimensions.\n    \\author Stefan Gustavson (stegu@itn.liu.se)\n*/</span>\n\n<span class=\"token comment\" spellcheck=\"true\">/*\n * This implementation is \"Simplex Noise\" as presented by\n * Ken Perlin at a relatively obscure and not often cited course\n * session \"Real-Time Shading\" at Siggraph 2001 (before real\n * time shading actually took on), under the title \"hardware noise\".\n * The 3D function is numerically equivalent to his Java reference\n * code available in the PDF course notes, although I re-implemented\n * it from scratch to get more readable code. The 1D, 2D and 4D cases\n * were implemented from scratch by me from Ken Perlin's text.\n *\n * This file has no dependencies on any other file, not even its own\n * header file. The header file is made for use by external code only.\n */</span>\n\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> OFNOISE_FASTFLOOR(x) ( ((x)>0) ? ((int)x) : (((int)x)-1) )</span>\n\n<span class=\"token comment\" spellcheck=\"true\">/*\n * ---------------------------------------------------------------------\n * inline data\n */</span>\n\n<span class=\"token comment\" spellcheck=\"true\">/*\n * Permutation table. This is just a random jumble of all numbers 0-255,\n * repeated twice to avoid wrapping the index at 255 for each lookup.\n * This needs to be exactly the same for all instances on all platforms,\n * so it's easiest to just keep it as inline explicit data.\n * This also removes the need for any initialisation of this class.\n *\n * Note that making this an int[] instead of a char[] might make the\n * code run faster on platforms with a high penalty for unaligned single\n * byte addressing. Intel x86 is generally single-byte-friendly, but\n * some other CPUs are faster with 4-aligned reads.\n * However, a char[] is smaller, which avoids cache trashing, and that\n * is probably the most important aspect on most architectures.\n * This array is accessed a *lot* by the noise functions.\n * A vector-valued noise over 3D accesses it 96 times, and a\n * float-valued 4D noise 64 times. We want this to fit in the cache!\n */</span>\n<span class=\"token keyword\">namespace</span><span class=\"token punctuation\">{</span>\n<span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">char</span> perm<span class=\"token punctuation\">[</span><span class=\"token number\">512</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token number\">151</span><span class=\"token punctuation\">,</span><span class=\"token number\">160</span><span class=\"token punctuation\">,</span><span class=\"token number\">137</span><span class=\"token punctuation\">,</span><span class=\"token number\">91</span><span class=\"token punctuation\">,</span><span class=\"token number\">90</span><span class=\"token punctuation\">,</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span>\n  <span class=\"token number\">131</span><span class=\"token punctuation\">,</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span><span class=\"token number\">201</span><span class=\"token punctuation\">,</span><span class=\"token number\">95</span><span class=\"token punctuation\">,</span><span class=\"token number\">96</span><span class=\"token punctuation\">,</span><span class=\"token number\">53</span><span class=\"token punctuation\">,</span><span class=\"token number\">194</span><span class=\"token punctuation\">,</span><span class=\"token number\">233</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">225</span><span class=\"token punctuation\">,</span><span class=\"token number\">140</span><span class=\"token punctuation\">,</span><span class=\"token number\">36</span><span class=\"token punctuation\">,</span><span class=\"token number\">103</span><span class=\"token punctuation\">,</span><span class=\"token number\">30</span><span class=\"token punctuation\">,</span><span class=\"token number\">69</span><span class=\"token punctuation\">,</span><span class=\"token number\">142</span><span class=\"token punctuation\">,</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span><span class=\"token number\">99</span><span class=\"token punctuation\">,</span><span class=\"token number\">37</span><span class=\"token punctuation\">,</span><span class=\"token number\">240</span><span class=\"token punctuation\">,</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">23</span><span class=\"token punctuation\">,</span>\n  <span class=\"token number\">190</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">148</span><span class=\"token punctuation\">,</span><span class=\"token number\">247</span><span class=\"token punctuation\">,</span><span class=\"token number\">120</span><span class=\"token punctuation\">,</span><span class=\"token number\">234</span><span class=\"token punctuation\">,</span><span class=\"token number\">75</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">26</span><span class=\"token punctuation\">,</span><span class=\"token number\">197</span><span class=\"token punctuation\">,</span><span class=\"token number\">62</span><span class=\"token punctuation\">,</span><span class=\"token number\">94</span><span class=\"token punctuation\">,</span><span class=\"token number\">252</span><span class=\"token punctuation\">,</span><span class=\"token number\">219</span><span class=\"token punctuation\">,</span><span class=\"token number\">203</span><span class=\"token punctuation\">,</span><span class=\"token number\">117</span><span class=\"token punctuation\">,</span><span class=\"token number\">35</span><span class=\"token punctuation\">,</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span><span class=\"token number\">57</span><span class=\"token punctuation\">,</span><span class=\"token number\">177</span><span class=\"token punctuation\">,</span><span class=\"token number\">33</span><span class=\"token punctuation\">,</span>\n  <span class=\"token number\">88</span><span class=\"token punctuation\">,</span><span class=\"token number\">237</span><span class=\"token punctuation\">,</span><span class=\"token number\">149</span><span class=\"token punctuation\">,</span><span class=\"token number\">56</span><span class=\"token punctuation\">,</span><span class=\"token number\">87</span><span class=\"token punctuation\">,</span><span class=\"token number\">174</span><span class=\"token punctuation\">,</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span><span class=\"token number\">125</span><span class=\"token punctuation\">,</span><span class=\"token number\">136</span><span class=\"token punctuation\">,</span><span class=\"token number\">171</span><span class=\"token punctuation\">,</span><span class=\"token number\">168</span><span class=\"token punctuation\">,</span> <span class=\"token number\">68</span><span class=\"token punctuation\">,</span><span class=\"token number\">175</span><span class=\"token punctuation\">,</span><span class=\"token number\">74</span><span class=\"token punctuation\">,</span><span class=\"token number\">165</span><span class=\"token punctuation\">,</span><span class=\"token number\">71</span><span class=\"token punctuation\">,</span><span class=\"token number\">134</span><span class=\"token punctuation\">,</span><span class=\"token number\">139</span><span class=\"token punctuation\">,</span><span class=\"token number\">48</span><span class=\"token punctuation\">,</span><span class=\"token number\">27</span><span class=\"token punctuation\">,</span><span class=\"token number\">166</span><span class=\"token punctuation\">,</span>\n  <span class=\"token number\">77</span><span class=\"token punctuation\">,</span><span class=\"token number\">146</span><span class=\"token punctuation\">,</span><span class=\"token number\">158</span><span class=\"token punctuation\">,</span><span class=\"token number\">231</span><span class=\"token punctuation\">,</span><span class=\"token number\">83</span><span class=\"token punctuation\">,</span><span class=\"token number\">111</span><span class=\"token punctuation\">,</span><span class=\"token number\">229</span><span class=\"token punctuation\">,</span><span class=\"token number\">122</span><span class=\"token punctuation\">,</span><span class=\"token number\">60</span><span class=\"token punctuation\">,</span><span class=\"token number\">211</span><span class=\"token punctuation\">,</span><span class=\"token number\">133</span><span class=\"token punctuation\">,</span><span class=\"token number\">230</span><span class=\"token punctuation\">,</span><span class=\"token number\">220</span><span class=\"token punctuation\">,</span><span class=\"token number\">105</span><span class=\"token punctuation\">,</span><span class=\"token number\">92</span><span class=\"token punctuation\">,</span><span class=\"token number\">41</span><span class=\"token punctuation\">,</span><span class=\"token number\">55</span><span class=\"token punctuation\">,</span><span class=\"token number\">46</span><span class=\"token punctuation\">,</span><span class=\"token number\">245</span><span class=\"token punctuation\">,</span><span class=\"token number\">40</span><span class=\"token punctuation\">,</span><span class=\"token number\">244</span><span class=\"token punctuation\">,</span>\n  <span class=\"token number\">102</span><span class=\"token punctuation\">,</span><span class=\"token number\">143</span><span class=\"token punctuation\">,</span><span class=\"token number\">54</span><span class=\"token punctuation\">,</span> <span class=\"token number\">65</span><span class=\"token punctuation\">,</span><span class=\"token number\">25</span><span class=\"token punctuation\">,</span><span class=\"token number\">63</span><span class=\"token punctuation\">,</span><span class=\"token number\">161</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">216</span><span class=\"token punctuation\">,</span><span class=\"token number\">80</span><span class=\"token punctuation\">,</span><span class=\"token number\">73</span><span class=\"token punctuation\">,</span><span class=\"token number\">209</span><span class=\"token punctuation\">,</span><span class=\"token number\">76</span><span class=\"token punctuation\">,</span><span class=\"token number\">132</span><span class=\"token punctuation\">,</span><span class=\"token number\">187</span><span class=\"token punctuation\">,</span><span class=\"token number\">208</span><span class=\"token punctuation\">,</span> <span class=\"token number\">89</span><span class=\"token punctuation\">,</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span><span class=\"token number\">169</span><span class=\"token punctuation\">,</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span><span class=\"token number\">196</span><span class=\"token punctuation\">,</span>\n  <span class=\"token number\">135</span><span class=\"token punctuation\">,</span><span class=\"token number\">130</span><span class=\"token punctuation\">,</span><span class=\"token number\">116</span><span class=\"token punctuation\">,</span><span class=\"token number\">188</span><span class=\"token punctuation\">,</span><span class=\"token number\">159</span><span class=\"token punctuation\">,</span><span class=\"token number\">86</span><span class=\"token punctuation\">,</span><span class=\"token number\">164</span><span class=\"token punctuation\">,</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span><span class=\"token number\">109</span><span class=\"token punctuation\">,</span><span class=\"token number\">198</span><span class=\"token punctuation\">,</span><span class=\"token number\">173</span><span class=\"token punctuation\">,</span><span class=\"token number\">186</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">64</span><span class=\"token punctuation\">,</span><span class=\"token number\">52</span><span class=\"token punctuation\">,</span><span class=\"token number\">217</span><span class=\"token punctuation\">,</span><span class=\"token number\">226</span><span class=\"token punctuation\">,</span><span class=\"token number\">250</span><span class=\"token punctuation\">,</span><span class=\"token number\">124</span><span class=\"token punctuation\">,</span><span class=\"token number\">123</span><span class=\"token punctuation\">,</span>\n  <span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">202</span><span class=\"token punctuation\">,</span><span class=\"token number\">38</span><span class=\"token punctuation\">,</span><span class=\"token number\">147</span><span class=\"token punctuation\">,</span><span class=\"token number\">118</span><span class=\"token punctuation\">,</span><span class=\"token number\">126</span><span class=\"token punctuation\">,</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span><span class=\"token number\">82</span><span class=\"token punctuation\">,</span><span class=\"token number\">85</span><span class=\"token punctuation\">,</span><span class=\"token number\">212</span><span class=\"token punctuation\">,</span><span class=\"token number\">207</span><span class=\"token punctuation\">,</span><span class=\"token number\">206</span><span class=\"token punctuation\">,</span><span class=\"token number\">59</span><span class=\"token punctuation\">,</span><span class=\"token number\">227</span><span class=\"token punctuation\">,</span><span class=\"token number\">47</span><span class=\"token punctuation\">,</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span><span class=\"token number\">58</span><span class=\"token punctuation\">,</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span><span class=\"token number\">182</span><span class=\"token punctuation\">,</span><span class=\"token number\">189</span><span class=\"token punctuation\">,</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span><span class=\"token number\">42</span><span class=\"token punctuation\">,</span>\n  <span class=\"token number\">223</span><span class=\"token punctuation\">,</span><span class=\"token number\">183</span><span class=\"token punctuation\">,</span><span class=\"token number\">170</span><span class=\"token punctuation\">,</span><span class=\"token number\">213</span><span class=\"token punctuation\">,</span><span class=\"token number\">119</span><span class=\"token punctuation\">,</span><span class=\"token number\">248</span><span class=\"token punctuation\">,</span><span class=\"token number\">152</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">44</span><span class=\"token punctuation\">,</span><span class=\"token number\">154</span><span class=\"token punctuation\">,</span><span class=\"token number\">163</span><span class=\"token punctuation\">,</span> <span class=\"token number\">70</span><span class=\"token punctuation\">,</span><span class=\"token number\">221</span><span class=\"token punctuation\">,</span><span class=\"token number\">153</span><span class=\"token punctuation\">,</span><span class=\"token number\">101</span><span class=\"token punctuation\">,</span><span class=\"token number\">155</span><span class=\"token punctuation\">,</span><span class=\"token number\">167</span><span class=\"token punctuation\">,</span> <span class=\"token number\">43</span><span class=\"token punctuation\">,</span><span class=\"token number\">172</span><span class=\"token punctuation\">,</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span>\n  <span class=\"token number\">129</span><span class=\"token punctuation\">,</span><span class=\"token number\">22</span><span class=\"token punctuation\">,</span><span class=\"token number\">39</span><span class=\"token punctuation\">,</span><span class=\"token number\">253</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span><span class=\"token number\">98</span><span class=\"token punctuation\">,</span><span class=\"token number\">108</span><span class=\"token punctuation\">,</span><span class=\"token number\">110</span><span class=\"token punctuation\">,</span><span class=\"token number\">79</span><span class=\"token punctuation\">,</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span><span class=\"token number\">224</span><span class=\"token punctuation\">,</span><span class=\"token number\">232</span><span class=\"token punctuation\">,</span><span class=\"token number\">178</span><span class=\"token punctuation\">,</span><span class=\"token number\">185</span><span class=\"token punctuation\">,</span> <span class=\"token number\">112</span><span class=\"token punctuation\">,</span><span class=\"token number\">104</span><span class=\"token punctuation\">,</span><span class=\"token number\">218</span><span class=\"token punctuation\">,</span><span class=\"token number\">246</span><span class=\"token punctuation\">,</span><span class=\"token number\">97</span><span class=\"token punctuation\">,</span><span class=\"token number\">228</span><span class=\"token punctuation\">,</span>\n  <span class=\"token number\">251</span><span class=\"token punctuation\">,</span><span class=\"token number\">34</span><span class=\"token punctuation\">,</span><span class=\"token number\">242</span><span class=\"token punctuation\">,</span><span class=\"token number\">193</span><span class=\"token punctuation\">,</span><span class=\"token number\">238</span><span class=\"token punctuation\">,</span><span class=\"token number\">210</span><span class=\"token punctuation\">,</span><span class=\"token number\">144</span><span class=\"token punctuation\">,</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span><span class=\"token number\">191</span><span class=\"token punctuation\">,</span><span class=\"token number\">179</span><span class=\"token punctuation\">,</span><span class=\"token number\">162</span><span class=\"token punctuation\">,</span><span class=\"token number\">241</span><span class=\"token punctuation\">,</span> <span class=\"token number\">81</span><span class=\"token punctuation\">,</span><span class=\"token number\">51</span><span class=\"token punctuation\">,</span><span class=\"token number\">145</span><span class=\"token punctuation\">,</span><span class=\"token number\">235</span><span class=\"token punctuation\">,</span><span class=\"token number\">249</span><span class=\"token punctuation\">,</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span><span class=\"token number\">239</span><span class=\"token punctuation\">,</span><span class=\"token number\">107</span><span class=\"token punctuation\">,</span>\n  <span class=\"token number\">49</span><span class=\"token punctuation\">,</span><span class=\"token number\">192</span><span class=\"token punctuation\">,</span><span class=\"token number\">214</span><span class=\"token punctuation\">,</span> <span class=\"token number\">31</span><span class=\"token punctuation\">,</span><span class=\"token number\">181</span><span class=\"token punctuation\">,</span><span class=\"token number\">199</span><span class=\"token punctuation\">,</span><span class=\"token number\">106</span><span class=\"token punctuation\">,</span><span class=\"token number\">157</span><span class=\"token punctuation\">,</span><span class=\"token number\">184</span><span class=\"token punctuation\">,</span> <span class=\"token number\">84</span><span class=\"token punctuation\">,</span><span class=\"token number\">204</span><span class=\"token punctuation\">,</span><span class=\"token number\">176</span><span class=\"token punctuation\">,</span><span class=\"token number\">115</span><span class=\"token punctuation\">,</span><span class=\"token number\">121</span><span class=\"token punctuation\">,</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span><span class=\"token number\">45</span><span class=\"token punctuation\">,</span><span class=\"token number\">127</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">150</span><span class=\"token punctuation\">,</span><span class=\"token number\">254</span><span class=\"token punctuation\">,</span>\n  <span class=\"token number\">138</span><span class=\"token punctuation\">,</span><span class=\"token number\">236</span><span class=\"token punctuation\">,</span><span class=\"token number\">205</span><span class=\"token punctuation\">,</span><span class=\"token number\">93</span><span class=\"token punctuation\">,</span><span class=\"token number\">222</span><span class=\"token punctuation\">,</span><span class=\"token number\">114</span><span class=\"token punctuation\">,</span><span class=\"token number\">67</span><span class=\"token punctuation\">,</span><span class=\"token number\">29</span><span class=\"token punctuation\">,</span><span class=\"token number\">24</span><span class=\"token punctuation\">,</span><span class=\"token number\">72</span><span class=\"token punctuation\">,</span><span class=\"token number\">243</span><span class=\"token punctuation\">,</span><span class=\"token number\">141</span><span class=\"token punctuation\">,</span><span class=\"token number\">128</span><span class=\"token punctuation\">,</span><span class=\"token number\">195</span><span class=\"token punctuation\">,</span><span class=\"token number\">78</span><span class=\"token punctuation\">,</span><span class=\"token number\">66</span><span class=\"token punctuation\">,</span><span class=\"token number\">215</span><span class=\"token punctuation\">,</span><span class=\"token number\">61</span><span class=\"token punctuation\">,</span><span class=\"token number\">156</span><span class=\"token punctuation\">,</span><span class=\"token number\">180</span><span class=\"token punctuation\">,</span>\n  <span class=\"token number\">151</span><span class=\"token punctuation\">,</span><span class=\"token number\">160</span><span class=\"token punctuation\">,</span><span class=\"token number\">137</span><span class=\"token punctuation\">,</span><span class=\"token number\">91</span><span class=\"token punctuation\">,</span><span class=\"token number\">90</span><span class=\"token punctuation\">,</span><span class=\"token number\">15</span><span class=\"token punctuation\">,</span>\n  <span class=\"token number\">131</span><span class=\"token punctuation\">,</span><span class=\"token number\">13</span><span class=\"token punctuation\">,</span><span class=\"token number\">201</span><span class=\"token punctuation\">,</span><span class=\"token number\">95</span><span class=\"token punctuation\">,</span><span class=\"token number\">96</span><span class=\"token punctuation\">,</span><span class=\"token number\">53</span><span class=\"token punctuation\">,</span><span class=\"token number\">194</span><span class=\"token punctuation\">,</span><span class=\"token number\">233</span><span class=\"token punctuation\">,</span><span class=\"token number\">7</span><span class=\"token punctuation\">,</span><span class=\"token number\">225</span><span class=\"token punctuation\">,</span><span class=\"token number\">140</span><span class=\"token punctuation\">,</span><span class=\"token number\">36</span><span class=\"token punctuation\">,</span><span class=\"token number\">103</span><span class=\"token punctuation\">,</span><span class=\"token number\">30</span><span class=\"token punctuation\">,</span><span class=\"token number\">69</span><span class=\"token punctuation\">,</span><span class=\"token number\">142</span><span class=\"token punctuation\">,</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span><span class=\"token number\">99</span><span class=\"token punctuation\">,</span><span class=\"token number\">37</span><span class=\"token punctuation\">,</span><span class=\"token number\">240</span><span class=\"token punctuation\">,</span><span class=\"token number\">21</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">23</span><span class=\"token punctuation\">,</span>\n  <span class=\"token number\">190</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">148</span><span class=\"token punctuation\">,</span><span class=\"token number\">247</span><span class=\"token punctuation\">,</span><span class=\"token number\">120</span><span class=\"token punctuation\">,</span><span class=\"token number\">234</span><span class=\"token punctuation\">,</span><span class=\"token number\">75</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">26</span><span class=\"token punctuation\">,</span><span class=\"token number\">197</span><span class=\"token punctuation\">,</span><span class=\"token number\">62</span><span class=\"token punctuation\">,</span><span class=\"token number\">94</span><span class=\"token punctuation\">,</span><span class=\"token number\">252</span><span class=\"token punctuation\">,</span><span class=\"token number\">219</span><span class=\"token punctuation\">,</span><span class=\"token number\">203</span><span class=\"token punctuation\">,</span><span class=\"token number\">117</span><span class=\"token punctuation\">,</span><span class=\"token number\">35</span><span class=\"token punctuation\">,</span><span class=\"token number\">11</span><span class=\"token punctuation\">,</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span><span class=\"token number\">57</span><span class=\"token punctuation\">,</span><span class=\"token number\">177</span><span class=\"token punctuation\">,</span><span class=\"token number\">33</span><span class=\"token punctuation\">,</span>\n  <span class=\"token number\">88</span><span class=\"token punctuation\">,</span><span class=\"token number\">237</span><span class=\"token punctuation\">,</span><span class=\"token number\">149</span><span class=\"token punctuation\">,</span><span class=\"token number\">56</span><span class=\"token punctuation\">,</span><span class=\"token number\">87</span><span class=\"token punctuation\">,</span><span class=\"token number\">174</span><span class=\"token punctuation\">,</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span><span class=\"token number\">125</span><span class=\"token punctuation\">,</span><span class=\"token number\">136</span><span class=\"token punctuation\">,</span><span class=\"token number\">171</span><span class=\"token punctuation\">,</span><span class=\"token number\">168</span><span class=\"token punctuation\">,</span> <span class=\"token number\">68</span><span class=\"token punctuation\">,</span><span class=\"token number\">175</span><span class=\"token punctuation\">,</span><span class=\"token number\">74</span><span class=\"token punctuation\">,</span><span class=\"token number\">165</span><span class=\"token punctuation\">,</span><span class=\"token number\">71</span><span class=\"token punctuation\">,</span><span class=\"token number\">134</span><span class=\"token punctuation\">,</span><span class=\"token number\">139</span><span class=\"token punctuation\">,</span><span class=\"token number\">48</span><span class=\"token punctuation\">,</span><span class=\"token number\">27</span><span class=\"token punctuation\">,</span><span class=\"token number\">166</span><span class=\"token punctuation\">,</span>\n  <span class=\"token number\">77</span><span class=\"token punctuation\">,</span><span class=\"token number\">146</span><span class=\"token punctuation\">,</span><span class=\"token number\">158</span><span class=\"token punctuation\">,</span><span class=\"token number\">231</span><span class=\"token punctuation\">,</span><span class=\"token number\">83</span><span class=\"token punctuation\">,</span><span class=\"token number\">111</span><span class=\"token punctuation\">,</span><span class=\"token number\">229</span><span class=\"token punctuation\">,</span><span class=\"token number\">122</span><span class=\"token punctuation\">,</span><span class=\"token number\">60</span><span class=\"token punctuation\">,</span><span class=\"token number\">211</span><span class=\"token punctuation\">,</span><span class=\"token number\">133</span><span class=\"token punctuation\">,</span><span class=\"token number\">230</span><span class=\"token punctuation\">,</span><span class=\"token number\">220</span><span class=\"token punctuation\">,</span><span class=\"token number\">105</span><span class=\"token punctuation\">,</span><span class=\"token number\">92</span><span class=\"token punctuation\">,</span><span class=\"token number\">41</span><span class=\"token punctuation\">,</span><span class=\"token number\">55</span><span class=\"token punctuation\">,</span><span class=\"token number\">46</span><span class=\"token punctuation\">,</span><span class=\"token number\">245</span><span class=\"token punctuation\">,</span><span class=\"token number\">40</span><span class=\"token punctuation\">,</span><span class=\"token number\">244</span><span class=\"token punctuation\">,</span>\n  <span class=\"token number\">102</span><span class=\"token punctuation\">,</span><span class=\"token number\">143</span><span class=\"token punctuation\">,</span><span class=\"token number\">54</span><span class=\"token punctuation\">,</span> <span class=\"token number\">65</span><span class=\"token punctuation\">,</span><span class=\"token number\">25</span><span class=\"token punctuation\">,</span><span class=\"token number\">63</span><span class=\"token punctuation\">,</span><span class=\"token number\">161</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">216</span><span class=\"token punctuation\">,</span><span class=\"token number\">80</span><span class=\"token punctuation\">,</span><span class=\"token number\">73</span><span class=\"token punctuation\">,</span><span class=\"token number\">209</span><span class=\"token punctuation\">,</span><span class=\"token number\">76</span><span class=\"token punctuation\">,</span><span class=\"token number\">132</span><span class=\"token punctuation\">,</span><span class=\"token number\">187</span><span class=\"token punctuation\">,</span><span class=\"token number\">208</span><span class=\"token punctuation\">,</span> <span class=\"token number\">89</span><span class=\"token punctuation\">,</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span><span class=\"token number\">169</span><span class=\"token punctuation\">,</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span><span class=\"token number\">196</span><span class=\"token punctuation\">,</span>\n  <span class=\"token number\">135</span><span class=\"token punctuation\">,</span><span class=\"token number\">130</span><span class=\"token punctuation\">,</span><span class=\"token number\">116</span><span class=\"token punctuation\">,</span><span class=\"token number\">188</span><span class=\"token punctuation\">,</span><span class=\"token number\">159</span><span class=\"token punctuation\">,</span><span class=\"token number\">86</span><span class=\"token punctuation\">,</span><span class=\"token number\">164</span><span class=\"token punctuation\">,</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span><span class=\"token number\">109</span><span class=\"token punctuation\">,</span><span class=\"token number\">198</span><span class=\"token punctuation\">,</span><span class=\"token number\">173</span><span class=\"token punctuation\">,</span><span class=\"token number\">186</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">64</span><span class=\"token punctuation\">,</span><span class=\"token number\">52</span><span class=\"token punctuation\">,</span><span class=\"token number\">217</span><span class=\"token punctuation\">,</span><span class=\"token number\">226</span><span class=\"token punctuation\">,</span><span class=\"token number\">250</span><span class=\"token punctuation\">,</span><span class=\"token number\">124</span><span class=\"token punctuation\">,</span><span class=\"token number\">123</span><span class=\"token punctuation\">,</span>\n  <span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">202</span><span class=\"token punctuation\">,</span><span class=\"token number\">38</span><span class=\"token punctuation\">,</span><span class=\"token number\">147</span><span class=\"token punctuation\">,</span><span class=\"token number\">118</span><span class=\"token punctuation\">,</span><span class=\"token number\">126</span><span class=\"token punctuation\">,</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span><span class=\"token number\">82</span><span class=\"token punctuation\">,</span><span class=\"token number\">85</span><span class=\"token punctuation\">,</span><span class=\"token number\">212</span><span class=\"token punctuation\">,</span><span class=\"token number\">207</span><span class=\"token punctuation\">,</span><span class=\"token number\">206</span><span class=\"token punctuation\">,</span><span class=\"token number\">59</span><span class=\"token punctuation\">,</span><span class=\"token number\">227</span><span class=\"token punctuation\">,</span><span class=\"token number\">47</span><span class=\"token punctuation\">,</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span><span class=\"token number\">58</span><span class=\"token punctuation\">,</span><span class=\"token number\">17</span><span class=\"token punctuation\">,</span><span class=\"token number\">182</span><span class=\"token punctuation\">,</span><span class=\"token number\">189</span><span class=\"token punctuation\">,</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span><span class=\"token number\">42</span><span class=\"token punctuation\">,</span>\n  <span class=\"token number\">223</span><span class=\"token punctuation\">,</span><span class=\"token number\">183</span><span class=\"token punctuation\">,</span><span class=\"token number\">170</span><span class=\"token punctuation\">,</span><span class=\"token number\">213</span><span class=\"token punctuation\">,</span><span class=\"token number\">119</span><span class=\"token punctuation\">,</span><span class=\"token number\">248</span><span class=\"token punctuation\">,</span><span class=\"token number\">152</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">44</span><span class=\"token punctuation\">,</span><span class=\"token number\">154</span><span class=\"token punctuation\">,</span><span class=\"token number\">163</span><span class=\"token punctuation\">,</span> <span class=\"token number\">70</span><span class=\"token punctuation\">,</span><span class=\"token number\">221</span><span class=\"token punctuation\">,</span><span class=\"token number\">153</span><span class=\"token punctuation\">,</span><span class=\"token number\">101</span><span class=\"token punctuation\">,</span><span class=\"token number\">155</span><span class=\"token punctuation\">,</span><span class=\"token number\">167</span><span class=\"token punctuation\">,</span> <span class=\"token number\">43</span><span class=\"token punctuation\">,</span><span class=\"token number\">172</span><span class=\"token punctuation\">,</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span>\n  <span class=\"token number\">129</span><span class=\"token punctuation\">,</span><span class=\"token number\">22</span><span class=\"token punctuation\">,</span><span class=\"token number\">39</span><span class=\"token punctuation\">,</span><span class=\"token number\">253</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span><span class=\"token number\">98</span><span class=\"token punctuation\">,</span><span class=\"token number\">108</span><span class=\"token punctuation\">,</span><span class=\"token number\">110</span><span class=\"token punctuation\">,</span><span class=\"token number\">79</span><span class=\"token punctuation\">,</span><span class=\"token number\">113</span><span class=\"token punctuation\">,</span><span class=\"token number\">224</span><span class=\"token punctuation\">,</span><span class=\"token number\">232</span><span class=\"token punctuation\">,</span><span class=\"token number\">178</span><span class=\"token punctuation\">,</span><span class=\"token number\">185</span><span class=\"token punctuation\">,</span> <span class=\"token number\">112</span><span class=\"token punctuation\">,</span><span class=\"token number\">104</span><span class=\"token punctuation\">,</span><span class=\"token number\">218</span><span class=\"token punctuation\">,</span><span class=\"token number\">246</span><span class=\"token punctuation\">,</span><span class=\"token number\">97</span><span class=\"token punctuation\">,</span><span class=\"token number\">228</span><span class=\"token punctuation\">,</span>\n  <span class=\"token number\">251</span><span class=\"token punctuation\">,</span><span class=\"token number\">34</span><span class=\"token punctuation\">,</span><span class=\"token number\">242</span><span class=\"token punctuation\">,</span><span class=\"token number\">193</span><span class=\"token punctuation\">,</span><span class=\"token number\">238</span><span class=\"token punctuation\">,</span><span class=\"token number\">210</span><span class=\"token punctuation\">,</span><span class=\"token number\">144</span><span class=\"token punctuation\">,</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span><span class=\"token number\">191</span><span class=\"token punctuation\">,</span><span class=\"token number\">179</span><span class=\"token punctuation\">,</span><span class=\"token number\">162</span><span class=\"token punctuation\">,</span><span class=\"token number\">241</span><span class=\"token punctuation\">,</span> <span class=\"token number\">81</span><span class=\"token punctuation\">,</span><span class=\"token number\">51</span><span class=\"token punctuation\">,</span><span class=\"token number\">145</span><span class=\"token punctuation\">,</span><span class=\"token number\">235</span><span class=\"token punctuation\">,</span><span class=\"token number\">249</span><span class=\"token punctuation\">,</span><span class=\"token number\">14</span><span class=\"token punctuation\">,</span><span class=\"token number\">239</span><span class=\"token punctuation\">,</span><span class=\"token number\">107</span><span class=\"token punctuation\">,</span>\n  <span class=\"token number\">49</span><span class=\"token punctuation\">,</span><span class=\"token number\">192</span><span class=\"token punctuation\">,</span><span class=\"token number\">214</span><span class=\"token punctuation\">,</span> <span class=\"token number\">31</span><span class=\"token punctuation\">,</span><span class=\"token number\">181</span><span class=\"token punctuation\">,</span><span class=\"token number\">199</span><span class=\"token punctuation\">,</span><span class=\"token number\">106</span><span class=\"token punctuation\">,</span><span class=\"token number\">157</span><span class=\"token punctuation\">,</span><span class=\"token number\">184</span><span class=\"token punctuation\">,</span> <span class=\"token number\">84</span><span class=\"token punctuation\">,</span><span class=\"token number\">204</span><span class=\"token punctuation\">,</span><span class=\"token number\">176</span><span class=\"token punctuation\">,</span><span class=\"token number\">115</span><span class=\"token punctuation\">,</span><span class=\"token number\">121</span><span class=\"token punctuation\">,</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span><span class=\"token number\">45</span><span class=\"token punctuation\">,</span><span class=\"token number\">127</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">150</span><span class=\"token punctuation\">,</span><span class=\"token number\">254</span><span class=\"token punctuation\">,</span>\n  <span class=\"token number\">138</span><span class=\"token punctuation\">,</span><span class=\"token number\">236</span><span class=\"token punctuation\">,</span><span class=\"token number\">205</span><span class=\"token punctuation\">,</span><span class=\"token number\">93</span><span class=\"token punctuation\">,</span><span class=\"token number\">222</span><span class=\"token punctuation\">,</span><span class=\"token number\">114</span><span class=\"token punctuation\">,</span><span class=\"token number\">67</span><span class=\"token punctuation\">,</span><span class=\"token number\">29</span><span class=\"token punctuation\">,</span><span class=\"token number\">24</span><span class=\"token punctuation\">,</span><span class=\"token number\">72</span><span class=\"token punctuation\">,</span><span class=\"token number\">243</span><span class=\"token punctuation\">,</span><span class=\"token number\">141</span><span class=\"token punctuation\">,</span><span class=\"token number\">128</span><span class=\"token punctuation\">,</span><span class=\"token number\">195</span><span class=\"token punctuation\">,</span><span class=\"token number\">78</span><span class=\"token punctuation\">,</span><span class=\"token number\">66</span><span class=\"token punctuation\">,</span><span class=\"token number\">215</span><span class=\"token punctuation\">,</span><span class=\"token number\">61</span><span class=\"token punctuation\">,</span><span class=\"token number\">156</span><span class=\"token punctuation\">,</span><span class=\"token number\">180</span> \n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\" spellcheck=\"true\">/*\n * ---------------------------------------------------------------------\n */</span>\n\n<span class=\"token comment\" spellcheck=\"true\">/*\n * Helper functions to compute gradients-dot-residualvectors (1D to 4D)\n * Note that these generate gradients of more than unit length. To make\n * a close match with the value range of classic Perlin noise, the final\n * noise values need to be rescaled to fit nicely within [-1,1].\n * (The simplex noise functions as such also have different scaling.)\n * Note also that these noise functions are the most practical and useful\n * signed version of Perlin noise. To return values according to the\n * RenderMan specification from the SL noise() and pnoise() functions,\n * the noise values need to be scaled and offset to [0,1], like this:\n * float SLnoise = (SimplexNoise1234::noise(x,y,z) + 1.0) * 0.5;\n */</span>\n\n<span class=\"token keyword\">inline</span> <span class=\"token keyword\">float</span>  <span class=\"token function\">grad1</span><span class=\"token punctuation\">(</span> <span class=\"token keyword\">int</span> hash<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float</span> x <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">int</span> h <span class=\"token operator\">=</span> hash <span class=\"token operator\">&amp;</span> <span class=\"token number\">15</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">float</span> grad <span class=\"token operator\">=</span> <span class=\"token number\">1.0f</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>h <span class=\"token operator\">&amp;</span> <span class=\"token number\">7</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\" spellcheck=\"true\">/* Gradient value 1.0, 2.0, ..., 8.0 */</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>h<span class=\"token operator\">&amp;</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span> grad <span class=\"token operator\">=</span> <span class=\"token operator\">-</span>grad<span class=\"token punctuation\">;</span>         <span class=\"token comment\" spellcheck=\"true\">/* Set a random sign for the gradient */</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span> grad <span class=\"token operator\">*</span> x <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>           <span class=\"token comment\" spellcheck=\"true\">/* Multiply the gradient with the distance */</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">inline</span> <span class=\"token keyword\">float</span>  <span class=\"token function\">grad2</span><span class=\"token punctuation\">(</span> <span class=\"token keyword\">int</span> hash<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float</span> x<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float</span> y <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">int</span> h <span class=\"token operator\">=</span> hash <span class=\"token operator\">&amp;</span> <span class=\"token number\">7</span><span class=\"token punctuation\">;</span>      <span class=\"token comment\" spellcheck=\"true\">/* Convert low 3 bits of hash code */</span>\n\t<span class=\"token keyword\">float</span> u <span class=\"token operator\">=</span> h<span class=\"token operator\">&lt;</span><span class=\"token number\">4</span> <span class=\"token operator\">?</span> x <span class=\"token operator\">:</span> y<span class=\"token punctuation\">;</span>  <span class=\"token comment\" spellcheck=\"true\">/* into 8 simple gradient directions, */</span>\n\t<span class=\"token keyword\">float</span> v <span class=\"token operator\">=</span> h<span class=\"token operator\">&lt;</span><span class=\"token number\">4</span> <span class=\"token operator\">?</span> y <span class=\"token operator\">:</span> x<span class=\"token punctuation\">;</span>  <span class=\"token comment\" spellcheck=\"true\">/* and compute the dot product with (x,y). */</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>h<span class=\"token operator\">&amp;</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?</span> <span class=\"token operator\">-</span>u <span class=\"token operator\">:</span> u<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>h<span class=\"token operator\">&amp;</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?</span> <span class=\"token operator\">-</span><span class=\"token number\">2.0f</span><span class=\"token operator\">*</span>v <span class=\"token operator\">:</span> <span class=\"token number\">2.0f</span><span class=\"token operator\">*</span>v<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">inline</span> <span class=\"token keyword\">float</span>  <span class=\"token function\">grad3</span><span class=\"token punctuation\">(</span> <span class=\"token keyword\">int</span> hash<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float</span> x<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float</span> y <span class=\"token punctuation\">,</span> <span class=\"token keyword\">float</span> z <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">int</span> h <span class=\"token operator\">=</span> hash <span class=\"token operator\">&amp;</span> <span class=\"token number\">15</span><span class=\"token punctuation\">;</span>     <span class=\"token comment\" spellcheck=\"true\">/* Convert low 4 bits of hash code into 12 simple */</span>\n\t<span class=\"token keyword\">float</span> u <span class=\"token operator\">=</span> h<span class=\"token operator\">&lt;</span><span class=\"token number\">8</span> <span class=\"token operator\">?</span> x <span class=\"token operator\">:</span> y<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* gradient directions, and compute dot product. */</span>\n\t<span class=\"token keyword\">float</span> v <span class=\"token operator\">=</span> h<span class=\"token operator\">&lt;</span><span class=\"token number\">4</span> <span class=\"token operator\">?</span> y <span class=\"token operator\">:</span> h<span class=\"token operator\">==</span><span class=\"token number\">12</span><span class=\"token operator\">||</span>h<span class=\"token operator\">==</span><span class=\"token number\">14</span> <span class=\"token operator\">?</span> x <span class=\"token operator\">:</span> z<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* Fix repeats at h = 12 to 15 */</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>h<span class=\"token operator\">&amp;</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?</span> <span class=\"token operator\">-</span>u <span class=\"token operator\">:</span> u<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>h<span class=\"token operator\">&amp;</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?</span> <span class=\"token operator\">-</span>v <span class=\"token operator\">:</span> v<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">inline</span> <span class=\"token keyword\">float</span>  <span class=\"token function\">grad4</span><span class=\"token punctuation\">(</span> <span class=\"token keyword\">int</span> hash<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float</span> x<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float</span> y<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float</span> z<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float</span> t <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">int</span> h <span class=\"token operator\">=</span> hash <span class=\"token operator\">&amp;</span> <span class=\"token number\">31</span><span class=\"token punctuation\">;</span>      <span class=\"token comment\" spellcheck=\"true\">/* Convert low 5 bits of hash code into 32 simple */</span>\n\t<span class=\"token keyword\">float</span> u <span class=\"token operator\">=</span> h<span class=\"token operator\">&lt;</span><span class=\"token number\">24</span> <span class=\"token operator\">?</span> x <span class=\"token operator\">:</span> y<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* gradient directions, and compute dot product. */</span>\n\t<span class=\"token keyword\">float</span> v <span class=\"token operator\">=</span> h<span class=\"token operator\">&lt;</span><span class=\"token number\">16</span> <span class=\"token operator\">?</span> y <span class=\"token operator\">:</span> z<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">float</span> w <span class=\"token operator\">=</span> h<span class=\"token operator\">&lt;</span><span class=\"token number\">8</span> <span class=\"token operator\">?</span> z <span class=\"token operator\">:</span> t<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>h<span class=\"token operator\">&amp;</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?</span> <span class=\"token operator\">-</span>u <span class=\"token operator\">:</span> u<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>h<span class=\"token operator\">&amp;</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?</span> <span class=\"token operator\">-</span>v <span class=\"token operator\">:</span> v<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>h<span class=\"token operator\">&amp;</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token operator\">?</span> <span class=\"token operator\">-</span>w <span class=\"token operator\">:</span> w<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\" spellcheck=\"true\">/* A lookup table to traverse the simplex around a given point in 4D. */</span>\n  <span class=\"token comment\" spellcheck=\"true\">/* Details can be found where this table is used, in the 4D noise method. */</span>\n  <span class=\"token comment\" spellcheck=\"true\">/* TODO: This should not be required, backport it from Bill's GLSL code! */</span>\n<span class=\"token keyword\">namespace</span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">char</span> simplex<span class=\"token punctuation\">[</span><span class=\"token number\">64</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">{</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\" spellcheck=\"true\">/* 1D simplex noise */</span>\n<span class=\"token keyword\">inline</span> <span class=\"token keyword\">float</span> <span class=\"token function\">_slang_library_noise1</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span> x<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">int</span> i0 <span class=\"token operator\">=</span> <span class=\"token function\">OFNOISE_FASTFLOOR</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">int</span> i1 <span class=\"token operator\">=</span> i0 <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">float</span> x0 <span class=\"token operator\">=</span> x <span class=\"token operator\">-</span> i0<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">float</span> x1 <span class=\"token operator\">=</span> x0 <span class=\"token operator\">-</span> <span class=\"token number\">1.0f</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">float</span> t1 <span class=\"token operator\">=</span> <span class=\"token number\">1.0f</span> <span class=\"token operator\">-</span> x1<span class=\"token operator\">*</span>x1<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">float</span> n0<span class=\"token punctuation\">,</span> n1<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">float</span> t0 <span class=\"token operator\">=</span> <span class=\"token number\">1.0f</span> <span class=\"token operator\">-</span> x0<span class=\"token operator\">*</span>x0<span class=\"token punctuation\">;</span>\n<span class=\"token comment\" spellcheck=\"true\">/*  if(t0 &lt; 0.0f) t0 = 0.0f; // this never happens for the 1D case */</span>\n  t0 <span class=\"token operator\">*</span><span class=\"token operator\">=</span> t0<span class=\"token punctuation\">;</span>\n  n0 <span class=\"token operator\">=</span> t0 <span class=\"token operator\">*</span> t0 <span class=\"token operator\">*</span> <span class=\"token function\">grad1</span><span class=\"token punctuation\">(</span>perm<span class=\"token punctuation\">[</span>i0 <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xff</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> x0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\" spellcheck=\"true\">/*  if(t1 &lt; 0.0f) t1 = 0.0f; // this never happens for the 1D case */</span>\n  t1 <span class=\"token operator\">*</span><span class=\"token operator\">=</span> t1<span class=\"token punctuation\">;</span>\n  n1 <span class=\"token operator\">=</span> t1 <span class=\"token operator\">*</span> t1 <span class=\"token operator\">*</span> <span class=\"token function\">grad1</span><span class=\"token punctuation\">(</span>perm<span class=\"token punctuation\">[</span>i1 <span class=\"token operator\">&amp;</span> <span class=\"token number\">0xff</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> x1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\" spellcheck=\"true\">/* The maximum value of this noise is 8*(3/4)^4 = 2.53125 */</span>\n  <span class=\"token comment\" spellcheck=\"true\">/* A factor of 0.395 would scale to fit exactly within [-1,1], but */</span>\n  <span class=\"token comment\" spellcheck=\"true\">/* we want to match PRMan's 1D noise, so we scale it down some more. */</span>\n  <span class=\"token keyword\">return</span> <span class=\"token number\">0.25f</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>n0 <span class=\"token operator\">+</span> n1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\" spellcheck=\"true\">/* 2D simplex noise */</span>\n<span class=\"token keyword\">inline</span> <span class=\"token keyword\">float</span> <span class=\"token function\">_slang_library_noise2</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span> x<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float</span> y<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">constexpr</span> <span class=\"token keyword\">float</span> F2 <span class=\"token operator\">=</span> <span class=\"token number\">0.366025403f</span><span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* F2 = 0.5*(sqrt(3.0)-1.0) */</span>\n\t<span class=\"token keyword\">constexpr</span> <span class=\"token keyword\">float</span> G2 <span class=\"token operator\">=</span> <span class=\"token number\">0.211324865f</span><span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* G2 = (3.0-Math.sqrt(3.0))/6.0 */</span>\n\n\t<span class=\"token keyword\">float</span> n0<span class=\"token punctuation\">,</span> n1<span class=\"token punctuation\">,</span> n2<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* Noise contributions from the three corners */</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">/* Skew the input space to determine which simplex cell we're in */</span>\n\t<span class=\"token keyword\">float</span> s <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>x<span class=\"token operator\">+</span>y<span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>F2<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* Hairy factor for 2D */</span>\n\t<span class=\"token keyword\">float</span> xs <span class=\"token operator\">=</span> x <span class=\"token operator\">+</span> s<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">float</span> ys <span class=\"token operator\">=</span> y <span class=\"token operator\">+</span> s<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token function\">OFNOISE_FASTFLOOR</span><span class=\"token punctuation\">(</span>xs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">int</span> j <span class=\"token operator\">=</span> <span class=\"token function\">OFNOISE_FASTFLOOR</span><span class=\"token punctuation\">(</span>ys<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">float</span> t <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">+</span>j<span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>G2<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">float</span> X0 <span class=\"token operator\">=</span> i<span class=\"token operator\">-</span>t<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* Unskew the cell origin back to (x,y) space */</span>\n\t<span class=\"token keyword\">float</span> Y0 <span class=\"token operator\">=</span> j<span class=\"token operator\">-</span>t<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">float</span> x0 <span class=\"token operator\">=</span> x<span class=\"token operator\">-</span>X0<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* The x,y distances from the cell origin */</span>\n\t<span class=\"token keyword\">float</span> y0 <span class=\"token operator\">=</span> y<span class=\"token operator\">-</span>Y0<span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">float</span> x1<span class=\"token punctuation\">,</span> y1<span class=\"token punctuation\">,</span> x2<span class=\"token punctuation\">,</span> y2<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> ii<span class=\"token punctuation\">,</span> jj<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">float</span> t0<span class=\"token punctuation\">,</span> t1<span class=\"token punctuation\">,</span> t2<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">/* For the 2D case, the simplex shape is an equilateral triangle. */</span>\n    <span class=\"token comment\" spellcheck=\"true\">/* Determine which simplex we are in. */</span>\n    <span class=\"token keyword\">int</span> i1<span class=\"token punctuation\">,</span> j1<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* Offsets for second (middle) corner of simplex in (i,j) coords */</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>x0<span class=\"token operator\">></span>y0<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>i1<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> j1<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span> <span class=\"token comment\" spellcheck=\"true\">/* lower triangle, XY order: (0,0)->(1,0)->(1,1) */</span>\n    <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>i1<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> j1<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span>      <span class=\"token comment\" spellcheck=\"true\">/* upper triangle, YX order: (0,0)->(0,1)->(1,1) */</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">/* A step of (1,0) in (i,j) means a step of (1-c,-c) in (x,y), and */</span>\n    <span class=\"token comment\" spellcheck=\"true\">/* a step of (0,1) in (i,j) means a step of (-c,1-c) in (x,y), where */</span>\n    <span class=\"token comment\" spellcheck=\"true\">/* c = (3-sqrt(3))/6 */</span>\n\n    x1 <span class=\"token operator\">=</span> x0 <span class=\"token operator\">-</span> i1 <span class=\"token operator\">+</span> G2<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* Offsets for middle corner in (x,y) unskewed coords */</span>\n    y1 <span class=\"token operator\">=</span> y0 <span class=\"token operator\">-</span> j1 <span class=\"token operator\">+</span> G2<span class=\"token punctuation\">;</span>\n    x2 <span class=\"token operator\">=</span> x0 <span class=\"token operator\">-</span> <span class=\"token number\">1.0f</span> <span class=\"token operator\">+</span> <span class=\"token number\">2.0f</span> <span class=\"token operator\">*</span> G2<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* Offsets for last corner in (x,y) unskewed coords */</span>\n    y2 <span class=\"token operator\">=</span> y0 <span class=\"token operator\">-</span> <span class=\"token number\">1.0f</span> <span class=\"token operator\">+</span> <span class=\"token number\">2.0f</span> <span class=\"token operator\">*</span> G2<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">/* Wrap the integer indices at 256, to avoid indexing perm[] out of bounds */</span>\n    ii <span class=\"token operator\">=</span> i <span class=\"token operator\">%</span> <span class=\"token number\">256</span><span class=\"token punctuation\">;</span>\n    jj <span class=\"token operator\">=</span> j <span class=\"token operator\">%</span> <span class=\"token number\">256</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">/* Calculate the contribution from the three corners */</span>\n    t0 <span class=\"token operator\">=</span> <span class=\"token number\">0.5f</span> <span class=\"token operator\">-</span> x0<span class=\"token operator\">*</span>x0<span class=\"token operator\">-</span>y0<span class=\"token operator\">*</span>y0<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>t0 <span class=\"token operator\">&lt;</span> <span class=\"token number\">0.0f</span><span class=\"token punctuation\">)</span> n0 <span class=\"token operator\">=</span> <span class=\"token number\">0.0f</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      t0 <span class=\"token operator\">*</span><span class=\"token operator\">=</span> t0<span class=\"token punctuation\">;</span>\n      n0 <span class=\"token operator\">=</span> t0 <span class=\"token operator\">*</span> t0 <span class=\"token operator\">*</span> <span class=\"token function\">grad2</span><span class=\"token punctuation\">(</span>perm<span class=\"token punctuation\">[</span>ii<span class=\"token operator\">+</span>perm<span class=\"token punctuation\">[</span>jj<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> x0<span class=\"token punctuation\">,</span> y0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n    <span class=\"token punctuation\">}</span>\n\n    t1 <span class=\"token operator\">=</span> <span class=\"token number\">0.5f</span> <span class=\"token operator\">-</span> x1<span class=\"token operator\">*</span>x1<span class=\"token operator\">-</span>y1<span class=\"token operator\">*</span>y1<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>t1 <span class=\"token operator\">&lt;</span> <span class=\"token number\">0.0f</span><span class=\"token punctuation\">)</span> n1 <span class=\"token operator\">=</span> <span class=\"token number\">0.0f</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      t1 <span class=\"token operator\">*</span><span class=\"token operator\">=</span> t1<span class=\"token punctuation\">;</span>\n      n1 <span class=\"token operator\">=</span> t1 <span class=\"token operator\">*</span> t1 <span class=\"token operator\">*</span> <span class=\"token function\">grad2</span><span class=\"token punctuation\">(</span>perm<span class=\"token punctuation\">[</span>ii<span class=\"token operator\">+</span>i1<span class=\"token operator\">+</span>perm<span class=\"token punctuation\">[</span>jj<span class=\"token operator\">+</span>j1<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> x1<span class=\"token punctuation\">,</span> y1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    t2 <span class=\"token operator\">=</span> <span class=\"token number\">0.5f</span> <span class=\"token operator\">-</span> x2<span class=\"token operator\">*</span>x2<span class=\"token operator\">-</span>y2<span class=\"token operator\">*</span>y2<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>t2 <span class=\"token operator\">&lt;</span> <span class=\"token number\">0.0f</span><span class=\"token punctuation\">)</span> n2 <span class=\"token operator\">=</span> <span class=\"token number\">0.0f</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      t2 <span class=\"token operator\">*</span><span class=\"token operator\">=</span> t2<span class=\"token punctuation\">;</span>\n      n2 <span class=\"token operator\">=</span> t2 <span class=\"token operator\">*</span> t2 <span class=\"token operator\">*</span> <span class=\"token function\">grad2</span><span class=\"token punctuation\">(</span>perm<span class=\"token punctuation\">[</span>ii<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token operator\">+</span>perm<span class=\"token punctuation\">[</span>jj<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> x2<span class=\"token punctuation\">,</span> y2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">/* Add contributions from each corner to get the final noise value. */</span>\n    <span class=\"token comment\" spellcheck=\"true\">/* The result is scaled to return values in the interval [-1,1]. */</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">40.0f</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>n0 <span class=\"token operator\">+</span> n1 <span class=\"token operator\">+</span> n2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* TODO: The scale factor is preliminary! */</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\" spellcheck=\"true\">/* 3D simplex noise */</span>\n<span class=\"token keyword\">inline</span> <span class=\"token keyword\">float</span> <span class=\"token function\">_slang_library_noise3</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span> x<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float</span> y<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float</span> z<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t<span class=\"token comment\" spellcheck=\"true\">/* Simple skewing factors for the 3D case */</span>\n\t<span class=\"token keyword\">constexpr</span> <span class=\"token keyword\">float</span> F3 <span class=\"token operator\">=</span> <span class=\"token number\">0.333333333f</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">constexpr</span> <span class=\"token keyword\">float</span> G3 <span class=\"token operator\">=</span> <span class=\"token number\">0.166666667f</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">float</span> n0<span class=\"token punctuation\">,</span> n1<span class=\"token punctuation\">,</span> n2<span class=\"token punctuation\">,</span> n3<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* Noise contributions from the four corners */</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">/* Skew the input space to determine which simplex cell we're in */</span>\n\t<span class=\"token keyword\">float</span> s <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>x<span class=\"token operator\">+</span>y<span class=\"token operator\">+</span>z<span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>F3<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* Very nice and simple skew factor for 3D */</span>\n\t<span class=\"token keyword\">float</span> xs <span class=\"token operator\">=</span> x<span class=\"token operator\">+</span>s<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">float</span> ys <span class=\"token operator\">=</span> y<span class=\"token operator\">+</span>s<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">float</span> zs <span class=\"token operator\">=</span> z<span class=\"token operator\">+</span>s<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token function\">OFNOISE_FASTFLOOR</span><span class=\"token punctuation\">(</span>xs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">int</span> j <span class=\"token operator\">=</span> <span class=\"token function\">OFNOISE_FASTFLOOR</span><span class=\"token punctuation\">(</span>ys<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">int</span> k <span class=\"token operator\">=</span> <span class=\"token function\">OFNOISE_FASTFLOOR</span><span class=\"token punctuation\">(</span>zs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">float</span> t <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">+</span>j<span class=\"token operator\">+</span>k<span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>G3<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">float</span> X0 <span class=\"token operator\">=</span> i<span class=\"token operator\">-</span>t<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* Unskew the cell origin back to (x,y,z) space */</span>\n\t<span class=\"token keyword\">float</span> Y0 <span class=\"token operator\">=</span> j<span class=\"token operator\">-</span>t<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">float</span> Z0 <span class=\"token operator\">=</span> k<span class=\"token operator\">-</span>t<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">float</span> x0 <span class=\"token operator\">=</span> x<span class=\"token operator\">-</span>X0<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* The x,y,z distances from the cell origin */</span>\n\t<span class=\"token keyword\">float</span> y0 <span class=\"token operator\">=</span> y<span class=\"token operator\">-</span>Y0<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">float</span> z0 <span class=\"token operator\">=</span> z<span class=\"token operator\">-</span>Z0<span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">float</span> x1<span class=\"token punctuation\">,</span> y1<span class=\"token punctuation\">,</span> z1<span class=\"token punctuation\">,</span> x2<span class=\"token punctuation\">,</span> y2<span class=\"token punctuation\">,</span> z2<span class=\"token punctuation\">,</span> x3<span class=\"token punctuation\">,</span> y3<span class=\"token punctuation\">,</span> z3<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> ii<span class=\"token punctuation\">,</span> jj<span class=\"token punctuation\">,</span> kk<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">float</span> t0<span class=\"token punctuation\">,</span> t1<span class=\"token punctuation\">,</span> t2<span class=\"token punctuation\">,</span> t3<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">/* For the 3D case, the simplex shape is a slightly irregular tetrahedron. */</span>\n    <span class=\"token comment\" spellcheck=\"true\">/* Determine which simplex we are in. */</span>\n    <span class=\"token keyword\">int</span> i1<span class=\"token punctuation\">,</span> j1<span class=\"token punctuation\">,</span> k1<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* Offsets for second corner of simplex in (i,j,k) coords */</span>\n    <span class=\"token keyword\">int</span> i2<span class=\"token punctuation\">,</span> j2<span class=\"token punctuation\">,</span> k2<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* Offsets for third corner of simplex in (i,j,k) coords */</span>\n\n<span class=\"token comment\" spellcheck=\"true\">/* This code would benefit from a backport from the GLSL version! */</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>x0<span class=\"token operator\">>=</span>y0<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>y0<span class=\"token operator\">>=</span>z0<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span> i1<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> j1<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> k1<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i2<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> j2<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> k2<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span> <span class=\"token comment\" spellcheck=\"true\">/* X Y Z order */</span>\n        <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>x0<span class=\"token operator\">>=</span>z0<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> i1<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> j1<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> k1<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i2<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> j2<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> k2<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span> <span class=\"token comment\" spellcheck=\"true\">/* X Z Y order */</span>\n        <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span> i1<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> j1<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> k1<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> i2<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> j2<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> k2<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span> <span class=\"token comment\" spellcheck=\"true\">/* Z X Y order */</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\" spellcheck=\"true\">/* x0&lt;y0 */</span>\n      <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>y0<span class=\"token operator\">&lt;</span>z0<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> i1<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> j1<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> k1<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> i2<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> j2<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> k2<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span> <span class=\"token comment\" spellcheck=\"true\">/* Z Y X order */</span>\n      <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>x0<span class=\"token operator\">&lt;</span>z0<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> i1<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> j1<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> k1<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i2<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> j2<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> k2<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span> <span class=\"token comment\" spellcheck=\"true\">/* Y Z X order */</span>\n      <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span> i1<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> j1<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> k1<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i2<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> j2<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span> k2<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span> <span class=\"token comment\" spellcheck=\"true\">/* Y X Z order */</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">/* A step of (1,0,0) in (i,j,k) means a step of (1-c,-c,-c) in (x,y,z), */</span>\n    <span class=\"token comment\" spellcheck=\"true\">/* a step of (0,1,0) in (i,j,k) means a step of (-c,1-c,-c) in (x,y,z), and */</span>\n    <span class=\"token comment\" spellcheck=\"true\">/* a step of (0,0,1) in (i,j,k) means a step of (-c,-c,1-c) in (x,y,z), where */</span>\n    <span class=\"token comment\" spellcheck=\"true\">/* c = 1/6. */</span>\n\n    x1 <span class=\"token operator\">=</span> x0 <span class=\"token operator\">-</span> i1 <span class=\"token operator\">+</span> G3<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* Offsets for second corner in (x,y,z) coords */</span>\n    y1 <span class=\"token operator\">=</span> y0 <span class=\"token operator\">-</span> j1 <span class=\"token operator\">+</span> G3<span class=\"token punctuation\">;</span>\n    z1 <span class=\"token operator\">=</span> z0 <span class=\"token operator\">-</span> k1 <span class=\"token operator\">+</span> G3<span class=\"token punctuation\">;</span>\n    x2 <span class=\"token operator\">=</span> x0 <span class=\"token operator\">-</span> i2 <span class=\"token operator\">+</span> <span class=\"token number\">2.0f</span><span class=\"token operator\">*</span>G3<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* Offsets for third corner in (x,y,z) coords */</span>\n    y2 <span class=\"token operator\">=</span> y0 <span class=\"token operator\">-</span> j2 <span class=\"token operator\">+</span> <span class=\"token number\">2.0f</span><span class=\"token operator\">*</span>G3<span class=\"token punctuation\">;</span>\n    z2 <span class=\"token operator\">=</span> z0 <span class=\"token operator\">-</span> k2 <span class=\"token operator\">+</span> <span class=\"token number\">2.0f</span><span class=\"token operator\">*</span>G3<span class=\"token punctuation\">;</span>\n    x3 <span class=\"token operator\">=</span> x0 <span class=\"token operator\">-</span> <span class=\"token number\">1.0f</span> <span class=\"token operator\">+</span> <span class=\"token number\">3.0f</span><span class=\"token operator\">*</span>G3<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* Offsets for last corner in (x,y,z) coords */</span>\n    y3 <span class=\"token operator\">=</span> y0 <span class=\"token operator\">-</span> <span class=\"token number\">1.0f</span> <span class=\"token operator\">+</span> <span class=\"token number\">3.0f</span><span class=\"token operator\">*</span>G3<span class=\"token punctuation\">;</span>\n    z3 <span class=\"token operator\">=</span> z0 <span class=\"token operator\">-</span> <span class=\"token number\">1.0f</span> <span class=\"token operator\">+</span> <span class=\"token number\">3.0f</span><span class=\"token operator\">*</span>G3<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">/* Wrap the integer indices at 256, to avoid indexing perm[] out of bounds */</span>\n    ii <span class=\"token operator\">=</span> i <span class=\"token operator\">%</span> <span class=\"token number\">256</span><span class=\"token punctuation\">;</span>\n    jj <span class=\"token operator\">=</span> j <span class=\"token operator\">%</span> <span class=\"token number\">256</span><span class=\"token punctuation\">;</span>\n    kk <span class=\"token operator\">=</span> k <span class=\"token operator\">%</span> <span class=\"token number\">256</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">/* Calculate the contribution from the four corners */</span>\n    t0 <span class=\"token operator\">=</span> <span class=\"token number\">0.6f</span> <span class=\"token operator\">-</span> x0<span class=\"token operator\">*</span>x0 <span class=\"token operator\">-</span> y0<span class=\"token operator\">*</span>y0 <span class=\"token operator\">-</span> z0<span class=\"token operator\">*</span>z0<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>t0 <span class=\"token operator\">&lt;</span> <span class=\"token number\">0.0f</span><span class=\"token punctuation\">)</span> n0 <span class=\"token operator\">=</span> <span class=\"token number\">0.0f</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      t0 <span class=\"token operator\">*</span><span class=\"token operator\">=</span> t0<span class=\"token punctuation\">;</span>\n      n0 <span class=\"token operator\">=</span> t0 <span class=\"token operator\">*</span> t0 <span class=\"token operator\">*</span> <span class=\"token function\">grad3</span><span class=\"token punctuation\">(</span>perm<span class=\"token punctuation\">[</span>ii<span class=\"token operator\">+</span>perm<span class=\"token punctuation\">[</span>jj<span class=\"token operator\">+</span>perm<span class=\"token punctuation\">[</span>kk<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> x0<span class=\"token punctuation\">,</span> y0<span class=\"token punctuation\">,</span> z0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    t1 <span class=\"token operator\">=</span> <span class=\"token number\">0.6f</span> <span class=\"token operator\">-</span> x1<span class=\"token operator\">*</span>x1 <span class=\"token operator\">-</span> y1<span class=\"token operator\">*</span>y1 <span class=\"token operator\">-</span> z1<span class=\"token operator\">*</span>z1<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>t1 <span class=\"token operator\">&lt;</span> <span class=\"token number\">0.0f</span><span class=\"token punctuation\">)</span> n1 <span class=\"token operator\">=</span> <span class=\"token number\">0.0f</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      t1 <span class=\"token operator\">*</span><span class=\"token operator\">=</span> t1<span class=\"token punctuation\">;</span>\n      n1 <span class=\"token operator\">=</span> t1 <span class=\"token operator\">*</span> t1 <span class=\"token operator\">*</span> <span class=\"token function\">grad3</span><span class=\"token punctuation\">(</span>perm<span class=\"token punctuation\">[</span>ii<span class=\"token operator\">+</span>i1<span class=\"token operator\">+</span>perm<span class=\"token punctuation\">[</span>jj<span class=\"token operator\">+</span>j1<span class=\"token operator\">+</span>perm<span class=\"token punctuation\">[</span>kk<span class=\"token operator\">+</span>k1<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> x1<span class=\"token punctuation\">,</span> y1<span class=\"token punctuation\">,</span> z1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    t2 <span class=\"token operator\">=</span> <span class=\"token number\">0.6f</span> <span class=\"token operator\">-</span> x2<span class=\"token operator\">*</span>x2 <span class=\"token operator\">-</span> y2<span class=\"token operator\">*</span>y2 <span class=\"token operator\">-</span> z2<span class=\"token operator\">*</span>z2<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>t2 <span class=\"token operator\">&lt;</span> <span class=\"token number\">0.0f</span><span class=\"token punctuation\">)</span> n2 <span class=\"token operator\">=</span> <span class=\"token number\">0.0f</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      t2 <span class=\"token operator\">*</span><span class=\"token operator\">=</span> t2<span class=\"token punctuation\">;</span>\n      n2 <span class=\"token operator\">=</span> t2 <span class=\"token operator\">*</span> t2 <span class=\"token operator\">*</span> <span class=\"token function\">grad3</span><span class=\"token punctuation\">(</span>perm<span class=\"token punctuation\">[</span>ii<span class=\"token operator\">+</span>i2<span class=\"token operator\">+</span>perm<span class=\"token punctuation\">[</span>jj<span class=\"token operator\">+</span>j2<span class=\"token operator\">+</span>perm<span class=\"token punctuation\">[</span>kk<span class=\"token operator\">+</span>k2<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> x2<span class=\"token punctuation\">,</span> y2<span class=\"token punctuation\">,</span> z2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    t3 <span class=\"token operator\">=</span> <span class=\"token number\">0.6f</span> <span class=\"token operator\">-</span> x3<span class=\"token operator\">*</span>x3 <span class=\"token operator\">-</span> y3<span class=\"token operator\">*</span>y3 <span class=\"token operator\">-</span> z3<span class=\"token operator\">*</span>z3<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>t3<span class=\"token operator\">&lt;</span><span class=\"token number\">0.0f</span><span class=\"token punctuation\">)</span> n3 <span class=\"token operator\">=</span> <span class=\"token number\">0.0f</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      t3 <span class=\"token operator\">*</span><span class=\"token operator\">=</span> t3<span class=\"token punctuation\">;</span>\n      n3 <span class=\"token operator\">=</span> t3 <span class=\"token operator\">*</span> t3 <span class=\"token operator\">*</span> <span class=\"token function\">grad3</span><span class=\"token punctuation\">(</span>perm<span class=\"token punctuation\">[</span>ii<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token operator\">+</span>perm<span class=\"token punctuation\">[</span>jj<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token operator\">+</span>perm<span class=\"token punctuation\">[</span>kk<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> x3<span class=\"token punctuation\">,</span> y3<span class=\"token punctuation\">,</span> z3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">/* Add contributions from each corner to get the final noise value. */</span>\n    <span class=\"token comment\" spellcheck=\"true\">/* The result is scaled to stay just inside [-1,1] */</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">32.0f</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>n0 <span class=\"token operator\">+</span> n1 <span class=\"token operator\">+</span> n2 <span class=\"token operator\">+</span> n3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* TODO: The scale factor is preliminary! */</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\" spellcheck=\"true\">/* 4D simplex noise */</span>\n<span class=\"token keyword\">inline</span> <span class=\"token keyword\">float</span> <span class=\"token function\">_slang_library_noise4</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span> x<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float</span> y<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float</span> z<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float</span> w<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t<span class=\"token comment\" spellcheck=\"true\">/* The skewing and unskewing factors are hairy again for the 4D case */</span>\n\t<span class=\"token keyword\">constexpr</span> <span class=\"token keyword\">float</span> F4 <span class=\"token operator\">=</span> <span class=\"token number\">0.309016994f</span><span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* F4 = (Math.sqrt(5.0)-1.0)/4.0 */</span>\n\t<span class=\"token keyword\">constexpr</span> <span class=\"token keyword\">float</span> G4 <span class=\"token operator\">=</span> <span class=\"token number\">0.138196601f</span><span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* G4 = (5.0-Math.sqrt(5.0))/20.0 */</span>\n\n\t<span class=\"token keyword\">float</span> n0<span class=\"token punctuation\">,</span> n1<span class=\"token punctuation\">,</span> n2<span class=\"token punctuation\">,</span> n3<span class=\"token punctuation\">,</span> n4<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* Noise contributions from the five corners */</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">/* Skew the (x,y,z,w) space to determine which cell of 24 simplices we're in */</span>\n\t<span class=\"token keyword\">float</span> s <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>x <span class=\"token operator\">+</span> y <span class=\"token operator\">+</span> z <span class=\"token operator\">+</span> w<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> F4<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* Factor for 4D skewing */</span>\n\t<span class=\"token keyword\">float</span> xs <span class=\"token operator\">=</span> x <span class=\"token operator\">+</span> s<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">float</span> ys <span class=\"token operator\">=</span> y <span class=\"token operator\">+</span> s<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">float</span> zs <span class=\"token operator\">=</span> z <span class=\"token operator\">+</span> s<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">float</span> ws <span class=\"token operator\">=</span> w <span class=\"token operator\">+</span> s<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token function\">OFNOISE_FASTFLOOR</span><span class=\"token punctuation\">(</span>xs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">int</span> j <span class=\"token operator\">=</span> <span class=\"token function\">OFNOISE_FASTFLOOR</span><span class=\"token punctuation\">(</span>ys<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">int</span> k <span class=\"token operator\">=</span> <span class=\"token function\">OFNOISE_FASTFLOOR</span><span class=\"token punctuation\">(</span>zs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">int</span> l <span class=\"token operator\">=</span> <span class=\"token function\">OFNOISE_FASTFLOOR</span><span class=\"token punctuation\">(</span>ws<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">float</span> t <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> j <span class=\"token operator\">+</span> k <span class=\"token operator\">+</span> l<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> G4<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* Factor for 4D unskewing */</span>\n\t<span class=\"token keyword\">float</span> X0 <span class=\"token operator\">=</span> i <span class=\"token operator\">-</span> t<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* Unskew the cell origin back to (x,y,z,w) space */</span>\n\t<span class=\"token keyword\">float</span> Y0 <span class=\"token operator\">=</span> j <span class=\"token operator\">-</span> t<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">float</span> Z0 <span class=\"token operator\">=</span> k <span class=\"token operator\">-</span> t<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">float</span> W0 <span class=\"token operator\">=</span> l <span class=\"token operator\">-</span> t<span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">float</span> x0 <span class=\"token operator\">=</span> x <span class=\"token operator\">-</span> X0<span class=\"token punctuation\">;</span>  <span class=\"token comment\" spellcheck=\"true\">/* The x,y,z,w distances from the cell origin */</span>\n\t<span class=\"token keyword\">float</span> y0 <span class=\"token operator\">=</span> y <span class=\"token operator\">-</span> Y0<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">float</span> z0 <span class=\"token operator\">=</span> z <span class=\"token operator\">-</span> Z0<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">float</span> w0 <span class=\"token operator\">=</span> w <span class=\"token operator\">-</span> W0<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">/* For the 4D case, the simplex is a 4D shape I won't even try to describe. */</span>\n    <span class=\"token comment\" spellcheck=\"true\">/* To find out which of the 24 possible simplices we're in, we need to */</span>\n    <span class=\"token comment\" spellcheck=\"true\">/* determine the magnitude ordering of x0, y0, z0 and w0. */</span>\n    <span class=\"token comment\" spellcheck=\"true\">/* The method below is a good way of finding the ordering of x,y,z,w and */</span>\n    <span class=\"token comment\" spellcheck=\"true\">/* then find the correct traversal order for the simplex we're in. */</span>\n    <span class=\"token comment\" spellcheck=\"true\">/* First, six pair-wise comparisons are performed between each possible pair */</span>\n    <span class=\"token comment\" spellcheck=\"true\">/* of the four coordinates, and the results are used to add up binary bits */</span>\n    <span class=\"token comment\" spellcheck=\"true\">/* for an integer index. */</span>\n    <span class=\"token keyword\">int</span> c1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>x0 <span class=\"token operator\">></span> y0<span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token number\">32</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> c2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>x0 <span class=\"token operator\">></span> z0<span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token number\">16</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> c3 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>y0 <span class=\"token operator\">></span> z0<span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token number\">8</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> c4 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>x0 <span class=\"token operator\">></span> w0<span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token number\">4</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> c5 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>y0 <span class=\"token operator\">></span> w0<span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token number\">2</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> c6 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>z0 <span class=\"token operator\">></span> w0<span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> c <span class=\"token operator\">=</span> c1 <span class=\"token operator\">+</span> c2 <span class=\"token operator\">+</span> c3 <span class=\"token operator\">+</span> c4 <span class=\"token operator\">+</span> c5 <span class=\"token operator\">+</span> c6<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">int</span> i1<span class=\"token punctuation\">,</span> j1<span class=\"token punctuation\">,</span> k1<span class=\"token punctuation\">,</span> l1<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* The integer offsets for the second simplex corner */</span>\n    <span class=\"token keyword\">int</span> i2<span class=\"token punctuation\">,</span> j2<span class=\"token punctuation\">,</span> k2<span class=\"token punctuation\">,</span> l2<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* The integer offsets for the third simplex corner */</span>\n    <span class=\"token keyword\">int</span> i3<span class=\"token punctuation\">,</span> j3<span class=\"token punctuation\">,</span> k3<span class=\"token punctuation\">,</span> l3<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* The integer offsets for the fourth simplex corner */</span>\n\n\t<span class=\"token keyword\">float</span> x1<span class=\"token punctuation\">,</span> y1<span class=\"token punctuation\">,</span> z1<span class=\"token punctuation\">,</span> w1<span class=\"token punctuation\">,</span> x2<span class=\"token punctuation\">,</span> y2<span class=\"token punctuation\">,</span> z2<span class=\"token punctuation\">,</span> w2<span class=\"token punctuation\">,</span> x3<span class=\"token punctuation\">,</span> y3<span class=\"token punctuation\">,</span> z3<span class=\"token punctuation\">,</span> w3<span class=\"token punctuation\">,</span> x4<span class=\"token punctuation\">,</span> y4<span class=\"token punctuation\">,</span> z4<span class=\"token punctuation\">,</span> w4<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> ii<span class=\"token punctuation\">,</span> jj<span class=\"token punctuation\">,</span> kk<span class=\"token punctuation\">,</span> ll<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">float</span> t0<span class=\"token punctuation\">,</span> t1<span class=\"token punctuation\">,</span> t2<span class=\"token punctuation\">,</span> t3<span class=\"token punctuation\">,</span> t4<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">/* simplex[c] is a 4-vector with the numbers 0, 1, 2 and 3 in some order. */</span>\n    <span class=\"token comment\" spellcheck=\"true\">/* Many values of c will never occur, since e.g. x>y>z>w makes x&lt;z, y&lt;w and x&lt;w */</span>\n    <span class=\"token comment\" spellcheck=\"true\">/* impossible. Only the 24 indices which have non-zero entries make any sense. */</span>\n    <span class=\"token comment\" spellcheck=\"true\">/* We use a thresholding to set the coordinates in turn from the largest magnitude. */</span>\n    <span class=\"token comment\" spellcheck=\"true\">/* The number 3 in the \"simplex\" array is at the position of the largest coordinate. */</span>\n    i1 <span class=\"token operator\">=</span> simplex<span class=\"token punctuation\">[</span>c<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">>=</span><span class=\"token number\">3</span> <span class=\"token operator\">?</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    j1 <span class=\"token operator\">=</span> simplex<span class=\"token punctuation\">[</span>c<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">>=</span><span class=\"token number\">3</span> <span class=\"token operator\">?</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    k1 <span class=\"token operator\">=</span> simplex<span class=\"token punctuation\">[</span>c<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token operator\">>=</span><span class=\"token number\">3</span> <span class=\"token operator\">?</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    l1 <span class=\"token operator\">=</span> simplex<span class=\"token punctuation\">[</span>c<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token operator\">>=</span><span class=\"token number\">3</span> <span class=\"token operator\">?</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\" spellcheck=\"true\">/* The number 2 in the \"simplex\" array is at the second largest coordinate. */</span>\n    i2 <span class=\"token operator\">=</span> simplex<span class=\"token punctuation\">[</span>c<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">>=</span><span class=\"token number\">2</span> <span class=\"token operator\">?</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    j2 <span class=\"token operator\">=</span> simplex<span class=\"token punctuation\">[</span>c<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">>=</span><span class=\"token number\">2</span> <span class=\"token operator\">?</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    k2 <span class=\"token operator\">=</span> simplex<span class=\"token punctuation\">[</span>c<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token operator\">>=</span><span class=\"token number\">2</span> <span class=\"token operator\">?</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    l2 <span class=\"token operator\">=</span> simplex<span class=\"token punctuation\">[</span>c<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token operator\">>=</span><span class=\"token number\">2</span> <span class=\"token operator\">?</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\" spellcheck=\"true\">/* The number 1 in the \"simplex\" array is at the second smallest coordinate. */</span>\n    i3 <span class=\"token operator\">=</span> simplex<span class=\"token punctuation\">[</span>c<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">>=</span><span class=\"token number\">1</span> <span class=\"token operator\">?</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    j3 <span class=\"token operator\">=</span> simplex<span class=\"token punctuation\">[</span>c<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">>=</span><span class=\"token number\">1</span> <span class=\"token operator\">?</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    k3 <span class=\"token operator\">=</span> simplex<span class=\"token punctuation\">[</span>c<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token operator\">>=</span><span class=\"token number\">1</span> <span class=\"token operator\">?</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    l3 <span class=\"token operator\">=</span> simplex<span class=\"token punctuation\">[</span>c<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token operator\">>=</span><span class=\"token number\">1</span> <span class=\"token operator\">?</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\" spellcheck=\"true\">/* The fifth corner has all coordinate offsets = 1, so no need to look that up. */</span>\n\n    x1 <span class=\"token operator\">=</span> x0 <span class=\"token operator\">-</span> i1 <span class=\"token operator\">+</span> G4<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* Offsets for second corner in (x,y,z,w) coords */</span>\n    y1 <span class=\"token operator\">=</span> y0 <span class=\"token operator\">-</span> j1 <span class=\"token operator\">+</span> G4<span class=\"token punctuation\">;</span>\n    z1 <span class=\"token operator\">=</span> z0 <span class=\"token operator\">-</span> k1 <span class=\"token operator\">+</span> G4<span class=\"token punctuation\">;</span>\n    w1 <span class=\"token operator\">=</span> w0 <span class=\"token operator\">-</span> l1 <span class=\"token operator\">+</span> G4<span class=\"token punctuation\">;</span>\n    x2 <span class=\"token operator\">=</span> x0 <span class=\"token operator\">-</span> i2 <span class=\"token operator\">+</span> <span class=\"token number\">2.0f</span><span class=\"token operator\">*</span>G4<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* Offsets for third corner in (x,y,z,w) coords */</span>\n    y2 <span class=\"token operator\">=</span> y0 <span class=\"token operator\">-</span> j2 <span class=\"token operator\">+</span> <span class=\"token number\">2.0f</span><span class=\"token operator\">*</span>G4<span class=\"token punctuation\">;</span>\n    z2 <span class=\"token operator\">=</span> z0 <span class=\"token operator\">-</span> k2 <span class=\"token operator\">+</span> <span class=\"token number\">2.0f</span><span class=\"token operator\">*</span>G4<span class=\"token punctuation\">;</span>\n    w2 <span class=\"token operator\">=</span> w0 <span class=\"token operator\">-</span> l2 <span class=\"token operator\">+</span> <span class=\"token number\">2.0f</span><span class=\"token operator\">*</span>G4<span class=\"token punctuation\">;</span>\n    x3 <span class=\"token operator\">=</span> x0 <span class=\"token operator\">-</span> i3 <span class=\"token operator\">+</span> <span class=\"token number\">3.0f</span><span class=\"token operator\">*</span>G4<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* Offsets for fourth corner in (x,y,z,w) coords */</span>\n    y3 <span class=\"token operator\">=</span> y0 <span class=\"token operator\">-</span> j3 <span class=\"token operator\">+</span> <span class=\"token number\">3.0f</span><span class=\"token operator\">*</span>G4<span class=\"token punctuation\">;</span>\n    z3 <span class=\"token operator\">=</span> z0 <span class=\"token operator\">-</span> k3 <span class=\"token operator\">+</span> <span class=\"token number\">3.0f</span><span class=\"token operator\">*</span>G4<span class=\"token punctuation\">;</span>\n    w3 <span class=\"token operator\">=</span> w0 <span class=\"token operator\">-</span> l3 <span class=\"token operator\">+</span> <span class=\"token number\">3.0f</span><span class=\"token operator\">*</span>G4<span class=\"token punctuation\">;</span>\n    x4 <span class=\"token operator\">=</span> x0 <span class=\"token operator\">-</span> <span class=\"token number\">1.0f</span> <span class=\"token operator\">+</span> <span class=\"token number\">4.0f</span><span class=\"token operator\">*</span>G4<span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* Offsets for last corner in (x,y,z,w) coords */</span>\n    y4 <span class=\"token operator\">=</span> y0 <span class=\"token operator\">-</span> <span class=\"token number\">1.0f</span> <span class=\"token operator\">+</span> <span class=\"token number\">4.0f</span><span class=\"token operator\">*</span>G4<span class=\"token punctuation\">;</span>\n    z4 <span class=\"token operator\">=</span> z0 <span class=\"token operator\">-</span> <span class=\"token number\">1.0f</span> <span class=\"token operator\">+</span> <span class=\"token number\">4.0f</span><span class=\"token operator\">*</span>G4<span class=\"token punctuation\">;</span>\n    w4 <span class=\"token operator\">=</span> w0 <span class=\"token operator\">-</span> <span class=\"token number\">1.0f</span> <span class=\"token operator\">+</span> <span class=\"token number\">4.0f</span><span class=\"token operator\">*</span>G4<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">/* Wrap the integer indices at 256, to avoid indexing perm[] out of bounds */</span>\n    ii <span class=\"token operator\">=</span> i <span class=\"token operator\">%</span> <span class=\"token number\">256</span><span class=\"token punctuation\">;</span>\n    jj <span class=\"token operator\">=</span> j <span class=\"token operator\">%</span> <span class=\"token number\">256</span><span class=\"token punctuation\">;</span>\n    kk <span class=\"token operator\">=</span> k <span class=\"token operator\">%</span> <span class=\"token number\">256</span><span class=\"token punctuation\">;</span>\n    ll <span class=\"token operator\">=</span> l <span class=\"token operator\">%</span> <span class=\"token number\">256</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">/* Calculate the contribution from the five corners */</span>\n    t0 <span class=\"token operator\">=</span> <span class=\"token number\">0.6f</span> <span class=\"token operator\">-</span> x0<span class=\"token operator\">*</span>x0 <span class=\"token operator\">-</span> y0<span class=\"token operator\">*</span>y0 <span class=\"token operator\">-</span> z0<span class=\"token operator\">*</span>z0 <span class=\"token operator\">-</span> w0<span class=\"token operator\">*</span>w0<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>t0 <span class=\"token operator\">&lt;</span> <span class=\"token number\">0.0f</span><span class=\"token punctuation\">)</span> n0 <span class=\"token operator\">=</span> <span class=\"token number\">0.0f</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      t0 <span class=\"token operator\">*</span><span class=\"token operator\">=</span> t0<span class=\"token punctuation\">;</span>\n      n0 <span class=\"token operator\">=</span> t0 <span class=\"token operator\">*</span> t0 <span class=\"token operator\">*</span> <span class=\"token function\">grad4</span><span class=\"token punctuation\">(</span>perm<span class=\"token punctuation\">[</span>ii<span class=\"token operator\">+</span>perm<span class=\"token punctuation\">[</span>jj<span class=\"token operator\">+</span>perm<span class=\"token punctuation\">[</span>kk<span class=\"token operator\">+</span>perm<span class=\"token punctuation\">[</span>ll<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> x0<span class=\"token punctuation\">,</span> y0<span class=\"token punctuation\">,</span> z0<span class=\"token punctuation\">,</span> w0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n   t1 <span class=\"token operator\">=</span> <span class=\"token number\">0.6f</span> <span class=\"token operator\">-</span> x1<span class=\"token operator\">*</span>x1 <span class=\"token operator\">-</span> y1<span class=\"token operator\">*</span>y1 <span class=\"token operator\">-</span> z1<span class=\"token operator\">*</span>z1 <span class=\"token operator\">-</span> w1<span class=\"token operator\">*</span>w1<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>t1 <span class=\"token operator\">&lt;</span> <span class=\"token number\">0.0f</span><span class=\"token punctuation\">)</span> n1 <span class=\"token operator\">=</span> <span class=\"token number\">0.0f</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      t1 <span class=\"token operator\">*</span><span class=\"token operator\">=</span> t1<span class=\"token punctuation\">;</span>\n      n1 <span class=\"token operator\">=</span> t1 <span class=\"token operator\">*</span> t1 <span class=\"token operator\">*</span> <span class=\"token function\">grad4</span><span class=\"token punctuation\">(</span>perm<span class=\"token punctuation\">[</span>ii<span class=\"token operator\">+</span>i1<span class=\"token operator\">+</span>perm<span class=\"token punctuation\">[</span>jj<span class=\"token operator\">+</span>j1<span class=\"token operator\">+</span>perm<span class=\"token punctuation\">[</span>kk<span class=\"token operator\">+</span>k1<span class=\"token operator\">+</span>perm<span class=\"token punctuation\">[</span>ll<span class=\"token operator\">+</span>l1<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> x1<span class=\"token punctuation\">,</span> y1<span class=\"token punctuation\">,</span> z1<span class=\"token punctuation\">,</span> w1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n   t2 <span class=\"token operator\">=</span> <span class=\"token number\">0.6f</span> <span class=\"token operator\">-</span> x2<span class=\"token operator\">*</span>x2 <span class=\"token operator\">-</span> y2<span class=\"token operator\">*</span>y2 <span class=\"token operator\">-</span> z2<span class=\"token operator\">*</span>z2 <span class=\"token operator\">-</span> w2<span class=\"token operator\">*</span>w2<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>t2 <span class=\"token operator\">&lt;</span> <span class=\"token number\">0.0f</span><span class=\"token punctuation\">)</span> n2 <span class=\"token operator\">=</span> <span class=\"token number\">0.0f</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      t2 <span class=\"token operator\">*</span><span class=\"token operator\">=</span> t2<span class=\"token punctuation\">;</span>\n      n2 <span class=\"token operator\">=</span> t2 <span class=\"token operator\">*</span> t2 <span class=\"token operator\">*</span> <span class=\"token function\">grad4</span><span class=\"token punctuation\">(</span>perm<span class=\"token punctuation\">[</span>ii<span class=\"token operator\">+</span>i2<span class=\"token operator\">+</span>perm<span class=\"token punctuation\">[</span>jj<span class=\"token operator\">+</span>j2<span class=\"token operator\">+</span>perm<span class=\"token punctuation\">[</span>kk<span class=\"token operator\">+</span>k2<span class=\"token operator\">+</span>perm<span class=\"token punctuation\">[</span>ll<span class=\"token operator\">+</span>l2<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> x2<span class=\"token punctuation\">,</span> y2<span class=\"token punctuation\">,</span> z2<span class=\"token punctuation\">,</span> w2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n   t3 <span class=\"token operator\">=</span> <span class=\"token number\">0.6f</span> <span class=\"token operator\">-</span> x3<span class=\"token operator\">*</span>x3 <span class=\"token operator\">-</span> y3<span class=\"token operator\">*</span>y3 <span class=\"token operator\">-</span> z3<span class=\"token operator\">*</span>z3 <span class=\"token operator\">-</span> w3<span class=\"token operator\">*</span>w3<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>t3 <span class=\"token operator\">&lt;</span> <span class=\"token number\">0.0f</span><span class=\"token punctuation\">)</span> n3 <span class=\"token operator\">=</span> <span class=\"token number\">0.0f</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      t3 <span class=\"token operator\">*</span><span class=\"token operator\">=</span> t3<span class=\"token punctuation\">;</span>\n      n3 <span class=\"token operator\">=</span> t3 <span class=\"token operator\">*</span> t3 <span class=\"token operator\">*</span> <span class=\"token function\">grad4</span><span class=\"token punctuation\">(</span>perm<span class=\"token punctuation\">[</span>ii<span class=\"token operator\">+</span>i3<span class=\"token operator\">+</span>perm<span class=\"token punctuation\">[</span>jj<span class=\"token operator\">+</span>j3<span class=\"token operator\">+</span>perm<span class=\"token punctuation\">[</span>kk<span class=\"token operator\">+</span>k3<span class=\"token operator\">+</span>perm<span class=\"token punctuation\">[</span>ll<span class=\"token operator\">+</span>l3<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> x3<span class=\"token punctuation\">,</span> y3<span class=\"token punctuation\">,</span> z3<span class=\"token punctuation\">,</span> w3<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n   t4 <span class=\"token operator\">=</span> <span class=\"token number\">0.6f</span> <span class=\"token operator\">-</span> x4<span class=\"token operator\">*</span>x4 <span class=\"token operator\">-</span> y4<span class=\"token operator\">*</span>y4 <span class=\"token operator\">-</span> z4<span class=\"token operator\">*</span>z4 <span class=\"token operator\">-</span> w4<span class=\"token operator\">*</span>w4<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>t4 <span class=\"token operator\">&lt;</span> <span class=\"token number\">0.0f</span><span class=\"token punctuation\">)</span> n4 <span class=\"token operator\">=</span> <span class=\"token number\">0.0f</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      t4 <span class=\"token operator\">*</span><span class=\"token operator\">=</span> t4<span class=\"token punctuation\">;</span>\n      n4 <span class=\"token operator\">=</span> t4 <span class=\"token operator\">*</span> t4 <span class=\"token operator\">*</span> <span class=\"token function\">grad4</span><span class=\"token punctuation\">(</span>perm<span class=\"token punctuation\">[</span>ii<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token operator\">+</span>perm<span class=\"token punctuation\">[</span>jj<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token operator\">+</span>perm<span class=\"token punctuation\">[</span>kk<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token operator\">+</span>perm<span class=\"token punctuation\">[</span>ll<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> x4<span class=\"token punctuation\">,</span> y4<span class=\"token punctuation\">,</span> z4<span class=\"token punctuation\">,</span> w4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\" spellcheck=\"true\">/* Sum up and scale the result to cover the range [-1,1] */</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">27.0f</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>n0 <span class=\"token operator\">+</span> n1 <span class=\"token operator\">+</span> n2 <span class=\"token operator\">+</span> n3 <span class=\"token operator\">+</span> n4<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\" spellcheck=\"true\">/* TODO: The scale factor is preliminary! */</span>\n<span class=\"token punctuation\">}</span>\n","type":"source","static":true}}],"fetch":[]}