{"data":[{"page":{"entry":{"name":"ImageSaverThread.cpp","filename":"ImageSaverThread.cpp","absolute":"/Users/Gilbert/Code/openFrameworks/examples/gl/threadedPixelBufferExample/src/ImageSaverThread.cpp","path":"/examples/gl/threadedPixelBufferExample/src/ImageSaverThread_cpp","route":"/examples/gl/threadedPixelBufferExample/src/ImageSaverThread.cpp","dir":"../examples/gl/threadedPixelBufferExample/src","ext":"cpp","type":"source","id":911,"parent":909,"breadcrumbs":[909,910,783,436],"siblings":[],"translations":{}},"document":"<span class=\"token comment\" spellcheck=\"true\">/*\n * ImageSaverThread.cpp\n *\n *  Created on: Oct 14, 2014\n *      Author: arturo\n */</span>\n\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">\"ImageSaverThread.h\"</span></span>\n\nImageSaverThread<span class=\"token operator\">::</span><span class=\"token function\">ImageSaverThread</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\t<span class=\"token function\">startThread</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nImageSaverThread<span class=\"token operator\">::</span><span class=\"token operator\">~</span><span class=\"token function\">ImageSaverThread</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\tchannel<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\tchannelReady<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">waitForThread</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">void</span> ImageSaverThread<span class=\"token operator\">::</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span> pixels<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\t<span class=\"token comment\" spellcheck=\"true\">// send the pixels to save to the thread</span>\n\tchannel<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>pixels<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">void</span> ImageSaverThread<span class=\"token operator\">::</span><span class=\"token function\">waitReady</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\t<span class=\"token comment\" spellcheck=\"true\">// wait till the thread is done saving the</span>\n\t<span class=\"token comment\" spellcheck=\"true\">// previous frame</span>\n\t<span class=\"token keyword\">bool</span> ready<span class=\"token punctuation\">;</span>\n\tchannelReady<span class=\"token punctuation\">.</span><span class=\"token function\">receive</span><span class=\"token punctuation\">(</span>ready<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">void</span> ImageSaverThread<span class=\"token operator\">::</span><span class=\"token function\">threadedFunction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\t<span class=\"token comment\" spellcheck=\"true\">// wait to receive some pixels,</span>\n\t<span class=\"token comment\" spellcheck=\"true\">// save them as jpeg and then tell the main</span>\n\t<span class=\"token comment\" spellcheck=\"true\">// thread that we are done</span>\n\t<span class=\"token comment\" spellcheck=\"true\">// if the channel closes go out of the thread</span>\n\t<span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span> p<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span>channel<span class=\"token punctuation\">.</span><span class=\"token function\">receive</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\t\tpixels<span class=\"token punctuation\">.</span><span class=\"token function\">setFromPixels</span><span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">,</span><span class=\"token number\">1024</span><span class=\"token punctuation\">,</span><span class=\"token number\">768</span><span class=\"token punctuation\">,</span>OF_PIXELS_RGB<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">ofSaveImage</span><span class=\"token punctuation\">(</span>pixels<span class=\"token punctuation\">,</span><span class=\"token function\">ofToString</span><span class=\"token punctuation\">(</span><span class=\"token function\">ofGetFrameNum</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">\".jpg\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tchannelReady<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n","type":"source","static":true}}],"fetch":[]}