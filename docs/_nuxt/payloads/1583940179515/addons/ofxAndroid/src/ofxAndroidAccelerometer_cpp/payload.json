{"data":[{"page":{"entry":{"name":"ofxAndroidAccelerometer.cpp","filename":"ofxAndroidAccelerometer.cpp","absolute":"/Users/Gilbert/Code/openFrameworks/addons/ofxAndroid/src/ofxAndroidAccelerometer.cpp","path":"/addons/ofxAndroid/src/ofxAndroidAccelerometer_cpp","route":"/addons/ofxAndroid/src/ofxAndroidAccelerometer.cpp","dir":"../addons/ofxAndroid/src","ext":"cpp","type":"source","id":44,"parent":39,"breadcrumbs":[39,40,36],"siblings":[],"translations":{}},"document":"<span class=\"token comment\" spellcheck=\"true\">/*\n * ofxAndroidAccelerometer.cpp\n *\n *  Created on: 28/11/2010\n *      Author: arturo\n */</span>\n\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;jni.h></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">\"ofxAccelerometer.h\"</span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">\"ofxAndroidUtils.h\"</span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">\"ofLog.h\"</span></span>\n\n<span class=\"token keyword\">extern</span> <span class=\"token string\">\"C\"</span><span class=\"token punctuation\">{</span>\n<span class=\"token keyword\">void</span>\n<span class=\"token function\">Java_cc_openframeworks_OFAndroidAccelerometer_updateAccelerometer</span><span class=\"token punctuation\">(</span> JNIEnv<span class=\"token operator\">*</span>  env<span class=\"token punctuation\">,</span> jobject  thiz<span class=\"token punctuation\">,</span> jfloat x<span class=\"token punctuation\">,</span> jfloat y<span class=\"token punctuation\">,</span> jfloat z <span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\t<span class=\"token comment\" spellcheck=\"true\">// android reports these in m/s^2, but ofxAccelerometer expects g's (1g = gravity = 9.81m/s^2)</span>\n\tofxAccelerometer<span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>x<span class=\"token operator\">/</span><span class=\"token number\">9.81</span><span class=\"token punctuation\">,</span><span class=\"token operator\">-</span>y<span class=\"token operator\">/</span><span class=\"token number\">9.81</span><span class=\"token punctuation\">,</span><span class=\"token operator\">-</span>z<span class=\"token operator\">/</span><span class=\"token number\">9.81</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">void</span> ofxAccelerometerHandler<span class=\"token operator\">::</span><span class=\"token function\">setup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">ofGetJavaVMPtr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">ofLogError</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ofxAndroidAccelerometer\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"setup(): couldn't find java virtual machine\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\tJNIEnv <span class=\"token operator\">*</span>env<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">ofGetJavaVMPtr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">GetEnv</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span>env<span class=\"token punctuation\">,</span> JNI_VERSION_1_4<span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> JNI_OK<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">ofLogError</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ofxAndroidAccelerometer\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"setup(): failed to get environment using GetEnv()\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\tjclass <span class=\"token class-name\">javaClass</span> <span class=\"token operator\">=</span> env<span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">FindClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"cc/openframeworks/OFAndroid\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>javaClass<span class=\"token operator\">==</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">ofLogError</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ofxAndroidAccelerometer\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"setup(): couldn't find OFAndroid java class\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\n\tjmethodID setupAccelerometer <span class=\"token operator\">=</span> env<span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">GetStaticMethodID</span><span class=\"token punctuation\">(</span>javaClass<span class=\"token punctuation\">,</span><span class=\"token string\">\"setupAccelerometer\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"()V\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>setupAccelerometer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">ofLogError</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ofxAndroidAccelerometer\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"setup(): couldn't find OFAndroid.setupAccelerometer method\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\tenv<span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">CallStaticVoidMethod</span><span class=\"token punctuation\">(</span>javaClass<span class=\"token punctuation\">,</span>setupAccelerometer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">void</span> ofxAccelerometerHandler<span class=\"token operator\">::</span><span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\n<span class=\"token punctuation\">}</span>\n","type":"source","static":true}}],"fetch":[]}