{"data":[{"page":{"entry":{"name":"ofxAndroidVibrator.cpp","filename":"ofxAndroidVibrator.cpp","absolute":"/Users/Gilbert/Code/openFrameworks/addons/ofxAndroid/src/ofxAndroidVibrator.cpp","path":"/addons/ofxAndroid/src/ofxAndroidVibrator_cpp","route":"/addons/ofxAndroid/src/ofxAndroidVibrator.cpp","dir":"../addons/ofxAndroid/src","ext":"cpp","type":"source","id":55,"parent":39,"breadcrumbs":[39,40,36],"siblings":[],"translations":{}},"document":"<span class=\"token comment\" spellcheck=\"true\">/*\n * ofxAndroidVibrator.cpp\n *\n *  Created on: Feb 21, 2013\n *      Author: arturo\n */</span>\n\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">\"ofxAndroidVibrator.h\"</span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">\"ofxAndroidUtils.h\"</span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">\"ofLog.h\"</span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;jni.h></span></span>\n\n<span class=\"token keyword\">using</span> <span class=\"token keyword\">namespace</span> std<span class=\"token punctuation\">;</span>\n\nofxAndroidVibrator<span class=\"token operator\">::</span><span class=\"token function\">ofxAndroidVibrator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token comment\" spellcheck=\"true\">// TODO Auto-generated constructor stub</span>\n\n<span class=\"token punctuation\">}</span>\n\nofxAndroidVibrator<span class=\"token operator\">::</span><span class=\"token operator\">~</span><span class=\"token function\">ofxAndroidVibrator</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token comment\" spellcheck=\"true\">// TODO Auto-generated destructor stub</span>\n<span class=\"token punctuation\">}</span>\n\njobject ofxAndroidVibrator<span class=\"token operator\">::</span><span class=\"token function\">getVibratorService</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\tjobject activity <span class=\"token operator\">=</span> <span class=\"token function\">ofGetOFActivityObject</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\tjclass <span class=\"token class-name\">contextClass</span> <span class=\"token operator\">=</span> <span class=\"token function\">ofGetJNIEnv</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">FindClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"android/content/Context\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>contextClass<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">ofLogError</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ofxAndroidVibrator\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"getVibratorService(): couldn't get Context class\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\tjmethodID method <span class=\"token operator\">=</span> <span class=\"token function\">ofGetJNIEnv</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">GetMethodID</span><span class=\"token punctuation\">(</span>contextClass<span class=\"token punctuation\">,</span><span class=\"token string\">\"getSystemService\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"(Ljava/lang/String;)Ljava/lang/Object;\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>method<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">ofLogError</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ofxAndroidVibrator\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"getVibratorService(): getSystemService not found\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\tjfieldID vibratorServiceField <span class=\"token operator\">=</span> <span class=\"token function\">ofGetJNIEnv</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">GetStaticFieldID</span><span class=\"token punctuation\">(</span>contextClass<span class=\"token punctuation\">,</span><span class=\"token string\">\"VIBRATOR_SERVICE\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"Ljava/lang/String;\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>vibratorServiceField<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">ofLogError</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ofxAndroidVibrator\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"getVibratorService(): VIBRATOR_SERVICE id not found\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\tjstring vibratorServiceStr <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>jstring<span class=\"token punctuation\">)</span><span class=\"token function\">ofGetJNIEnv</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">GetStaticObjectField</span><span class=\"token punctuation\">(</span>contextClass<span class=\"token punctuation\">,</span>vibratorServiceField<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>vibratorServiceStr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">ofLogError</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ofxAndroidVibrator\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"getVibratorService(): couldn't get VIBRATOR_SERVICE value\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\tjobject vibratorService <span class=\"token operator\">=</span> <span class=\"token function\">ofGetJNIEnv</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">CallObjectMethod</span><span class=\"token punctuation\">(</span>activity<span class=\"token punctuation\">,</span>method<span class=\"token punctuation\">,</span>vibratorServiceStr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>vibratorService<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">ofLogError</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ofxAndroidVibrator\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"getVibratorService(): couldn't call getSystemService\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\n\t<span class=\"token keyword\">return</span> vibratorService<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\njmethodID ofxAndroidVibrator<span class=\"token operator\">::</span><span class=\"token function\">getVibratorMethodID</span><span class=\"token punctuation\">(</span>string name<span class=\"token punctuation\">,</span> string signature<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\tjclass <span class=\"token class-name\">vibratorClass</span> <span class=\"token operator\">=</span> <span class=\"token function\">ofGetJNIEnv</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">FindClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"android/os/Vibrator\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>vibratorClass<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">ofLogError</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ofxAndroidVibrator\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"getVibratorMethodID(): couldn't get Vibrator class\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token keyword\">return</span> <span class=\"token function\">ofGetJNIEnv</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">GetMethodID</span><span class=\"token punctuation\">(</span>vibratorClass<span class=\"token punctuation\">,</span>name<span class=\"token punctuation\">.</span><span class=\"token function\">c_str</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>signature<span class=\"token punctuation\">.</span><span class=\"token function\">c_str</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">void</span> ofxAndroidVibrator<span class=\"token operator\">::</span><span class=\"token function\">vibrate</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">long</span> milliseconds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\tjobject vibratorService <span class=\"token operator\">=</span> <span class=\"token function\">getVibratorService</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\tjmethodID vibrateMethod <span class=\"token operator\">=</span> <span class=\"token function\">getVibratorMethodID</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"vibrate\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"(J)V\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>vibrateMethod<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">ofLogError</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ofxAndroidVibrator\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"vibrate(): couldn't get vibrate method\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token function\">ofGetJNIEnv</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">CallVoidMethod</span><span class=\"token punctuation\">(</span>vibratorService<span class=\"token punctuation\">,</span>vibrateMethod<span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span>jlong<span class=\"token punctuation\">)</span>milliseconds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">void</span> ofxAndroidVibrator<span class=\"token operator\">::</span><span class=\"token function\">stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\tjobject vibratorService <span class=\"token operator\">=</span> <span class=\"token function\">getVibratorService</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\tjmethodID vibrateMethod <span class=\"token operator\">=</span> <span class=\"token function\">getVibratorMethodID</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"cancel\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"()V\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>vibrateMethod<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">ofLogError</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ofxAndroidVibrator\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"stop(): couldn't get cancel method\"</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token function\">ofGetJNIEnv</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">CallVoidMethod</span><span class=\"token punctuation\">(</span>vibratorService<span class=\"token punctuation\">,</span>vibrateMethod<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n","type":"source","static":true}}],"fetch":[]}