{"data":[{"page":{"entry":{"name":"ofSoundBuffer.h","filename":"ofSoundBuffer.h","absolute":"/Users/gilbertsinnott/Code/openFrameworks/libs/openFrameworks/sound/ofSoundBuffer.h","path":"/openframeworks/sound/ofSoundBuffer_h","route":"/openframeworks/sound/ofSoundBuffer.h","dir":"../libs/openFrameworks/sound","ext":"h","type":"source","id":310,"parent":300,"breadcrumbs":[300,195],"siblings":[],"translations":{}},"document":"<span class=\"token comment\" spellcheck=\"true\">/*\n * ofSoundBuffer.h\n *\n *  Created on: 25/07/2012\n *      Author: arturo\n */</span>\n\n<span class=\"token macro property\">#<span class=\"token directive keyword\">ifndef</span> OFSOUNDBUFFER_H_</span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> OFSOUNDBUFFER_H_</span>\n\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">\"ofConstants.h\"</span></span>\n\n\n<span class=\"token comment\" spellcheck=\"true\">/*! \n \n @brief Buffer for audio samples and associated metadata.\n \n ofSoundBuffer stores audio as an array of interleaved floating point samples, with a given sample rate for playback.\n\n #### How sound recording works\n \n Physically speaking, what we call _sound_ is simply changes in air pressure perceived by a listener. These changes in sound pressure are converted \n by a microphone into changes in voltage that can be recorded, making a _sound recording_. A sound recording is therefore a recording of changes in air \n pressure at a particular point in space (ie where the microphone was positioned). When it is played back through a speaker, the speaker reproduces the \n same pattern of changes in air pressure as were recorded by the microphone, but this time at a different point in space (ie where the speaker is positioned).\n\n In digital audio these changes in air pressure are recorded as a set of discrete numbers (_samples_), each number representing a snapshot of the air pressure\n at a particular point in time. For high quality audio there are typically 44,100 snapshots recorded every second. This is called the _sample rate_ and is \n expressed in _Hz_ (44100Hz) or _kHz_ (44.1kHz).\n \n Because humans have two ears, rather than one, sound is usually recorded in stereo. The simplest stereo sound recording is two _channels_ of sound \n recorded by two microphones at two different points in space. More channels can also be recorded (eg with 5.1 surround sound systems or Ambisonics).\n \n \n #### Frames, channels and samples\n \n Data in an ofSoundBuffer is stored _interleaved_ as an array of floats. Interleaved audio is analogous to how different color channels are stored side by side \n in an ofImage or ofPixels object. \n \n The functions and function arguments in ofSoundBuffer that deal with this interleaved data are based on 3 key terms:\n\n _channels_ refers to the number of channels or individual streams of interleaved audio samples in the buffer. A mono recording has 1 channel, a stereo \n recording has 2 channels.\n \n _samples_ refers to the actual raw data. One _sample_ is a single floating point number between -1 and 1, which represents a snapshot of sound pressure at \n a single moment in time. A 0.1 second long buffer at 44100Hz contains 4410 _samples_ if it has 1 channel, 8820 _samples_ if it has 2 channels, 13230 \n _samples_ if it has 3 channels, and so on.\n \n _frames_ refers to the number of multi-channel sets of interleaved sample data there are in the buffer. A 0.1 second long buffer at 44100Hz always has \n 4410 _frames_, regardless of how many channels it has. To get the number of _samples_ in a buffer you multiply the number of _channels_ by the number of _frames_.\n  \n\n If I have an ofSoundBuffer with 8 _frames_ of mono (1 _channel_) audio, the underlying array contains 8 _samples_ (ie it is 8 floats long),\n and the samples are arranged like this:\n \n\t\t L L L L L L L L \n \n where `L` represents a single sample.\n \n \n If I have an ofSoundBuffer with 8 _frames_ of stereo (2 _channel_) audio, then the underlying array contains 16 _samples_ ((getNumFrames()*getNumChannels(), \n ie 8*2) arranged in an _interleaved_ pattern:\n \n         L R L R L R L R L R L R L R L R\n\n where `L` represents a single sample for the left channel, and `R` represents a single sample for the right channel. Grouping the frames together for clarity:\n \n\t\t LR LR LR LR LR LR LR LR\n \n \n If I have an ofSoundBuffer with 8 frames of 5.1 surround (6 _channel_) audio, then the underlying array of floats contains 48 _samples_ (getNumFrames()*getNumChannels(), \n ie 8*6) and is usually arranged in an _interleaved_ pattern like this:\n \n         L C R Ls Rs Lfe L C R Ls Rs Lfe L C R Ls Rs Lfe L C R Ls Rs Lfe L C R Ls Rs Lfe L C R Ls Rs Lfe L C R Ls Rs Lfe L C R Ls Rs Lfe \n \n where `L` represents a single sample for the left channel, `C` for centre, `R` for right, `Ls` for left surround, `Rs` for right surround and `Lfe` for the subwoofer. \n Grouping the frames together for clarity:\n\n\t\t LCRLsRsLfe LCRLsRsLfe LCRLsRsLfe LCRLsRsLfe LCRLsRsLfe LCRLsRsLfe LCRLsRsLfe LCRLsRsLfe \n\n */</span>\n\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ofSoundBuffer</span> <span class=\"token punctuation\">{</span>\n<span class=\"token keyword\">public</span><span class=\"token operator\">:</span>\n\t<span class=\"token function\">ofSoundBuffer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token function\">ofSoundBuffer</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">short</span> <span class=\"token operator\">*</span> shortBuffer<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t numFrames<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t numChannels<span class=\"token punctuation\">,</span> <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> sampleRate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">enum</span> InterpolationAlgorithm<span class=\"token punctuation\">{</span>\n\t\tLinear<span class=\"token punctuation\">,</span>\n\t\tHermite\n\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">static</span> InterpolationAlgorithm defaultAlgorithm<span class=\"token punctuation\">;</span>  <span class=\"token comment\" spellcheck=\"true\">//defaults to Linear for mobile, Hermite for desktop</span>\n\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">allocate</span><span class=\"token punctuation\">(</span>size_t numSamples<span class=\"token punctuation\">,</span> size_t numChannels<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token comment\" spellcheck=\"true\">/// sample rate of the audio in this buffer</span>\n\t<span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> <span class=\"token function\">getSampleRate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> samplerate<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">setSampleRate</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> rate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\" spellcheck=\"true\">/// resample by changing the playback speed, keeping the same sampleRate</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">resample</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span> speed<span class=\"token punctuation\">,</span> InterpolationAlgorithm algorithm<span class=\"token operator\">=</span>defaultAlgorithm<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\" spellcheck=\"true\">/// the number of channels per frame</span>\n\tstd<span class=\"token operator\">::</span>size_t <span class=\"token function\">getNumChannels</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> channels<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n\t<span class=\"token comment\" spellcheck=\"true\">/// set the number of channels. does not change the underlying data, ie causes getNumFrames() to return a different result.</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">setNumChannels</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> channels<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\" spellcheck=\"true\">/// the number of frames, ie the number of sets of (getNumChannels()) samples</span>\n\tstd<span class=\"token operator\">::</span>size_t <span class=\"token function\">getNumFrames</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> <span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token function\">getNumChannels</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n\t\n\t<span class=\"token comment\" spellcheck=\"true\">/// return the tickCount that was assigned by ofSoundStream (if this buffer originated from an ofSoundStream).</span>\n\tuint64_t <span class=\"token function\">getTickCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> tickCount<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">setTickCount</span><span class=\"token punctuation\">(</span>uint64_t tick<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span> tickCount <span class=\"token operator\">=</span> tick<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n\t\n\t<span class=\"token comment\" spellcheck=\"true\">/// return the duration of audio in this buffer in milliseconds (==(getNumFrames()/getSampleRate())*1000)</span>\n\tuint64_t <span class=\"token function\">getDurationMS</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span><span class=\"token punctuation\">;</span>\n\tuint64_t <span class=\"token function\">getDurationMicros</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span><span class=\"token punctuation\">;</span>\n\tuint64_t <span class=\"token function\">getDurationNanos</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span><span class=\"token punctuation\">;</span>\n\t\n\t<span class=\"token comment\" spellcheck=\"true\">/// return the ID of the device which generated this buffer</span>\n\t<span class=\"token keyword\">int</span> <span class=\"token function\">getDeviceID</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> soundStreamDeviceID<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">setDeviceID</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span> soundStreamDeviceID <span class=\"token operator\">=</span> id<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n\n\t<span class=\"token comment\" spellcheck=\"true\">/// access the sample at the given position in the buffer.</span>\n\t<span class=\"token comment\" spellcheck=\"true\">/// to retrieve the sample for channel channelIndex of frame frameIndex, do the following:</span>\n\t<span class=\"token comment\" spellcheck=\"true\">/// ofSoundBuffer myBuffer;</span>\n\t<span class=\"token comment\" spellcheck=\"true\">/// ...</span>\n\t<span class=\"token comment\" spellcheck=\"true\">/// float sample = myBuffer[(frameIndex*myBuffer.getNumChannels()) + channelIndex];</span>\n\t<span class=\"token keyword\">float</span> <span class=\"token operator\">&amp;</span> <span class=\"token keyword\">operator</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>std<span class=\"token operator\">::</span>size_t samplePos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">const</span> <span class=\"token keyword\">float</span> <span class=\"token operator\">&amp;</span> <span class=\"token keyword\">operator</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>std<span class=\"token operator\">::</span>size_t samplePos<span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span><span class=\"token punctuation\">;</span>\n\t\n\t<span class=\"token comment\" spellcheck=\"true\">/// access the sample at frameIndex on a soecific channel</span>\n\t<span class=\"token keyword\">float</span> <span class=\"token operator\">&amp;</span> <span class=\"token function\">getSample</span><span class=\"token punctuation\">(</span>std<span class=\"token operator\">::</span>size_t frameIndex<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t channel<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">const</span> <span class=\"token keyword\">float</span> <span class=\"token operator\">&amp;</span> <span class=\"token function\">getSample</span><span class=\"token punctuation\">(</span>std<span class=\"token operator\">::</span>size_t frameIndex<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t channel<span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token comment\" spellcheck=\"true\">/// return a new buffer containing the contents of this buffer multiplied by value.</span>\n\tofSoundBuffer <span class=\"token keyword\">operator</span><span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\" spellcheck=\"true\">/// multiply everything in this buffer by value, in-place.</span>\n\tofSoundBuffer <span class=\"token operator\">&amp;</span> <span class=\"token keyword\">operator</span><span class=\"token operator\">*</span><span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token comment\" spellcheck=\"true\">/// assuming a 2-channel buffer, apply a stereo pan by multiplying channel 0 by left and channel 1 by right.</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">stereoPan</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span> left<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float</span> right<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token comment\" spellcheck=\"true\">/// copy length samples from shortBuffer and interpret as interleaved with the given number of channels at the given samplerate</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">copyFrom</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">short</span> <span class=\"token operator\">*</span> shortBuffer<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t numFrames<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t numChannels<span class=\"token punctuation\">,</span> <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> sampleRate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">copyFrom</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">float</span> <span class=\"token operator\">*</span> floatBuffer<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t numFrames<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t numChannels<span class=\"token punctuation\">,</span> <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> sampleRate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">copyFrom</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> std<span class=\"token operator\">::</span>vector<span class=\"token operator\">&lt;</span><span class=\"token keyword\">short</span><span class=\"token operator\">></span> <span class=\"token operator\">&amp;</span> shortBuffer<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t numChannels<span class=\"token punctuation\">,</span> <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> sampleRate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">copyFrom</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> std<span class=\"token operator\">::</span>vector<span class=\"token operator\">&lt;</span><span class=\"token keyword\">float</span><span class=\"token operator\">></span> <span class=\"token operator\">&amp;</span> floatBuffer<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t numChannels<span class=\"token punctuation\">,</span> <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> sampleRate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">toShortPCM</span><span class=\"token punctuation\">(</span>std<span class=\"token operator\">::</span>vector<span class=\"token operator\">&lt;</span><span class=\"token keyword\">short</span><span class=\"token operator\">></span> <span class=\"token operator\">&amp;</span> dst<span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">toShortPCM</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">short</span> <span class=\"token operator\">*</span> dst<span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token comment\" spellcheck=\"true\">/// resize outBuffer to outNumFrames with outNumChannels, and then copy outNumFrames of data from us to outBuffer.</span>\n\t<span class=\"token comment\" spellcheck=\"true\">/// fromFrame is a frame offset. if we don't have enough source data, loop with fromFrame=0 until we have filled outBuffer.</span>\n\t<span class=\"token comment\" spellcheck=\"true\">/// if outBuffer has fewer channels than our buffer, just copy the first outNumChannels of our data and skip the rest.</span>\n\t<span class=\"token comment\" spellcheck=\"true\">/// if outBuffer has more channels than our buffer, loop through our channels repeatedly until done. </span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">copyTo</span><span class=\"token punctuation\">(</span>ofSoundBuffer <span class=\"token operator\">&amp;</span> outBuffer<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t outNumFrames<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t outNumChannels<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t fromFrame<span class=\"token punctuation\">,</span> <span class=\"token keyword\">bool</span> loop <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\" spellcheck=\"true\">/// as copyTo but mixes source audio with audio in `outBuffer` by adding samples together (+), instead of overwriting.</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">addTo</span><span class=\"token punctuation\">(</span>ofSoundBuffer <span class=\"token operator\">&amp;</span> outBuffer<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t outNumFrames<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t outNumChannels<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t fromFrame<span class=\"token punctuation\">,</span> <span class=\"token keyword\">bool</span> loop <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token comment\" spellcheck=\"true\">/// as copyTo above but reads outNumFrames and outNumChannels from outBuffer</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">copyTo</span><span class=\"token punctuation\">(</span>ofSoundBuffer <span class=\"token operator\">&amp;</span> outBuffer<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t frameFrame <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">bool</span> loop <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\" spellcheck=\"true\">/// as addTo above but reads outNumFrames and outNumChannels from outBuffer</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">addTo</span><span class=\"token punctuation\">(</span>ofSoundBuffer <span class=\"token operator\">&amp;</span> outBuffer<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t fromFrame <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">bool</span> loop <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">append</span><span class=\"token punctuation\">(</span>ofSoundBuffer <span class=\"token operator\">&amp;</span> other<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token comment\" spellcheck=\"true\">/// copy sample data to out, where out is already allocated to match outNumFrames and outNumChannels (ie outNumFrames*outNumChannels samples).</span>\n\t<span class=\"token comment\" spellcheck=\"true\">/// fromFrame is a frame offset. if we don't have enough source data, loop with fromFrame=0 until we have filled the out buffer.</span>\n\t<span class=\"token comment\" spellcheck=\"true\">/// if out has fewer channels than our buffer, just copy the first outNumChannels of our data and skip the rest.</span>\n\t<span class=\"token comment\" spellcheck=\"true\">/// if out has more channels than our buffer, loop through our channels repeatedly until done.</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">copyTo</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span> <span class=\"token operator\">*</span> outBuffer<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t outNumFrames<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t outNumChannels<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t fromFrame<span class=\"token punctuation\">,</span> <span class=\"token keyword\">bool</span> loop <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\" spellcheck=\"true\">/// as copyTo but mixes source audio with audio in `out` by adding samples together (+), instead of overwriting</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">addTo</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span> <span class=\"token operator\">*</span> outBuffer<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t outNumFrames<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t outNumChannels<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t fromFrame<span class=\"token punctuation\">,</span> <span class=\"token keyword\">bool</span> loop <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span><span class=\"token punctuation\">;</span>\n\n\t<span class=\"token comment\" spellcheck=\"true\">/// resample our data to outBuffer at the given target speed, starting at fromFrame and copying numFrames of data. resize outBuffer to fit.</span>\n\t<span class=\"token comment\" spellcheck=\"true\">/// speed is relative to current speed (ie 1.0f == no change). lower speeds will give a larger outBuffer, higher speeds a smaller outBuffer.</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">resampleTo</span><span class=\"token punctuation\">(</span>ofSoundBuffer <span class=\"token operator\">&amp;</span> outBuffer<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t fromFrame<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t numFrames<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float</span> speed<span class=\"token punctuation\">,</span> <span class=\"token keyword\">bool</span> loop <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> InterpolationAlgorithm algorithm <span class=\"token operator\">=</span> defaultAlgorithm<span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span><span class=\"token punctuation\">;</span>\n\t\n\t<span class=\"token comment\" spellcheck=\"true\">/// copy the requested channel of our data to outBuffer. resize outBuffer to fit.</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">getChannel</span><span class=\"token punctuation\">(</span>ofSoundBuffer <span class=\"token operator\">&amp;</span> outBuffer<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t sourceChannel<span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\" spellcheck=\"true\">/// copy data from inBuffer to the given channel. resize ourselves to match inBuffer's getNumFrames().</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">setChannel</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> ofSoundBuffer <span class=\"token operator\">&amp;</span> inBuffer<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t channel<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\n\t<span class=\"token keyword\">float</span> <span class=\"token function\">getRMSAmplitude</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">float</span> <span class=\"token function\">getRMSAmplitudeChannel</span><span class=\"token punctuation\">(</span>std<span class=\"token operator\">::</span>size_t channel<span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span><span class=\"token punctuation\">;</span>\n\t\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">linearResampleTo</span><span class=\"token punctuation\">(</span>ofSoundBuffer <span class=\"token operator\">&amp;</span> buffer<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t fromFrame<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t numFrames<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float</span> speed<span class=\"token punctuation\">,</span> <span class=\"token keyword\">bool</span> loop<span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">hermiteResampleTo</span><span class=\"token punctuation\">(</span>ofSoundBuffer <span class=\"token operator\">&amp;</span> buffer<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t fromFrame<span class=\"token punctuation\">,</span> std<span class=\"token operator\">::</span>size_t numFrames<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float</span> speed<span class=\"token punctuation\">,</span> <span class=\"token keyword\">bool</span> loop<span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span><span class=\"token punctuation\">;</span>\n\t\n\t<span class=\"token comment\" spellcheck=\"true\">/// fills the buffer with random noise between -amplitude and amplitude. useful for debugging.</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">fillWithNoise</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span> amplitude <span class=\"token operator\">=</span> <span class=\"token number\">1.0f</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\n\t<span class=\"token comment\" spellcheck=\"true\">/// fills the buffer with a sine wave. useful for debugging.</span>\n\t<span class=\"token keyword\">float</span> <span class=\"token function\">fillWithTone</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span> pitchHz <span class=\"token operator\">=</span> <span class=\"token number\">440.0f</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">float</span> phase <span class=\"token operator\">=</span> <span class=\"token number\">0.0f</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\n\t<span class=\"token comment\" spellcheck=\"true\">/// amplifies samples so that the maximum amplitude is equal to 'level'</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">normalize</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span> level <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\n\t<span class=\"token comment\" spellcheck=\"true\">/// removes initial / ending silence from the buffer</span>\n\t<span class=\"token keyword\">bool</span> <span class=\"token function\">trimSilence</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span> threshold <span class=\"token operator\">=</span> <span class=\"token number\">0.0001f</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">bool</span> trimStart <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">bool</span> trimEnd <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\n\t<span class=\"token comment\" spellcheck=\"true\">/// return the total number of samples in this buffer (==getNumFrames()*getNumChannels())</span>\n\tstd<span class=\"token operator\">::</span>size_t <span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> buffer<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n\t<span class=\"token comment\" spellcheck=\"true\">/// resize this buffer to exactly this many samples. it's up to you make sure samples matches the channel count.</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">resize</span><span class=\"token punctuation\">(</span>std<span class=\"token operator\">::</span>size_t numSamples<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float</span> val <span class=\"token operator\">=</span> <span class=\"token keyword\">float</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\" spellcheck=\"true\">/// remove all samples, preserving channel count and sample rate.</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">clear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\" spellcheck=\"true\">/// swap the contents of this buffer with otherBuffer</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">swap</span><span class=\"token punctuation\">(</span>ofSoundBuffer <span class=\"token operator\">&amp;</span> otherBuffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token comment\" spellcheck=\"true\">/// set everything in this buffer to value, preserving size, channel count and sample rate.</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\n\t<span class=\"token comment\" spellcheck=\"true\">/// return the underlying buffer. careful!</span>\n\tstd<span class=\"token operator\">::</span>vector<span class=\"token operator\">&lt;</span><span class=\"token keyword\">float</span><span class=\"token operator\">></span> <span class=\"token operator\">&amp;</span> <span class=\"token function\">getBuffer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">const</span> std<span class=\"token operator\">::</span>vector<span class=\"token operator\">&lt;</span><span class=\"token keyword\">float</span><span class=\"token operator\">></span> <span class=\"token operator\">&amp;</span> <span class=\"token function\">getBuffer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">const</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">protected</span><span class=\"token operator\">:</span>\n\n\t<span class=\"token comment\" spellcheck=\"true\">// checks that size() and number of channels are consistent, logs a warning if not. returns consistency check result.</span>\n\t<span class=\"token keyword\">bool</span> <span class=\"token function\">checkSizeAndChannelsConsistency</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> std<span class=\"token operator\">::</span>string<span class=\"token operator\">&amp;</span> function<span class=\"token operator\">=</span><span class=\"token string\">\"\"</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\tstd<span class=\"token operator\">::</span>vector<span class=\"token operator\">&lt;</span><span class=\"token keyword\">float</span><span class=\"token operator\">></span> buffer<span class=\"token punctuation\">;</span>\n\tstd<span class=\"token operator\">::</span>size_t channels<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> samplerate<span class=\"token punctuation\">;</span>\n\n\tuint64_t tickCount<span class=\"token punctuation\">;</span>\n\t<span class=\"token keyword\">int</span> soundStreamDeviceID<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">namespace</span> std<span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">void</span> <span class=\"token function\">swap</span><span class=\"token punctuation\">(</span>ofSoundBuffer <span class=\"token operator\">&amp;</span> src<span class=\"token punctuation\">,</span> ofSoundBuffer <span class=\"token operator\">&amp;</span> dst<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token macro property\">#<span class=\"token directive keyword\">endif</span> </span><span class=\"token comment\" spellcheck=\"true\">/* OFSOUNDBUFFER_H_ */</span>\n","type":"source","static":true}}],"fetch":[]}