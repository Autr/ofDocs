<!doctype html>
<html data-n-head-ssr>
  <head>
    <meta data-n-head="ssr" property="og:description" content="" vmid="og:description"><meta data-n-head="ssr" property="og:title" content="" vmid="og:title"><meta data-n-head="ssr" property="og:image" content="" vmid="og:image"><meta data-n-head="ssr" property="og:description" content="" vmid="og:description"><meta data-n-head="ssr" property="og:title" content="" vmid="og:title"><meta data-n-head="ssr" property="og:image" content="" vmid="og:image"><meta data-n-head="ssr" property="og:description" content="" vmid="og:description"><meta data-n-head="ssr" property="og:title" content="" vmid="og:title"><meta data-n-head="ssr" property="og:image" content="" vmid="og:image"><meta data-n-head="ssr" property="og:description" content="" vmid="og:description"><meta data-n-head="ssr" property="og:title" content="" vmid="og:title"><meta data-n-head="ssr" property="og:image" content="" vmid="og:image"><meta data-n-head="ssr" property="og:description" content="" vmid="og:description"><meta data-n-head="ssr" property="og:title" content="" vmid="og:title"><meta data-n-head="ssr" property="og:image" content="" vmid="og:image"><meta data-n-head="ssr" property="og:description" content="" vmid="og:description"><meta data-n-head="ssr" property="og:title" content="" vmid="og:title"><meta data-n-head="ssr" property="og:image" content="" vmid="og:image"><meta data-n-head="ssr" property="og:description" content="" vmid="og:description"><meta data-n-head="ssr" property="og:title" content="" vmid="og:title"><meta data-n-head="ssr" property="og:image" content="" vmid="og:image"><meta data-n-head="ssr" property="og:description" content="" vmid="og:description"><meta data-n-head="ssr" property="og:title" content="" vmid="og:title"><meta data-n-head="ssr" property="og:image" content="" vmid="og:image"><meta data-n-head="ssr" property="og:description" content="" vmid="og:description"><meta data-n-head="ssr" property="og:title" content="" vmid="og:title"><meta data-n-head="ssr" property="og:image" content="" vmid="og:image"><meta data-n-head="ssr" property="og:description" content="" vmid="og:description"><meta data-n-head="ssr" property="og:title" content="" vmid="og:title"><meta data-n-head="ssr" property="og:image" content="" vmid="og:image"><meta data-n-head="ssr" property="og:description" content="" vmid="og:description"><meta data-n-head="ssr" property="og:title" content="" vmid="og:title"><meta data-n-head="ssr" property="og:image" content="" vmid="og:image"><meta data-n-head="ssr" property="og:description" content="" vmid="og:description"><meta data-n-head="ssr" property="og:title" content="" vmid="og:title"><meta data-n-head="ssr" property="og:image" content="" vmid="og:image"><meta data-n-head="ssr" property="og:description" content="" vmid="og:description"><meta data-n-head="ssr" property="og:title" content="" vmid="og:title"><meta data-n-head="ssr" property="og:image" content="" vmid="og:image"><meta data-n-head="ssr" property="og:description" content="" vmid="og:description"><meta data-n-head="ssr" property="og:title" content="" vmid="og:title"><meta data-n-head="ssr" property="og:image" content="" vmid="og:image"><meta data-n-head="ssr" property="og:description" content="" vmid="og:description"><meta data-n-head="ssr" property="og:title" content="" vmid="og:title"><meta data-n-head="ssr" property="og:image" content="" vmid="og:image"><meta data-n-head="ssr" property="og:description" content="" vmid="og:description"><meta data-n-head="ssr" property="og:title" content="" vmid="og:title"><meta data-n-head="ssr" property="og:image" content="" vmid="og:image"><meta data-n-head="ssr" property="og:description" content="" vmid="og:description"><meta data-n-head="ssr" property="og:title" content="" vmid="og:title"><meta data-n-head="ssr" property="og:image" content="" vmid="og:image"><meta data-n-head="ssr" property="og:description" content="" vmid="og:description"><meta data-n-head="ssr" property="og:title" content="" vmid="og:title"><meta data-n-head="ssr" property="og:image" content="" vmid="og:image"><meta data-n-head="ssr" property="og:description" content="" vmid="og:description"><meta data-n-head="ssr" property="og:title" content="" vmid="og:title"><meta data-n-head="ssr" property="og:image" content="" vmid="og:image"><meta data-n-head="ssr" property="og:description" content="" vmid="og:description"><meta data-n-head="ssr" property="og:title" content="" vmid="og:title"><meta data-n-head="ssr" property="og:image" content="" vmid="og:image"><meta data-n-head="ssr" property="og:description" content="" vmid="og:description"><meta data-n-head="ssr" property="og:title" content="" vmid="og:title"><meta data-n-head="ssr" property="og:image" content="" vmid="og:image"><meta data-n-head="ssr" property="og:description" content="" vmid="og:description"><meta data-n-head="ssr" property="og:title" content="" vmid="og:title"><meta data-n-head="ssr" property="og:image" content="" vmid="og:image"><meta data-n-head="ssr" property="og:description" content="" vmid="og:description"><meta data-n-head="ssr" property="og:title" content="" vmid="og:title"><meta data-n-head="ssr" property="og:image" content="" vmid="og:image"><meta data-n-head="ssr" property="og:description" content="" vmid="og:description"><meta data-n-head="ssr" property="og:title" content="" vmid="og:title"><meta data-n-head="ssr" property="og:image" content="" vmid="og:image"><meta data-n-head="ssr" data-hid="description" name="description" content=""><meta data-n-head="ssr" data-hid="keyword" name="keyword" content=""><meta data-n-head="ssr" property="og:description" content="" vmid="og:description"><meta data-n-head="ssr" property="og:title" content="" vmid="og:title"><meta data-n-head="ssr" property="og:image" content="" vmid="og:image"><link rel="preload" href="/_nuxt/cede893bee7aedd34019.js" as="script"><link rel="preload" href="/_nuxt/561e36663ec83bdcd2ac.js" as="script"><link rel="preload" href="/_nuxt/fe12c0cb7395fa1032f4.css" as="style"><link rel="preload" href="/_nuxt/26c5a70906ce7aaac460.js" as="script"><link rel="preload" href="/_nuxt/75259d9b56378e7dbe47.css" as="style"><link rel="preload" href="/_nuxt/2c5d9034468f7212e81b.js" as="script"><link rel="preload" href="/_nuxt/74971516fa343f955f83.css" as="style"><link rel="preload" href="/_nuxt/3517dc6c150c1f5be417.js" as="script"><link rel="stylesheet" href="/_nuxt/fe12c0cb7395fa1032f4.css"><link rel="stylesheet" href="/_nuxt/75259d9b56378e7dbe47.css"><link rel="stylesheet" href="/_nuxt/74971516fa343f955f83.css">
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div id="app" class="unknown"><div id="menu"><h1 class="of"><div class="inner"><span><a href="/" class="nuxt-link-active"><div class="txt"><span class="docs f7 questrial">ofDocs </span><span class="version">0.11.0</span></div></a></span></div></h1><div id="search"><div class="inner"><div class="field text"><div class="field-inner"><svg viewbox="0 0 36 36" x="0px" y="0px" enable-background="new 0 0 36 36" xml:space="preserve"><path d="M35.525,31.228l-8.88-8.882c1.444-2.238,2.298-4.895,2.298-7.752c0-7.909-6.438-14.343-14.346-14.343						c-7.911,0-14.343,6.434-14.343,14.343c0,7.911,6.433,14.344,14.343,14.344c2.856,0,5.513-0.849,7.752-2.294l8.88,8.88						c0.295,0.297,0.782,0.297,1.076,0l3.22-3.221C35.824,32.008,35.824,31.523,35.525,31.228z M4.81,14.593						c0-5.396,4.391-9.788,9.788-9.788c5.398,0,9.787,4.392,9.787,9.788c0,5.398-4.389,9.789-9.787,9.789						C9.2,24.382,4.81,19.991,4.81,14.593z"></path></svg><!----><div class="text-wrapper"><input id="search_field" name="search_field" placeholder="Search (Alt+F)" autocomplete="off" tabindex="0"></div><!----><!----></div></div></div><div id="results" class="mt1"></div></div><div id="lists" class="menu-inner mt1"><div class="inner"><div class="item"><a href="/documentation/" title="/documentation/"><!----><span>documentation</span></a><!----></div><div class="item"><a href="/examples/" title="/examples/"><!----><span>examples</span></a><!----></div><div class="item"><a href="/openframeworks/" title="/openframeworks/"><!----><span>openFrameworks</span></a><!----></div><div class="item"><a href="/addons/" title="/addons/" class="nuxt-link-active"><!----><span>addons</span></a><div class="list"><div class="item"><a href="/addons/ofxAccelerometer/" title="/addons/ofxAccelerometer/"><!----><span>ofxAccelerometer</span></a><!----></div><div class="item"><a href="/addons/ofxAndroid/" title="/addons/ofxAndroid/"><!----><span>ofxAndroid</span></a><!----></div><div class="item"><a href="/addons/ofxAssimpModelLoader/" title="/addons/ofxAssimpModelLoader/"><!----><span>ofxAssimpModelLoader</span></a><!----></div><div class="item"><a href="/addons/ofxEmscripten/" title="/addons/ofxEmscripten/"><!----><span>ofxEmscripten</span></a><!----></div><div class="item"><a href="/addons/ofxGui/" title="/addons/ofxGui/"><!----><span>ofxGui</span></a><!----></div><div class="item"><a href="/addons/ofxiOS/" title="/addons/ofxiOS/"><!----><span>ofxiOS</span></a><!----></div><div class="item"><a href="/addons/ofxKinect/" title="/addons/ofxKinect/"><!----><span>ofxKinect</span></a><!----></div><div class="item"><a href="/addons/ofxNetwork/" title="/addons/ofxNetwork/"><!----><span>ofxNetwork</span></a><!----></div><div class="item"><a href="/addons/ofxOpenCv/" title="/addons/ofxOpenCv/"><!----><span>ofxOpenCv</span></a><!----></div><div class="item"><a href="/addons/ofxOsc/" title="/addons/ofxOsc/"><!----><span>ofxOsc</span></a><!----></div><div class="item"><a href="/addons/ofxPoco/" title="/addons/ofxPoco/" class="nuxt-link-active"><!----><span>ofxPoco</span></a><div class="list"></div></div><div class="item"><a href="/addons/ofxThreadedImageLoader/" title="/addons/ofxThreadedImageLoader/"><!----><span>ofxThreadedImageLoader</span></a><!----></div><div class="item"><a href="/addons/ofxUnitTests/" title="/addons/ofxUnitTests/"><!----><span>ofxUnitTests</span></a><!----></div><div class="item"><a href="/addons/ofxVectorGraphics/" title="/addons/ofxVectorGraphics/"><!----><span>ofxVectorGraphics</span></a><!----></div><div class="item"><a href="/addons/ofxXmlSettings/" title="/addons/ofxXmlSettings/"><!----><span>ofxXmlSettings</span></a><!----></div></div></div><div class="item"><a href="/guides/" title="/guides/"><!----><span>guides</span></a><!----></div></div></div></div><div id="document"><div id="renderer" class="main"><div absolute="/Users/gilbertsinnott/Code/openFrameworks/addons/ofxPoco/src/ofxXmlPoco.cpp" route="/addons/ofxPoco/src/ofxXmlPoco.cpp" dir="../addons/ofxPoco/src" ext="cpp" type="source" id="173" parent="171" siblings="" translations="[object Object]" class="doc-header"><div class="doc-header-inner"><div class="inner"><div class="mt2 mb2"><span class="breadcrumbs"><span class="crumb"><a href="/" class="pink nuxt-link-active">ofDocs</a><span class="chevron right"></span></span><span class="crumb"><a href="/addons/" class="pink nuxt-link-active">addons </a><!----><span class="chevron right"></span></span><span class="crumb"><a href="/addons/ofxPoco/" class="pink nuxt-link-active">ofxPoco </a><!----><span class="chevron right"></span></span><span class="crumb"><a href="/addons/ofxPoco/src/" class="pink nuxt-link-active">src </a><!----><span class="chevron right"></span></span><span class="crumb"><!----><span class="link">ofxXmlPoco.cpp </span><!----></span></span></div></div></div></div><div id="code-page" class="markdown"><div id="side-menu"><div id="code-sources"><h4>Sources</h4><div class="srcsiblings"><div class="other"><span class="src">src </span><a href="/addons/ofxPoco/src/ofxXmlPoco_cpp" class="nuxt-link-exact-active nuxt-link-active">ofxXmlPoco.cpp </a></div><div class="other"><span class="src">src </span><a href="/addons/ofxPoco/src/ofxXmlPoco_h">ofxXmlPoco.h </a></div></div></div><div id="see-also" filename="ofxPoco" absolute="/Users/gilbertsinnott/Code/openFrameworks/addons/ofxPoco" dir="../addons" route="/addons/ofxPoco/" ext="" type="folder" children="171" parent="36" breadcrumbs="36" class="see-also"><h4>See also</h4><div class="also"><a href="/documentation/addons/ofxPoco/"><span class="origin">documentation</span><span class="name">ofxPoco</span></a></div></div></div><div id="code-render" id="offset-page"><div class="inner"><pre><code><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ofConstants.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ofxXmlPoco.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"Poco/AutoPtr.h"</span></span>

<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

ofxXmlPoco<span class="token operator">::</span><span class="token operator">~</span><span class="token function">ofxXmlPoco</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">releaseAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


ofxXmlPoco<span class="token operator">::</span><span class="token function">ofxXmlPoco</span><span class="token punctuation">(</span><span class="token keyword">const</span> string <span class="token operator">&</span> path<span class="token punctuation">)</span><span class="token punctuation">{</span>
	document <span class="token operator">=</span> <span class="token keyword">new</span> Poco<span class="token operator">::</span>XML<span class="token operator">::</span><span class="token function">Document</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// we create this so that they can be merged later</span>
	element <span class="token operator">=</span> document<span class="token operator">-</span><span class="token operator">></span><span class="token function">documentElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">load</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

ofxXmlPoco<span class="token operator">::</span><span class="token function">ofxXmlPoco</span><span class="token punctuation">(</span><span class="token keyword">const</span> ofxXmlPoco <span class="token operator">&</span> rhs<span class="token punctuation">)</span><span class="token punctuation">{</span>
    document <span class="token operator">=</span> <span class="token keyword">new</span> Poco<span class="token operator">::</span>XML<span class="token operator">::</span><span class="token function">Document</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Node <span class="token operator">*</span>n <span class="token operator">=</span> document<span class="token operator">-</span><span class="token operator">></span><span class="token function">importNode</span><span class="token punctuation">(</span>rhs<span class="token punctuation">.</span><span class="token function">getPocoDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">documentElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    document<span class="token operator">-</span><span class="token operator">></span><span class="token function">appendChild</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    element <span class="token operator">=</span> document<span class="token operator">-</span><span class="token operator">></span><span class="token function">documentElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> ofxXmlPoco <span class="token operator">&</span> ofxXmlPoco<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> ofxXmlPoco <span class="token operator">&</span> rhs<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">&</span>rhs <span class="token operator">==</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">releaseAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	document <span class="token operator">=</span> <span class="token punctuation">(</span>Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Document <span class="token operator">*</span><span class="token punctuation">)</span>rhs<span class="token punctuation">.</span>document<span class="token operator">-</span><span class="token operator">></span><span class="token function">cloneNode</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	element <span class="token operator">=</span> document<span class="token operator">-</span><span class="token operator">></span><span class="token function">documentElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


ofxXmlPoco<span class="token operator">::</span><span class="token function">ofxXmlPoco</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	document <span class="token operator">=</span> <span class="token keyword">new</span> Poco<span class="token operator">::</span>XML<span class="token operator">::</span><span class="token function">Document</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// we create this so that they can be merged later</span>
	element <span class="token operator">=</span> document<span class="token operator">-</span><span class="token operator">></span><span class="token function">documentElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">bool</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>filesystem<span class="token operator">::</span>path <span class="token operator">&</span> path<span class="token punctuation">)</span><span class="token punctuation">{</span>
	ofFile <span class="token function">file</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> ofFile<span class="token operator">::</span>ReadOnly<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>file<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">ofLogError</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"couldn't load, \""</span> <span class="token operator">&lt;&lt;</span> file<span class="token punctuation">.</span><span class="token function">getFileName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"\" not found"</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	ofBuffer <span class="token function">xmlBuffer</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token function">loadFromBuffer</span><span class="token punctuation">(</span>xmlBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">bool</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>filesystem<span class="token operator">::</span>path <span class="token operator">&</span> path<span class="token punctuation">)</span><span class="token punctuation">{</span>
    ofBuffer buffer<span class="token punctuation">;</span>
    buffer<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ofFile <span class="token function">file</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> ofFile<span class="token operator">::</span>WriteOnly<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> file<span class="token punctuation">.</span><span class="token function">writeFromBuffer</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">getNumChildren</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>element<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

    <span class="token keyword">int</span> numberOfChildren <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    Poco<span class="token operator">::</span>XML<span class="token operator">::</span>NodeList <span class="token operator">*</span>list <span class="token operator">=</span> element<span class="token operator">-</span><span class="token operator">></span><span class="token function">childNodes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> list<span class="token operator">-</span><span class="token operator">></span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>list<span class="token operator">-</span><span class="token operator">></span><span class="token function">item</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&&</span> list<span class="token operator">-</span><span class="token operator">></span><span class="token function">item</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">nodeType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Node<span class="token operator">::</span>ELEMENT_NODE<span class="token punctuation">)</span><span class="token punctuation">{</span>
            numberOfChildren<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> numberOfChildren<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">getNumChildren</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&</span> path<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>element<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

    <span class="token keyword">int</span> numberOfChildren <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    Poco<span class="token operator">::</span>XML<span class="token operator">::</span>NodeList <span class="token operator">*</span>list <span class="token operator">=</span> element<span class="token operator">-</span><span class="token operator">></span><span class="token function">childNodes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> list<span class="token operator">-</span><span class="token operator">></span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>list<span class="token operator">-</span><span class="token operator">></span><span class="token function">item</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&&</span> list<span class="token operator">-</span><span class="token operator">></span><span class="token function">item</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">nodeType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Node<span class="token operator">::</span>ELEMENT_NODE<span class="token punctuation">)</span><span class="token punctuation">{</span>
            string nodeName <span class="token operator">=</span> list<span class="token operator">-</span><span class="token operator">></span><span class="token function">item</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">localName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span>nodeName<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                numberOfChildren<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> numberOfChildren<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

string ofxXmlPoco<span class="token operator">::</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">{</span>
    ostringstream stream<span class="token punctuation">;</span>

    Poco<span class="token operator">::</span>XML<span class="token operator">::</span>DOMWriter writer<span class="token punctuation">;</span>
    writer<span class="token punctuation">.</span><span class="token function">setOptions</span><span class="token punctuation">(</span>Poco<span class="token operator">::</span>XML<span class="token operator">::</span>XMLWriter<span class="token operator">::</span>PRETTY_PRINT<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">try</span><span class="token punctuation">{</span>
            writer<span class="token punctuation">.</span><span class="token function">writeNode</span><span class="token punctuation">(</span> stream<span class="token punctuation">,</span> <span class="token function">getPocoDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span> exception <span class="token operator">&</span> e <span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">ofLogError</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"toString(): "</span> <span class="token operator">&lt;&lt;</span> e<span class="token punctuation">.</span><span class="token function">what</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">{</span>
        element<span class="token operator">-</span><span class="token operator">></span><span class="token function">normalize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        writer<span class="token punctuation">.</span><span class="token function">writeNode</span><span class="token punctuation">(</span> stream<span class="token punctuation">,</span> element <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    string tmp <span class="token operator">=</span> stream<span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// don't know how else to get rid of the hidden &lt;#text>&lt;/#text> nodes :/</span>
    <span class="token function">ofStringReplace</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> <span class="token string">"&lt;#text>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">ofStringReplace</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> <span class="token string">"&lt;/#text>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> tmp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">addXml</span><span class="token punctuation">(</span>ofxXmlPoco<span class="token operator">&</span> xml<span class="token punctuation">,</span> <span class="token keyword">bool</span> copyAll<span class="token punctuation">)</span><span class="token punctuation">{</span>
    Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Node <span class="token operator">*</span>n <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>copyAll<span class="token punctuation">)</span><span class="token punctuation">{</span>
        n <span class="token operator">=</span> document<span class="token operator">-</span><span class="token operator">></span><span class="token function">importNode</span><span class="token punctuation">(</span>xml<span class="token punctuation">.</span><span class="token function">getPocoDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">documentElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>xml<span class="token punctuation">.</span><span class="token function">getPocoElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> xml<span class="token punctuation">.</span><span class="token function">getPocoElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> xml<span class="token punctuation">.</span><span class="token function">getPocoDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">documentElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            n <span class="token operator">=</span> document<span class="token operator">-</span><span class="token operator">></span><span class="token function">importNode</span><span class="token punctuation">(</span>xml<span class="token punctuation">.</span><span class="token function">getPocoDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">documentElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            n <span class="token operator">=</span> document<span class="token operator">-</span><span class="token operator">></span><span class="token function">importNode</span><span class="token punctuation">(</span> xml<span class="token punctuation">.</span><span class="token function">getPocoElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">// we have an element, i.e. the document has child nodes</span>
    <span class="token comment" spellcheck="true">// or we don't, so append it directly to the document</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">{</span>
        element<span class="token operator">-</span><span class="token operator">></span><span class="token function">appendChild</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        document<span class="token operator">-</span><span class="token operator">></span><span class="token function">appendChild</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">bool</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&</span> path<span class="token punctuation">)</span><span class="token punctuation">{</span>
    vector<span class="token operator">&lt;</span>string<span class="token operator">></span> tokens<span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span> <span class="token operator">!=</span> string<span class="token operator">::</span>npos<span class="token punctuation">)</span><span class="token punctuation">{</span>
        tokens <span class="token operator">=</span> <span class="token function">tokenize</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment" spellcheck="true">// is this a tokenized tag?</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>tokens<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// don't 'push' down into the new nodes</span>
        Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element <span class="token operator">*</span>el <span class="token operator">=</span> element<span class="token punctuation">;</span>

        vector<span class="token operator">&lt;</span>Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span><span class="token operator">></span> toBeReleased<span class="token punctuation">;</span>

		<span class="token keyword">for</span><span class="token punctuation">(</span>std<span class="token operator">::</span>size_t i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> tokens<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element <span class="token operator">*</span>pe <span class="token operator">=</span> <span class="token function">getPocoDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">createElement</span><span class="token punctuation">(</span>tokens<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            el<span class="token operator">-</span><span class="token operator">></span><span class="token function">appendChild</span><span class="token punctuation">(</span>pe<span class="token punctuation">)</span><span class="token punctuation">;</span>
            toBeReleased<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>pe<span class="token punctuation">)</span><span class="token punctuation">;</span>
            el <span class="token operator">=</span> pe<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">{</span>
            element<span class="token operator">-</span><span class="token operator">></span><span class="token function">appendChild</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            element <span class="token operator">=</span> el<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span> pe <span class="token operator">=</span> <span class="token function">getPocoDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">createElement</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">{</span>
            element<span class="token operator">-</span><span class="token operator">></span><span class="token function">appendChild</span><span class="token punctuation">(</span>pe<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            document<span class="token operator">-</span><span class="token operator">></span><span class="token function">appendChild</span><span class="token punctuation">(</span>pe<span class="token punctuation">)</span><span class="token punctuation">;</span>
            element <span class="token operator">=</span> document<span class="token operator">-</span><span class="token operator">></span><span class="token function">documentElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

string ofxXmlPoco<span class="token operator">::</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">{</span>
	<span class="token comment" spellcheck="true">//if we don't have a DOM element, return the default value</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>element<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment" spellcheck="true">// firstChild() may return a NULL pointer</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">==</span> element<span class="token operator">-</span><span class="token operator">></span><span class="token function">firstChild</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment" spellcheck="true">// return default value in this case</span>
		<span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token comment" spellcheck="true">// no NULL pointer -> save to call nodeType()</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>element<span class="token operator">-</span><span class="token operator">></span><span class="token function">firstChild</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">nodeType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Node<span class="token operator">::</span>TEXT_NODE<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> element<span class="token operator">-</span><span class="token operator">></span><span class="token function">innerText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

string ofxXmlPoco<span class="token operator">::</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token keyword">const</span> string <span class="token operator">&</span> path<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> getValue <span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">int</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">getIntValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token function">ofToInt</span><span class="token punctuation">(</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">int</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">getIntValue</span><span class="token punctuation">(</span><span class="token keyword">const</span> string <span class="token operator">&</span> path<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> getValue <span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">float</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">getFloatValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token function">ofToFloat</span><span class="token punctuation">(</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">float</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">getFloatValue</span><span class="token punctuation">(</span><span class="token keyword">const</span> string <span class="token operator">&</span> path<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> getValue <span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">></span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">bool</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">getBoolValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token function">ofToBool</span><span class="token punctuation">(</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">bool</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">getBoolValue</span><span class="token punctuation">(</span><span class="token keyword">const</span> string <span class="token operator">&</span> path<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> getValue <span class="token operator">&lt;</span><span class="token keyword">bool</span><span class="token operator">></span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


int64_t ofxXmlPoco<span class="token operator">::</span><span class="token function">getInt64Value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token function">ofToInt64</span><span class="token punctuation">(</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


int64_t ofxXmlPoco<span class="token operator">::</span><span class="token function">getInt64Value</span><span class="token punctuation">(</span><span class="token keyword">const</span> string <span class="token operator">&</span> path<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> getValue <span class="token operator">&lt;</span>int64_t<span class="token operator">></span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">bool</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">{</span>
        element <span class="token operator">=</span> document<span class="token operator">-</span><span class="token operator">></span><span class="token function">documentElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">ofLogWarning</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"reset(): no element set yet"</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">bool</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">setToChild</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> index<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>element<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span><span class="token punctuation">)</span> document<span class="token operator">-</span><span class="token operator">></span><span class="token function">documentElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">firstChild</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            element <span class="token operator">=</span> <span class="token punctuation">(</span>Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span><span class="token punctuation">)</span> document<span class="token operator">-</span><span class="token operator">></span><span class="token function">documentElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">firstChild</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            <span class="token function">ofLogWarning</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"setToChild(): no element created yet"</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
	<span class="token keyword">unsigned</span> <span class="token keyword">long</span> numberOfChildren <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    Poco<span class="token operator">::</span>XML<span class="token operator">::</span>NodeList <span class="token operator">*</span>list <span class="token operator">=</span> element<span class="token operator">-</span><span class="token operator">></span><span class="token function">childNodes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> list<span class="token operator">-</span><span class="token operator">></span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&&</span> numberOfChildren <span class="token operator">&lt;</span> index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>list<span class="token operator">-</span><span class="token operator">></span><span class="token function">item</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&&</span> list<span class="token operator">-</span><span class="token operator">></span><span class="token function">item</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">nodeType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Node<span class="token operator">::</span>ELEMENT_NODE<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>numberOfChildren <span class="token operator">==</span> index<span class="token punctuation">)</span><span class="token punctuation">{</span>
                element <span class="token operator">=</span> <span class="token punctuation">(</span>Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span><span class="token punctuation">)</span> list<span class="token operator">-</span><span class="token operator">></span><span class="token function">item</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            numberOfChildren<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">bool</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">setToParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>element<span class="token operator">-</span><span class="token operator">></span><span class="token function">parentNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        element <span class="token operator">=</span> <span class="token punctuation">(</span>Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span><span class="token punctuation">)</span> element<span class="token operator">-</span><span class="token operator">></span><span class="token function">parentNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token function">ofLogWarning</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"setToParent(): current element has no parent"</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">bool</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">setToParent</span><span class="token punctuation">(</span><span class="token keyword">int</span> numLevelsUp<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span> i <span class="token operator">&lt;</span> numLevelsUp <span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>element<span class="token operator">-</span><span class="token operator">></span><span class="token function">parentNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                element <span class="token operator">=</span> <span class="token punctuation">(</span>Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span><span class="token punctuation">)</span> element<span class="token operator">-</span><span class="token operator">></span><span class="token function">parentNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
                <span class="token function">ofLogWarning</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"setToParent(): too many parents: "</span> <span class="token operator">&lt;&lt;</span> numLevelsUp<span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            i<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">ofLogWarning</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"setToParent(): no element set yet"</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    
<span class="token punctuation">}</span>

<span class="token keyword">bool</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">setToSibling</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element <span class="token operator">*</span>node<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">{</span>
        node <span class="token operator">=</span> <span class="token punctuation">(</span>Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span><span class="token punctuation">)</span> element<span class="token operator">-</span><span class="token operator">></span><span class="token function">nextSibling</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token function">ofLogWarning</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"setToSibling() &lt;&lt; no element set yet"</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

	<span class="token comment" spellcheck="true">/* If we get NULL for node, then we do not have a sibling.
	   We can only savely check the type on a non-Null node (thus
	   avoiding NULL-pointer dereferences). Empty space is treated
	   as a text node and we do not want that. We are also not
	   interessted in comments. If we find a non-TEXT_NODE or
	   non-COMMENT_NODE, we do not look further for a sibling. */</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">!=</span> node<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>node<span class="token operator">-</span><span class="token operator">></span><span class="token function">nodeType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Node<span class="token operator">::</span>TEXT_NODE<span class="token punctuation">)</span>
			<span class="token operator">||</span> <span class="token punctuation">(</span>node<span class="token operator">-</span><span class="token operator">></span><span class="token function">nodeType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Node<span class="token operator">::</span>COMMENT_NODE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			node <span class="token operator">=</span> <span class="token punctuation">(</span>Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span><span class="token punctuation">)</span> node<span class="token operator">-</span><span class="token operator">></span><span class="token function">nextSibling</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token comment" spellcheck="true">// make sure we actually got a sibling</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">==</span> node<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">// we're cool now</span>
    element <span class="token operator">=</span> node<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">bool</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">setToPrevSibling</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element <span class="token operator">*</span>node<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">{</span>
        node <span class="token operator">=</span> <span class="token punctuation">(</span>Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span><span class="token punctuation">)</span> element<span class="token operator">-</span><span class="token operator">></span><span class="token function">previousSibling</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token function">ofLogWarning</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"setToPrevSibling(): no element set yet"</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">// empty space in the XML doc is treated as text nodes. blerg.</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>node <span class="token operator">&&</span> node<span class="token operator">-</span><span class="token operator">></span><span class="token function">nodeType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Node<span class="token operator">::</span>TEXT_NODE<span class="token punctuation">)</span><span class="token punctuation">{</span>
        node <span class="token operator">=</span> <span class="token punctuation">(</span>Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span><span class="token punctuation">)</span> node<span class="token operator">-</span><span class="token operator">></span><span class="token function">previousSibling</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>node <span class="token operator">||</span> node<span class="token operator">-</span><span class="token operator">></span><span class="token function">nodeType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Node<span class="token operator">::</span>TEXT_NODE<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    element <span class="token operator">=</span> node<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">bool</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&</span> path<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&</span> value<span class="token punctuation">)</span><span class="token punctuation">{</span>
    Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element <span class="token operator">*</span>e<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">{</span>
        e <span class="token operator">=</span> <span class="token punctuation">(</span>Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span><span class="token punctuation">)</span> element<span class="token operator">-</span><span class="token operator">></span><span class="token function">getNodeByPath</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token function">ofLogWarning</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"setValue(): no element set yet"</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">ofLogWarning</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span>  <span class="token string">"setValue(): path \""</span> <span class="token operator">+</span> path <span class="token operator">+</span> <span class="token string">"\" doesn't exist"</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>e<span class="token operator">-</span><span class="token operator">></span><span class="token function">firstChild</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    	Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Text <span class="token operator">*</span>node <span class="token operator">=</span> <span class="token function">getPocoDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">createTextNode</span><span class="token punctuation">(</span><span class="token function">ofToString</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	e<span class="token operator">-</span><span class="token operator">></span><span class="token function">appendChild</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
    	node<span class="token operator">-</span><span class="token operator">></span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token operator">-</span><span class="token operator">></span><span class="token function">firstChild</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">nodeType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Node<span class="token operator">::</span>TEXT_NODE<span class="token punctuation">)</span><span class="token punctuation">{</span>
        Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Text <span class="token operator">*</span>node <span class="token operator">=</span> <span class="token function">getPocoDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">createTextNode</span><span class="token punctuation">(</span><span class="token function">ofToString</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        e<span class="token operator">-</span><span class="token operator">></span><span class="token function">replaceChild</span><span class="token punctuation">(</span> <span class="token punctuation">(</span>Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Node<span class="token operator">*</span><span class="token punctuation">)</span> node<span class="token punctuation">,</span> e<span class="token operator">-</span><span class="token operator">></span><span class="token function">firstChild</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// swap out</span>
        node<span class="token operator">-</span><span class="token operator">></span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
    	<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

string ofxXmlPoco<span class="token operator">::</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&</span> path<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">{</span>
    Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Node <span class="token operator">*</span>e<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"[@"</span><span class="token punctuation">)</span> <span class="token operator">==</span> string<span class="token operator">::</span>npos<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// we need to create a proper path</span>
            string attributePath <span class="token operator">=</span> <span class="token string">"[@"</span> <span class="token operator">+</span> path <span class="token operator">+</span> <span class="token string">"]"</span><span class="token punctuation">;</span>
            e <span class="token operator">=</span> element<span class="token operator">-</span><span class="token operator">></span><span class="token function">getNodeByPath</span><span class="token punctuation">(</span>attributePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            e <span class="token operator">=</span> element<span class="token operator">-</span><span class="token operator">></span><span class="token function">getNodeByPath</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token function">ofLogWarning</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"getAttribute(): no element set yet"</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> e<span class="token operator">-</span><span class="token operator">></span><span class="token function">getNodeValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// this will be the value of the attribute</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">bool</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">removeAttribute</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&</span> path<span class="token punctuation">)</span><span class="token punctuation">{</span>
    string attributeName<span class="token punctuation">,</span> pathToAttribute<span class="token punctuation">;</span>

    Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element <span class="token operator">*</span>e<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">bool</span> hasPath <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// you can pass either /node[@attr] or just attr</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"[@"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> string<span class="token operator">::</span>npos<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">int</span> attrBegin <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"[@"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> start <span class="token operator">=</span> attrBegin <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> end <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"]"</span><span class="token punctuation">,</span> start<span class="token punctuation">)</span><span class="token punctuation">;</span>
            attributeName <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span> start<span class="token punctuation">,</span> end <span class="token operator">-</span> start <span class="token punctuation">)</span><span class="token punctuation">;</span>
            pathToAttribute <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> attrBegin<span class="token punctuation">)</span><span class="token punctuation">;</span>
            hasPath <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            attributeName <span class="token operator">=</span> path<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span>hasPath<span class="token punctuation">)</span><span class="token punctuation">{</span>
            e <span class="token operator">=</span> <span class="token punctuation">(</span>Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span><span class="token punctuation">)</span> element<span class="token operator">-</span><span class="token operator">></span><span class="token function">getNodeByPath</span><span class="token punctuation">(</span>pathToAttribute<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            e <span class="token operator">=</span> element<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token function">ofLogWarning</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"clearAttributes(): no element set yet"</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
        Poco<span class="token operator">::</span>XML<span class="token operator">::</span>NamedNodeMap <span class="token operator">*</span>map <span class="token operator">=</span> e<span class="token operator">-</span><span class="token operator">></span><span class="token function">attributes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> map<span class="token operator">-</span><span class="token operator">></span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>map<span class="token operator">-</span><span class="token operator">></span><span class="token function">item</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">nodeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> attributeName<span class="token punctuation">)</span><span class="token punctuation">{</span>
                e<span class="token operator">-</span><span class="token operator">></span><span class="token function">removeAttribute</span><span class="token punctuation">(</span>map<span class="token operator">-</span><span class="token operator">></span><span class="token function">item</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">nodeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        map<span class="token operator">-</span><span class="token operator">></span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">bool</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">removeAttributes</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&</span> path<span class="token punctuation">)</span><span class="token punctuation">{</span>
    Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element <span class="token operator">*</span>e<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"[@"</span><span class="token punctuation">)</span> <span class="token operator">==</span> string<span class="token operator">::</span>npos<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// we need to create a proper path</span>
            string attributePath <span class="token operator">=</span> <span class="token string">"[@"</span> <span class="token operator">+</span> path <span class="token operator">+</span> <span class="token string">"]"</span><span class="token punctuation">;</span>
            e <span class="token operator">=</span> <span class="token punctuation">(</span>Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span><span class="token punctuation">)</span> element<span class="token operator">-</span><span class="token operator">></span><span class="token function">getNodeByPath</span><span class="token punctuation">(</span>attributePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            e <span class="token operator">=</span> <span class="token punctuation">(</span>Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span><span class="token punctuation">)</span> element<span class="token operator">-</span><span class="token operator">></span><span class="token function">getNodeByPath</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token function">ofLogWarning</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"clearAttributes(): no element set yet"</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
        Poco<span class="token operator">::</span>XML<span class="token operator">::</span>NamedNodeMap <span class="token operator">*</span>map <span class="token operator">=</span> e<span class="token operator">-</span><span class="token operator">></span><span class="token function">attributes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> map<span class="token operator">-</span><span class="token operator">></span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            e<span class="token operator">-</span><span class="token operator">></span><span class="token function">removeAttribute</span><span class="token punctuation">(</span>map<span class="token operator">-</span><span class="token operator">></span><span class="token function">item</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">nodeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        map<span class="token operator">-</span><span class="token operator">></span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">bool</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">removeAttributes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">{</span>
        Poco<span class="token operator">::</span>XML<span class="token operator">::</span>NamedNodeMap <span class="token operator">*</span>map <span class="token operator">=</span> element<span class="token operator">-</span><span class="token operator">></span><span class="token function">attributes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> map<span class="token operator">-</span><span class="token operator">></span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            element<span class="token operator">-</span><span class="token operator">></span><span class="token function">removeAttribute</span><span class="token punctuation">(</span>map<span class="token operator">-</span><span class="token operator">></span><span class="token function">item</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">nodeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        map<span class="token operator">-</span><span class="token operator">></span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">ofLogWarning</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"clearAttributes(): no element set yet"</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">bool</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">removeContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>element <span class="token operator">&&</span> element<span class="token operator">-</span><span class="token operator">></span><span class="token function">hasChildNodes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

		Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Node<span class="token operator">*</span> swap<span class="token punctuation">;</span>
		Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Node<span class="token operator">*</span> n <span class="token operator">=</span> element<span class="token operator">-</span><span class="token operator">></span><span class="token function">firstChild</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">while</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token operator">></span><span class="token function">nextSibling</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			swap <span class="token operator">=</span> n<span class="token operator">-</span><span class="token operator">></span><span class="token function">nextSibling</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			element<span class="token operator">-</span><span class="token operator">></span><span class="token function">removeChild</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
			n <span class="token operator">=</span> swap<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">bool</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">removeContents</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&</span> path<span class="token punctuation">)</span><span class="token punctuation">{</span>    
    Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element <span class="token operator">*</span>e<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">{</span>
        e <span class="token operator">=</span> <span class="token punctuation">(</span>Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span><span class="token punctuation">)</span> element<span class="token operator">-</span><span class="token operator">></span><span class="token function">getNodeByPath</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token function">ofLogWarning</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"clearContents(): no element set yet"</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
        Poco<span class="token operator">::</span>XML<span class="token operator">::</span>NodeList <span class="token operator">*</span>list <span class="token operator">=</span> e<span class="token operator">-</span><span class="token operator">></span><span class="token function">childNodes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> list<span class="token operator">-</span><span class="token operator">></span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            element<span class="token operator">-</span><span class="token operator">></span><span class="token function">removeChild</span><span class="token punctuation">(</span>list<span class="token operator">-</span><span class="token operator">></span><span class="token function">item</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        list<span class="token operator">-</span><span class="token operator">></span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">void</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">releaseAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	document <span class="token operator">=</span> <span class="token keyword">new</span> Poco<span class="token operator">::</span>XML<span class="token operator">::</span><span class="token function">Document</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// we create this so that they can be merged later</span>
	element <span class="token operator">=</span> document<span class="token operator">-</span><span class="token operator">></span><span class="token function">documentElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">void</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">releaseAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">{</span>
		document<span class="token operator">-</span><span class="token operator">></span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		document <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	element <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">bool</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">const</span> string <span class="token operator">&</span> path<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">// works for both attributes and tags</span>
	Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Node <span class="token operator">*</span> node<span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">{</span>
		node <span class="token operator">=</span> element<span class="token operator">-</span><span class="token operator">></span><span class="token function">getNodeByPath</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
		<span class="token function">ofLogWarning</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"remove(): no element set yet"</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">{</span>
		Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Node <span class="token operator">*</span> n <span class="token operator">=</span> node<span class="token operator">-</span><span class="token operator">></span><span class="token function">parentNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">removeChild</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
		n<span class="token operator">-</span><span class="token operator">></span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">void</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Node <span class="token operator">*</span> parent <span class="token operator">=</span> element<span class="token operator">-</span><span class="token operator">></span><span class="token function">parentNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">{</span>
		parent<span class="token operator">-</span><span class="token operator">></span><span class="token function">removeChild</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">;</span>
		element<span class="token operator">-</span><span class="token operator">></span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		element <span class="token operator">=</span> <span class="token punctuation">(</span>Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element <span class="token operator">*</span><span class="token punctuation">)</span>parent<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
		<span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">bool</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token keyword">const</span> string <span class="token operator">&</span> path<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">// works for both attributes and tags</span>
	Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Node <span class="token operator">*</span> node<span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">{</span>
		node <span class="token operator">=</span> element<span class="token operator">-</span><span class="token operator">></span><span class="token function">getNodeByPath</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> string<span class="token operator">></span> ofxXmlPoco<span class="token operator">::</span><span class="token function">getAttributes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">// works for both attributes and tags</span>
    map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> string<span class="token operator">></span> attrMap<span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">{</span>
        Poco<span class="token operator">::</span>AutoPtr<span class="token operator">&lt;</span>Poco<span class="token operator">::</span>XML<span class="token operator">::</span>NamedNodeMap<span class="token operator">></span> attr <span class="token operator">=</span> element<span class="token operator">-</span><span class="token operator">></span><span class="token function">attributes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> attr<span class="token operator">-</span><span class="token operator">></span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            attrMap<span class="token punctuation">[</span>attr<span class="token operator">-</span><span class="token operator">></span><span class="token function">item</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">nodeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> attr<span class="token operator">-</span><span class="token operator">></span><span class="token function">item</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">nodeValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token function">ofLogWarning</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"getAttribute(): no element set"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> attrMap<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">bool</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&</span> path<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&</span> value<span class="token punctuation">)</span><span class="token punctuation">{</span>

    string attributeName<span class="token punctuation">,</span> pathToAttribute<span class="token punctuation">;</span>
    <span class="token keyword">bool</span> hasPath <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">// you can pass either /node[@attr] or just attr</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"[@"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> string<span class="token operator">::</span>npos<span class="token punctuation">)</span><span class="token punctuation">{</span>
        size_t attrBegin <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"[@"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        size_t start <span class="token operator">=</span> attrBegin <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
        size_t end <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"]"</span><span class="token punctuation">,</span> start<span class="token punctuation">)</span><span class="token punctuation">;</span>
        attributeName <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span> start<span class="token punctuation">,</span> end <span class="token operator">-</span> start <span class="token punctuation">)</span><span class="token punctuation">;</span>
        pathToAttribute <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> attrBegin<span class="token punctuation">)</span><span class="token punctuation">;</span>
        hasPath <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        attributeName <span class="token operator">=</span> path<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">// we don't have a path to resolve</span>
    Poco<span class="token operator">::</span>AutoPtr<span class="token operator">&lt;</span>Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Attr<span class="token operator">></span> attr <span class="token operator">=</span> <span class="token function">getPocoDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">createAttribute</span><span class="token punctuation">(</span>attributeName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    attr<span class="token operator">-</span><span class="token operator">></span><span class="token function">setValue</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>hasPath<span class="token punctuation">)</span><span class="token punctuation">{</span>
        Poco<span class="token operator">::</span>AutoPtr<span class="token operator">&lt;</span>Poco<span class="token operator">::</span>XML<span class="token operator">::</span>NamedNodeMap<span class="token operator">></span> map <span class="token operator">=</span> element<span class="token operator">-</span><span class="token operator">></span><span class="token function">attributes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token operator">-</span><span class="token operator">></span><span class="token function">setNamedItem</span><span class="token punctuation">(</span>attr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// and we're done</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">// we have a path to resolve</span>
    Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span> curElement <span class="token operator">=</span> <span class="token function">getPocoElement</span><span class="token punctuation">(</span>pathToAttribute<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>curElement<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">// if it doesn't exist</span>
        vector<span class="token operator">&lt;</span>string<span class="token operator">></span> tokens<span class="token punctuation">;</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span> <span class="token operator">!=</span> string<span class="token operator">::</span>npos<span class="token punctuation">)</span><span class="token punctuation">{</span>
            tokens <span class="token operator">=</span> <span class="token function">tokenize</span><span class="token punctuation">(</span>pathToAttribute<span class="token punctuation">,</span> <span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment" spellcheck="true">// is this a tokenized tag?</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>tokens<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// don't 'push' down into the new nodes</span>
            curElement <span class="token operator">=</span> element<span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">// find the last existing tag</span>
            size_t lastExistingTag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

            <span class="token comment" spellcheck="true">// can't use reverse_iterator b/c accumulate doesn't like it</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token operator">::</span>iterator it <span class="token operator">=</span> tokens<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it <span class="token operator">!=</span> tokens<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                string empty <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
                string concat <span class="token operator">=</span> <span class="token function">accumulate</span><span class="token punctuation">(</span>tokens<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> it<span class="token punctuation">,</span> std<span class="token operator">::</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span> testElement <span class="token operator">=</span> <span class="token function">getPocoElement</span><span class="token punctuation">(</span>concat<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>testElement<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    lastExistingTag<span class="token operator">++</span><span class="token punctuation">;</span>
                    curElement <span class="token operator">=</span> testElement<span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            <span class="token comment" spellcheck="true">// create all the tags that don't exist</span>
			<span class="token keyword">for</span><span class="token punctuation">(</span>size_t i <span class="token operator">=</span> lastExistingTag<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> tokens<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element <span class="token operator">*</span>newElement <span class="token operator">=</span> <span class="token function">getPocoDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">createElement</span><span class="token punctuation">(</span>tokens<span class="token punctuation">.</span><span class="token function">at</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                curElement<span class="token operator">-</span><span class="token operator">></span><span class="token function">appendChild</span><span class="token punctuation">(</span>newElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
                curElement <span class="token operator">=</span> newElement<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            curElement<span class="token operator">-</span><span class="token operator">></span><span class="token function">setAttribute</span><span class="token punctuation">(</span>attributeName<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span> testElement <span class="token operator">=</span> <span class="token function">getPocoElement</span><span class="token punctuation">(</span>pathToAttribute<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>testElement<span class="token punctuation">)</span><span class="token punctuation">{</span>
                curElement <span class="token operator">=</span> testElement<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
                Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element <span class="token operator">*</span>newElement <span class="token operator">=</span> <span class="token function">getPocoDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">createElement</span><span class="token punctuation">(</span>pathToAttribute<span class="token punctuation">)</span><span class="token punctuation">;</span>
                curElement<span class="token operator">-</span><span class="token operator">></span><span class="token function">appendChild</span><span class="token punctuation">(</span>newElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
                curElement <span class="token operator">=</span> newElement<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            curElement<span class="token operator">-</span><span class="token operator">></span><span class="token function">setAttribute</span><span class="token punctuation">(</span>attributeName<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">bool</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">loadFromBuffer</span><span class="token punctuation">(</span><span class="token keyword">const</span> string <span class="token operator">&</span> buffer<span class="token punctuation">)</span><span class="token punctuation">{</span>
	Poco<span class="token operator">::</span>XML<span class="token operator">::</span>DOMParser parser<span class="token punctuation">;</span>

	<span class="token comment" spellcheck="true">// release and null out if we already have a document</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">{</span>
		document<span class="token operator">-</span><span class="token operator">></span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">try</span><span class="token punctuation">{</span>
		document <span class="token operator">=</span> parser<span class="token punctuation">.</span><span class="token function">parseString</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
		element <span class="token operator">=</span> <span class="token punctuation">(</span>Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element <span class="token operator">*</span><span class="token punctuation">)</span>document<span class="token operator">-</span><span class="token operator">></span><span class="token function">firstChild</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		document<span class="token operator">-</span><span class="token operator">></span><span class="token function">normalize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token keyword">const</span> Poco<span class="token operator">::</span>XML<span class="token operator">::</span>SAXException <span class="token operator">&</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">ofLogError</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"parse error: "</span> <span class="token operator">&lt;&lt;</span> e<span class="token punctuation">.</span><span class="token function">message</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		document <span class="token operator">=</span> <span class="token keyword">new</span> Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Document<span class="token punctuation">;</span>
		element <span class="token operator">=</span> document<span class="token operator">-</span><span class="token operator">></span><span class="token function">documentElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token keyword">const</span> exception <span class="token operator">&</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">short</span> msg <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">what</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">ofLogError</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"parse error: "</span> <span class="token operator">&lt;&lt;</span> <span class="token function">DOMErrorMessage</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
		document <span class="token operator">=</span> <span class="token keyword">new</span> Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Document<span class="token punctuation">;</span>
		element <span class="token operator">=</span> document<span class="token operator">-</span><span class="token operator">></span><span class="token function">documentElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>


string ofxXmlPoco<span class="token operator">::</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> element<span class="token operator">-</span><span class="token operator">></span><span class="token function">nodeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">bool</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">setTo</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&</span> path<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>element<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>document<span class="token operator">-</span><span class="token operator">></span><span class="token function">documentElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            element <span class="token operator">=</span> document<span class="token operator">-</span><span class="token operator">></span><span class="token function">documentElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            <span class="token function">ofLogWarning</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"setTo(): empty document"</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>


    <span class="token comment" spellcheck="true">// one case: we're at the root, but we don't know it yet:</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>element <span class="token operator">==</span> document<span class="token operator">-</span><span class="token operator">></span><span class="token function">documentElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&&</span> element<span class="token operator">-</span><span class="token operator">></span><span class="token function">nodeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> path <span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">//ofLogNotice("ofxXmlPoco") &lt;&lt; path &lt;&lt; " " &lt;&lt; path.find("../");</span>

    <span class="token comment" spellcheck="true">// another: let's go up a little</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"../"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> string<span class="token operator">::</span>npos<span class="token punctuation">)</span><span class="token punctuation">{</span>
 
        Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span> prev <span class="token operator">=</span> element<span class="token punctuation">;</span>
        Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span> parent <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
		size_t count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        size_t offset<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>offset <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"../"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             offset <span class="token operator">!=</span> std<span class="token operator">::</span>string<span class="token operator">::</span>npos<span class="token punctuation">;</span>
             offset <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"../"</span><span class="token punctuation">,</span> offset <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

            <span class="token keyword">if</span><span class="token punctuation">(</span>count <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                parent <span class="token operator">=</span> <span class="token punctuation">(</span>Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span><span class="token punctuation">)</span> element<span class="token operator">-</span><span class="token operator">></span><span class="token function">parentNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
                parent <span class="token operator">=</span> <span class="token punctuation">(</span>Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span><span class="token punctuation">)</span> parent<span class="token operator">-</span><span class="token operator">></span><span class="token function">parentNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token operator">++</span>count<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment" spellcheck="true">//ofLogNotice("ofxXmlPoco") &lt;&lt; (count * 3) &lt;&lt; " " &lt;&lt; path.size();</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token punctuation">(</span>count <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">></span> path<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
            element <span class="token operator">=</span> parent<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">{</span>
            string remainingPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token punctuation">(</span>count <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> path<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>count <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            element <span class="token operator">=</span> <span class="token punctuation">(</span>Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span><span class="token punctuation">)</span> parent<span class="token operator">-</span><span class="token operator">></span><span class="token function">getNodeByPath</span><span class="token punctuation">(</span>remainingPath<span class="token punctuation">)</span><span class="token punctuation">;</span>

             <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>element<span class="token punctuation">)</span><span class="token punctuation">{</span>
                 element <span class="token operator">=</span> prev<span class="token punctuation">;</span>
                 <span class="token function">ofLogWarning</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"setCurrentElement(): passed invalid path \""</span> <span class="token operator">&lt;&lt;</span> remainingPath <span class="token operator">&lt;&lt;</span> <span class="token string">"\""</span><span class="token punctuation">;</span>
                 <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
             <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            <span class="token function">ofLogWarning</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"setCurrentElement(): parent is nullptr."</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"//"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> string<span class="token operator">::</span>npos<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// another: we're looking all over</span>
        Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span> prev <span class="token operator">=</span> element<span class="token punctuation">;</span>
        element <span class="token operator">=</span> <span class="token punctuation">(</span>Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span><span class="token punctuation">)</span> document<span class="token operator">-</span><span class="token operator">></span><span class="token function">getNodeByPath</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>element<span class="token punctuation">)</span><span class="token punctuation">{</span>
            element <span class="token operator">=</span> prev<span class="token punctuation">;</span>
            <span class="token function">ofLogWarning</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"setCurrentElement(): passed invalid path \""</span> <span class="token operator">&lt;&lt;</span> path <span class="token operator">&lt;&lt;</span> <span class="token string">"\""</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// another: we're actually looking down into the thing :)</span>
        Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span> prev <span class="token operator">=</span> element<span class="token punctuation">;</span>
        element <span class="token operator">=</span> <span class="token punctuation">(</span>Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span><span class="token punctuation">)</span> element<span class="token operator">-</span><span class="token operator">></span><span class="token function">getNodeByPath</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>element<span class="token punctuation">)</span><span class="token punctuation">{</span>
            element <span class="token operator">=</span> prev<span class="token punctuation">;</span>
            <span class="token function">ofLogWarning</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"setCurrentElement(): passed invalid path \""</span> <span class="token operator">&lt;&lt;</span> path <span class="token operator">&lt;&lt;</span> <span class="token string">"\""</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">const</span> Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element <span class="token operator">*</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">getPocoElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> element<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element <span class="token operator">*</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">getPocoElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> element<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">getPocoElement</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&</span> path<span class="token punctuation">)</span><span class="token punctuation">{</span>
    string copy <span class="token operator">=</span> path<span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// does it have an attribute? just in case</span>
    std<span class="token operator">::</span>size_t ind <span class="token operator">=</span> copy<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"[@"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ind <span class="token operator">!=</span> string<span class="token operator">::</span>npos<span class="token punctuation">)</span><span class="token punctuation">{</span>
        copy <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> ind<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span><span class="token punctuation">)</span> element<span class="token operator">-</span><span class="token operator">></span><span class="token function">getNodeByPath</span><span class="token punctuation">(</span>copy<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token function">ofLogWarning</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"getPocoElement(): no element to get yet "</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">getPocoElement</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&</span> path<span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">{</span>
    string copy <span class="token operator">=</span> path<span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// does it have an attribute? just in case</span>
	std<span class="token operator">::</span>size_t ind <span class="token operator">=</span> copy<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">"[@"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>ind <span class="token operator">!=</span> string<span class="token operator">::</span>npos<span class="token punctuation">)</span><span class="token punctuation">{</span>
        copy <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> ind<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Element<span class="token operator">*</span><span class="token punctuation">)</span> element<span class="token operator">-</span><span class="token operator">></span><span class="token function">getNodeByPath</span><span class="token punctuation">(</span>copy<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token function">ofLogWarning</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"getPocoElement(): no element to get yet "</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Document <span class="token operator">*</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">getPocoDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> document<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">const</span> Poco<span class="token operator">::</span>XML<span class="token operator">::</span>Document <span class="token operator">*</span> ofxXmlPoco<span class="token operator">::</span><span class="token function">getPocoDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> document<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


string ofxXmlPoco<span class="token operator">::</span><span class="token function">DOMErrorMessage</span><span class="token punctuation">(</span><span class="token keyword">short</span> msg<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">switch</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">{</span>
	 <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
		 <span class="token keyword">return</span> <span class="token string">"INDEX_SIZE_ERR"</span><span class="token punctuation">;</span>
		 <span class="token keyword">break</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">/// index or size is negative or greater than allowed value</span>
	 <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
		 <span class="token keyword">return</span> <span class="token string">"DOMSTRING_SIZE_ERR"</span><span class="token punctuation">;</span>             <span class="token comment" spellcheck="true">/// the specified range of text does not fit into a DOMString (not used)</span>
		 <span class="token keyword">break</span><span class="token punctuation">;</span>
	 <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>
		 <span class="token keyword">return</span> <span class="token string">"HIERARCHY_REQUEST_ERR"</span><span class="token punctuation">;</span>          <span class="token comment" spellcheck="true">/// a node is inserted somewhere it doesn't belong</span>
		 <span class="token keyword">break</span><span class="token punctuation">;</span>
	 <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span>
		 <span class="token keyword">return</span> <span class="token string">"WRONG_DOCUMENT_ERR"</span><span class="token punctuation">;</span>             <span class="token comment" spellcheck="true">/// a node is used in a different document than the one that created it</span>
		 <span class="token keyword">break</span><span class="token punctuation">;</span>
	 <span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span>
		 <span class="token keyword">return</span> <span class="token string">"INVALID_CHARACTER_ERR"</span><span class="token punctuation">;</span>          <span class="token comment" spellcheck="true">/// an invalid character is specified (not used)</span>
		 <span class="token keyword">break</span><span class="token punctuation">;</span>
	 <span class="token keyword">case</span> <span class="token number">6</span><span class="token operator">:</span>
		 <span class="token keyword">return</span> <span class="token string">"NO_DATA_ALLOWED_ERR"</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">/// data is specified for a node which does not support data</span>
		 <span class="token keyword">break</span><span class="token punctuation">;</span>
	 <span class="token keyword">case</span> <span class="token number">7</span><span class="token operator">:</span>
		 <span class="token keyword">return</span> <span class="token string">"NO_MODIFICATION_ALLOWED_ERR"</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/// an attempt is made to modify an object where modifications are not allowed</span>
		 <span class="token keyword">break</span><span class="token punctuation">;</span>
	 <span class="token keyword">case</span> <span class="token number">8</span><span class="token operator">:</span>
		 <span class="token keyword">return</span> <span class="token string">"NOT_FOUND_ERR"</span><span class="token punctuation">;</span>                  <span class="token comment" spellcheck="true">/// an attempt was made to reference a node in a context where it does not exist</span>
		 <span class="token keyword">break</span><span class="token punctuation">;</span>
	 <span class="token keyword">case</span> <span class="token number">9</span><span class="token operator">:</span>
		 <span class="token keyword">return</span> <span class="token string">"NOT_SUPPORTED_ERR"</span><span class="token punctuation">;</span>              <span class="token comment" spellcheck="true">/// the implementation does not support the type of object requested</span>
		 <span class="token keyword">break</span><span class="token punctuation">;</span>
	 <span class="token keyword">case</span> <span class="token number">10</span><span class="token operator">:</span>
		 <span class="token keyword">return</span> <span class="token string">"INUSE_ATTRIBUTE_ERR"</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">/// an attempt is made to add an attribute that is already in use elsewhere</span>
		 <span class="token keyword">break</span><span class="token punctuation">;</span>
	 <span class="token keyword">case</span> <span class="token number">11</span><span class="token operator">:</span>
		 <span class="token keyword">return</span> <span class="token string">"INVALID_STATE_ERR"</span><span class="token punctuation">;</span>              <span class="token comment" spellcheck="true">/// a parameter or an operation is not supported by the underlying object</span>
		 <span class="token keyword">break</span><span class="token punctuation">;</span>
	 <span class="token keyword">case</span> <span class="token number">12</span><span class="token operator">:</span>
		 <span class="token keyword">return</span> <span class="token string">"SYNTAX_ERR"</span><span class="token punctuation">;</span>                     <span class="token comment" spellcheck="true">/// an invalid or illegal string is specified</span>
		 <span class="token keyword">break</span><span class="token punctuation">;</span>
	 <span class="token keyword">case</span> <span class="token number">13</span><span class="token operator">:</span>
		 <span class="token keyword">return</span> <span class="token string">"INVALID_MODIFICATION_ERR"</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true">/// an attempt is made to modify the type of the underlying object</span>
		 <span class="token keyword">break</span><span class="token punctuation">;</span>
	 <span class="token keyword">case</span> <span class="token number">14</span><span class="token operator">:</span>
		 <span class="token keyword">return</span> <span class="token string">"NAMESPACE_ERR"</span><span class="token punctuation">;</span>                  <span class="token comment" spellcheck="true">/// an attempt is made to create or change an object in a way which is incorrect with regard to namespaces</span>
		 <span class="token keyword">break</span><span class="token punctuation">;</span>
	 <span class="token keyword">case</span> <span class="token number">15</span><span class="token operator">:</span>
		 <span class="token keyword">return</span> <span class="token string">"INVALID_ACCESS_ERR"</span><span class="token punctuation">;</span>             <span class="token comment" spellcheck="true">/// an attempt is made to use an object that is not or is no longer usable</span>
		 <span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> <span class="token string">"DOM ERROR"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">void</span> <span class="token function">ofSerialize</span><span class="token punctuation">(</span>ofxXmlPoco <span class="token operator">&</span> xml<span class="token punctuation">,</span> <span class="token keyword">const</span> ofAbstractParameter <span class="token operator">&</span> parameter<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>parameter<span class="token punctuation">.</span><span class="token function">isSerializable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	string name <span class="token operator">=</span> parameter<span class="token punctuation">.</span><span class="token function">getEscapedName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>name <span class="token operator">==</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		name <span class="token operator">=</span> <span class="token string">"UnknownName"</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>parameter<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">typeid</span><span class="token punctuation">(</span>ofParameterGroup<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">const</span> ofParameterGroup <span class="token operator">&</span> group <span class="token operator">=</span> <span class="token keyword">static_cast</span> <span class="token operator">&lt;</span><span class="token keyword">const</span> ofParameterGroup <span class="token operator">&</span><span class="token operator">></span><span class="token punctuation">(</span>parameter<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>xml<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			xml<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">ofLogVerbose</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"creating group "</span> <span class="token operator">&lt;&lt;</span> name<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		xml<span class="token punctuation">.</span><span class="token function">setTo</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">ofLogVerbose</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"group "</span> <span class="token operator">&lt;&lt;</span> name<span class="token punctuation">;</span>
		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> <span class="token operator">&</span> p<span class="token operator">:</span> group<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token function">ofSerialize</span><span class="token punctuation">(</span>xml<span class="token punctuation">,</span> <span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token function">ofLogVerbose</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"end group "</span> <span class="token operator">&lt;&lt;</span> name<span class="token punctuation">;</span>
		xml<span class="token punctuation">.</span><span class="token function">setToParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
		string value <span class="token operator">=</span> parameter<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>xml<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			xml<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">ofLogVerbose</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"creating tag "</span> <span class="token operator">&lt;&lt;</span> name<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token function">ofLogVerbose</span><span class="token punctuation">(</span><span class="token string">"ofxXmlPoco"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"setting tag "</span> <span class="token operator">&lt;&lt;</span> name <span class="token operator">&lt;&lt;</span> <span class="token string">": "</span> <span class="token operator">&lt;&lt;</span> value<span class="token punctuation">;</span>
		xml<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">void</span> <span class="token function">ofDeserialize</span><span class="token punctuation">(</span><span class="token keyword">const</span> ofxXmlPoco <span class="token operator">&</span> xml<span class="token punctuation">,</span> ofAbstractParameter <span class="token operator">&</span> parameter<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>parameter<span class="token punctuation">.</span><span class="token function">isSerializable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	string name <span class="token operator">=</span> parameter<span class="token punctuation">.</span><span class="token function">getEscapedName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>parameter<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">typeid</span><span class="token punctuation">(</span>ofParameterGroup<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		ofParameterGroup <span class="token operator">&</span> group <span class="token operator">=</span> <span class="token keyword">static_cast</span> <span class="token operator">&lt;</span>ofParameterGroup <span class="token operator">&</span><span class="token operator">></span><span class="token punctuation">(</span>parameter<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">const_cast</span><span class="token operator">&lt;</span>ofxXmlPoco<span class="token operator">&</span><span class="token operator">></span><span class="token punctuation">(</span>xml<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setTo</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">auto</span> <span class="token operator">&</span> p<span class="token operator">:</span> group<span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token function">ofDeserialize</span><span class="token punctuation">(</span>xml<span class="token punctuation">,</span> <span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token keyword">const_cast</span><span class="token operator">&lt;</span>ofxXmlPoco<span class="token operator">&</span><span class="token operator">></span><span class="token punctuation">(</span>xml<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setToParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>xml<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>parameter<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">typeid</span><span class="token punctuation">(</span>ofParameter <span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				parameter<span class="token punctuation">.</span>cast <span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> xml<span class="token punctuation">.</span><span class="token function">getIntValue</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>parameter<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">typeid</span><span class="token punctuation">(</span>ofParameter <span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">></span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				parameter<span class="token punctuation">.</span>cast <span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> xml<span class="token punctuation">.</span><span class="token function">getFloatValue</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>parameter<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">typeid</span><span class="token punctuation">(</span>ofParameter <span class="token operator">&lt;</span><span class="token keyword">bool</span><span class="token operator">></span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				parameter<span class="token punctuation">.</span>cast <span class="token operator">&lt;</span><span class="token keyword">bool</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> xml<span class="token punctuation">.</span><span class="token function">getBoolValue</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>parameter<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">typeid</span><span class="token punctuation">(</span>ofParameter <span class="token operator">&lt;</span>int64_t<span class="token operator">></span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				parameter<span class="token punctuation">.</span>cast <span class="token operator">&lt;</span>int64_t<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> xml<span class="token punctuation">.</span><span class="token function">getInt64Value</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>parameter<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">typeid</span><span class="token punctuation">(</span>ofParameter <span class="token operator">&lt;</span>string<span class="token operator">></span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				parameter<span class="token punctuation">.</span>cast <span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> xml<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
				parameter<span class="token punctuation">.</span><span class="token function">fromString</span><span class="token punctuation">(</span>xml<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div></div></div></div></div></div></div></div><script defer src="/_nuxt/payloads/1583566544124/addons/ofxPoco/src/ofxXmlPoco_cpp/payload.js"></script><script src="/_nuxt/cede893bee7aedd34019.js" defer></script><script src="/_nuxt/3517dc6c150c1f5be417.js" defer></script><script src="/_nuxt/561e36663ec83bdcd2ac.js" defer></script><script src="/_nuxt/26c5a70906ce7aaac460.js" defer></script><script src="/_nuxt/2c5d9034468f7212e81b.js" defer></script>
  </body>
</html>
