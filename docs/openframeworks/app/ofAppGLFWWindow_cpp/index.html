<!doctype html>
<html data-n-head-ssr>
  <head>
    <title>ofAppGLFWWindow.cpp | openframeworks | ofDocs</title><meta data-n-head="ssr" data-hid="description" name="description" content="openFrameworks documentation and examples browser"><meta data-n-head="ssr" data-hid="keyword" name="keyword" content=""><meta data-n-head="ssr" property="og:description" content="openFrameworks documentation and examples browser" vmid="og:description"><meta data-n-head="ssr" property="og:title" content="ofAppGLFWWindow.cpp | openframeworks | ofDocs" vmid="og:title"><meta data-n-head="ssr" property="og:image" content="/files/images/ofw-logo.png" vmid="og:image"><link rel="preload" href="/_nuxt/5f71eaca0bd2f1a0f939.js" as="script"><link rel="preload" href="/_nuxt/906a3ca0fb13ed3c6651.js" as="script"><link rel="preload" href="/_nuxt/fe12c0cb7395fa1032f4.css" as="style"><link rel="preload" href="/_nuxt/b673915e8a08acf593e8.js" as="script"><link rel="preload" href="/_nuxt/46e8fcacdadb233d9fb6.css" as="style"><link rel="preload" href="/_nuxt/bf355f21967a23c26c07.js" as="script"><link rel="preload" href="/_nuxt/35a90d914f539af1362f.js" as="script"><link rel="stylesheet" href="/_nuxt/fe12c0cb7395fa1032f4.css"><link rel="stylesheet" href="/_nuxt/46e8fcacdadb233d9fb6.css">
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div id="app"><div id="menu"><div class="menu-inner"><div id="settings"></div><h1 class="of"><div class="inner"><span><a href="/" class="nuxt-link-active"><svg version="1.1" viewbox="0 0 110 58" width="110px" height="58px" enable-background="0 0 110 58" xml:space="preserve" class="logo"><g><path d="M58,29 C58,13 45,0 29,0 C13,0 0,13 0,29 C0,45 13,58 29,58 C45,58 58,45 58,29 Z"></path><rect x="59" y="0" width="25" height="58"></rect><rect x="85" y="26" width="15" height="15"></rect><path d="M85,0 L110,0 L85,25 L85,0 Z"></path></g></svg><div class="txt"><span class="docs f7 questrial">Docs </span><span class="version">0.11.0</span></div></a></span></div></h1><div id="search"><div class="inner"><div class="field text"><div class="field-inner"><svg viewbox="0 0 36 36" enable-background="new 0 0 36 36" xml:space="preserve"><path d="M35.525,31.228l-8.88-8.882c1.444-2.238,2.298-4.895,2.298-7.752c0-7.909-6.438-14.343-14.346-14.343							c-7.911,0-14.343,6.434-14.343,14.343c0,7.911,6.433,14.344,14.343,14.344c2.856,0,5.513-0.849,7.752-2.294l8.88,8.88							c0.295,0.297,0.782,0.297,1.076,0l3.22-3.221C35.824,32.008,35.824,31.523,35.525,31.228z M4.81,14.593							c0-5.396,4.391-9.788,9.788-9.788c5.398,0,9.787,4.392,9.787,9.788c0,5.398-4.389,9.789-9.787,9.789							C9.2,24.382,4.81,19.991,4.81,14.593z"></path></svg><!----><div class="text-wrapper"><input id="search_field" name="search_field" placeholder="Search (Alt+F)" autocomplete="off" tabindex="0"></div><!----><!----></div></div></div><!----></div><div id="lists" class="menu-inner mt1 mb2"><div class="inner"></div></div></div><div class="menu-bottom"><div class="inner"><button class="button"><!----><span><span class="ico">nights_stay</span></span></button></div></div></div><div id="document"><div id="renderer" class="main source"><div absolute="/Users/Gilbert/Code/openFrameworks/libs/openFrameworks/app/ofAppGLFWWindow.cpp" route="/openframeworks/app/ofAppGLFWWindow.cpp" dir="../libs/openFrameworks/app" ext="cpp" type="source" id="180" parent="176" siblings="" translations="[object Object]" class="doc-header"><div class="doc-header-inner"><div class="inner"><span class="breadcrumbs"><span class="crumb"><a href="/" class="pink nuxt-link-active">ofDocs</a><span class="chevron right"></span></span><span class="crumb"><a href="/openframeworks/" class="pink nuxt-link-active">openframeworks </a><!----><span class="chevron right"></span></span><span class="crumb"><a href="/openframeworks/app/" class="pink nuxt-link-active">app </a><!----><span class="chevron right"></span></span><span class="crumb"><!----><span class="link selector"><span class="name">ofAppGLFWWindow.cpp</span><span class="chevron bottom"></span><select><option value="/openframeworks/app/ofAppBaseWindow_h">ofAppBaseWindow.h</option><option value="/openframeworks/app/ofAppEGLWindow_cpp">ofAppEGLWindow.cpp</option><option value="/openframeworks/app/ofAppEGLWindow_h">ofAppEGLWindow.h</option><option value="/openframeworks/app/ofAppGLFWWindow_cpp">ofAppGLFWWindow.cpp</option><option value="/openframeworks/app/ofAppGLFWWindow_h">ofAppGLFWWindow.h</option><option value="/openframeworks/app/ofAppGlutWindow_cpp">ofAppGlutWindow.cpp</option><option value="/openframeworks/app/ofAppGlutWindow_h">ofAppGlutWindow.h</option><option value="/openframeworks/app/ofAppNoWindow_cpp">ofAppNoWindow.cpp</option><option value="/openframeworks/app/ofAppNoWindow_h">ofAppNoWindow.h</option><option value="/openframeworks/app/ofAppRunner_cpp">ofAppRunner.cpp</option><option value="/openframeworks/app/ofAppRunner_h">ofAppRunner.h</option><option value="/openframeworks/app/ofBaseApp_cpp">ofBaseApp.cpp</option><option value="/openframeworks/app/ofBaseApp_h">ofBaseApp.h</option><option value="/openframeworks/app/ofIcon_h">ofIcon.h</option><option value="/openframeworks/app/ofMainLoop_cpp">ofMainLoop.cpp</option><option value="/openframeworks/app/ofMainLoop_h">ofMainLoop.h</option><option value="/openframeworks/app/ofWindowSettings_h">ofWindowSettings.h</option></select></span><!----></span></span></div></div></div><div id="code-page" static="true"><div id="side-menu"><div id="code-sources"><h4 class="f3 dropdown-toggle">Sources</h4><div class="srcsiblings dropdown-area"><a href="/openframeworks/app/ofAppBaseWindow_h" class="block"><span class="src">src </span><span class="name">ofAppBaseWindow.h </span></a><a href="/openframeworks/app/ofAppEGLWindow_cpp" class="block"><span class="src">src </span><span class="name">ofAppEGLWindow.cpp </span></a><a href="/openframeworks/app/ofAppEGLWindow_h" class="block"><span class="src">src </span><span class="name">ofAppEGLWindow.h </span></a><a href="/openframeworks/app/ofAppGLFWWindow_cpp" class="block nuxt-link-exact-active nuxt-link-active current"><span class="src">src </span><span class="name">ofAppGLFWWindow.cpp </span></a><a href="/openframeworks/app/ofAppGLFWWindow_h" class="block"><span class="src">src </span><span class="name">ofAppGLFWWindow.h </span></a><a href="/openframeworks/app/ofAppGlutWindow_cpp" class="block"><span class="src">src </span><span class="name">ofAppGlutWindow.cpp </span></a><a href="/openframeworks/app/ofAppGlutWindow_h" class="block"><span class="src">src </span><span class="name">ofAppGlutWindow.h </span></a><a href="/openframeworks/app/ofAppNoWindow_cpp" class="block"><span class="src">src </span><span class="name">ofAppNoWindow.cpp </span></a><a href="/openframeworks/app/ofAppNoWindow_h" class="block"><span class="src">src </span><span class="name">ofAppNoWindow.h </span></a><a href="/openframeworks/app/ofAppRunner_cpp" class="block"><span class="src">src </span><span class="name">ofAppRunner.cpp </span></a><a href="/openframeworks/app/ofAppRunner_h" class="block"><span class="src">src </span><span class="name">ofAppRunner.h </span></a><a href="/openframeworks/app/ofBaseApp_cpp" class="block"><span class="src">src </span><span class="name">ofBaseApp.cpp </span></a><a href="/openframeworks/app/ofBaseApp_h" class="block"><span class="src">src </span><span class="name">ofBaseApp.h </span></a><a href="/openframeworks/app/ofIcon_h" class="block"><span class="src">src </span><span class="name">ofIcon.h </span></a><a href="/openframeworks/app/ofMainLoop_cpp" class="block"><span class="src">src </span><span class="name">ofMainLoop.cpp </span></a><a href="/openframeworks/app/ofMainLoop_h" class="block"><span class="src">src </span><span class="name">ofMainLoop.h </span></a><a href="/openframeworks/app/ofWindowSettings_h" class="block"><span class="src">src </span><span class="name">ofWindowSettings.h </span></a></div></div><div id="comments" class="dropdown-area"><h4 class="f3 dropdown-toggle">Comments</h4><div class="dropdown-area"></div></div><div filename="app" absolute="/Users/Gilbert/Code/openFrameworks/libs/openFrameworks/app" dir="../libs/openFrameworks" route="/openframeworks/app/" ext="" type="folder" id="176" children="177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193" icon="web" parent="164" breadcrumbs="164" class="see-also"><h4 class="f3">See also</h4><div class="also"><a href="/documentation/application/"><span class="origin">documentation</span><span class="name">application</span></a></div></div></div><div id="code-render"><div class="inner"><pre><code><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ofAppGLFWWindow.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ofEvents.h"</span></span>

<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ofBaseApp.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ofGLRenderer.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ofGLProgrammableRenderer.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ofAppRunner.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ofFileUtils.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ofEvents.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ofPixels.h"</span></span>

<span class="token macro property">#<span class="token directive keyword">define</span> GLFW_INCLUDE_NONE</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"GLFW/glfw3.h"</span></span>

<span class="token macro property">#<span class="token directive keyword">ifdef</span> TARGET_LINUX</span>
    <span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ofIcon.h"</span></span>
    <span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ofImage.h"</span></span>
    <span class="token macro property">#<span class="token directive keyword">define</span> GLFW_EXPOSE_NATIVE_X11</span>
    <span class="token macro property">#<span class="token directive keyword">ifndef</span> TARGET_OPENGLES</span>
        <span class="token macro property">#<span class="token directive keyword">define</span> GLFW_EXPOSE_NATIVE_GLX</span>
    <span class="token macro property">#<span class="token directive keyword">else</span></span>
        <span class="token macro property">#<span class="token directive keyword">define</span> GLFW_EXPOSE_NATIVE_EGL</span>
    <span class="token macro property">#<span class="token directive keyword">endif</span></span>
    <span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;X11/extensions/Xrandr.h></span></span>
    <span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;X11/XKBlib.h></span></span>
    <span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"GLFW/glfw3native.h"</span></span>
    <span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;X11/Xatom.h></span></span>
    <span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;xcb/xcb.h></span></span>
    <span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;xcb/xcbext.h></span></span>
<span class="token macro property">#<span class="token directive keyword">elif</span> defined(TARGET_OSX)</span>
    <span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;Cocoa/Cocoa.h></span></span>
    <span class="token macro property">#<span class="token directive keyword">define</span> GLFW_EXPOSE_NATIVE_COCOA</span>
    <span class="token macro property">#<span class="token directive keyword">define</span> GLFW_EXPOSE_NATIVE_NSGL</span>
    <span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"GLFW/glfw3native.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">elif</span> defined(TARGET_WIN32)</span>
    <span class="token macro property">#<span class="token directive keyword">define</span> GLFW_EXPOSE_NATIVE_WIN32</span>
    <span class="token macro property">#<span class="token directive keyword">define</span> GLFW_EXPOSE_NATIVE_WGL</span>
    <span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;GLFW/glfw3native.h></span></span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>

<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//-------------------------------------------------------</span>
ofAppGLFWWindow<span class="token operator">::</span><span class="token function">ofAppGLFWWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">:</span><span class="token function">coreEvents</span><span class="token punctuation">(</span><span class="token keyword">new</span> ofCoreEvents<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	bEnableSetupScreen	<span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
	buttonInUse			<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	buttonPressed		<span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
	bWindowNeedsShowing	<span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

	orientation 		<span class="token operator">=</span> OF_ORIENTATION_DEFAULT<span class="token punctuation">;</span>
	targetWindowMode	<span class="token operator">=</span> OF_WINDOW<span class="token punctuation">;</span>

	ofAppPtr			<span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>

	pixelScreenCoordScale <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	nFramesSinceWindowResized <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	iconSet <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
	windowP <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
	windowW <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	windowH <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	currentW <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	currentH <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token function">glfwSetErrorCallback</span><span class="token punctuation">(</span>error_cb<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

ofAppGLFWWindow<span class="token operator">::</span><span class="token operator">~</span><span class="token function">ofAppGLFWWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>windowP<span class="token punctuation">)</span><span class="token punctuation">{</span>


		<span class="token function">glfwSetMouseButtonCallback</span><span class="token punctuation">(</span> windowP<span class="token punctuation">,</span> <span class="token keyword">nullptr</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">glfwSetCursorPosCallback</span><span class="token punctuation">(</span> windowP<span class="token punctuation">,</span> <span class="token keyword">nullptr</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">glfwSetCursorEnterCallback</span><span class="token punctuation">(</span> windowP<span class="token punctuation">,</span> <span class="token keyword">nullptr</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">glfwSetKeyCallback</span><span class="token punctuation">(</span> windowP<span class="token punctuation">,</span> <span class="token keyword">nullptr</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">glfwSetWindowSizeCallback</span><span class="token punctuation">(</span> windowP<span class="token punctuation">,</span> <span class="token keyword">nullptr</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">glfwSetFramebufferSizeCallback</span><span class="token punctuation">(</span> windowP<span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">glfwSetWindowCloseCallback</span><span class="token punctuation">(</span> windowP<span class="token punctuation">,</span> <span class="token keyword">nullptr</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">glfwSetScrollCallback</span><span class="token punctuation">(</span> windowP<span class="token punctuation">,</span> <span class="token keyword">nullptr</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">if</span> GLFW_VERSION_MAJOR>3 || GLFW_VERSION_MINOR>=1</span>
		<span class="token function">glfwSetDropCallback</span><span class="token punctuation">(</span> windowP<span class="token punctuation">,</span> <span class="token keyword">nullptr</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
		<span class="token comment" spellcheck="true">//hide the window before we destroy it stops a flicker on OS X on exit.</span>
		<span class="token function">glfwHideWindow</span><span class="token punctuation">(</span>windowP<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment" spellcheck="true">// We must ensure renderer is destroyed *before* glfw destroys the window in glfwDestroyWindow,</span>
		<span class="token comment" spellcheck="true">// as `glfwDestroyWindow` at least on Windows has the effect of unloading OpenGL, making all</span>
		<span class="token comment" spellcheck="true">// calls to OpenGL illegal.</span>
		currentRenderer<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token function">glfwDestroyWindow</span><span class="token punctuation">(</span>windowP<span class="token punctuation">)</span><span class="token punctuation">;</span>
		windowP <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
		<span class="token function">events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		bWindowNeedsShowing <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">setNumSamples</span><span class="token punctuation">(</span><span class="token keyword">int</span> _samples<span class="token punctuation">)</span><span class="token punctuation">{</span>
	settings<span class="token punctuation">.</span>numSamples<span class="token operator">=</span>_samples<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">setMultiDisplayFullscreen</span><span class="token punctuation">(</span><span class="token keyword">bool</span> bMultiFullscreen<span class="token punctuation">)</span><span class="token punctuation">{</span>
	settings<span class="token punctuation">.</span>multiMonitorFullScreen <span class="token operator">=</span> bMultiFullscreen<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">setDoubleBuffering</span><span class="token punctuation">(</span><span class="token keyword">bool</span> doubleBuff<span class="token punctuation">)</span><span class="token punctuation">{</span>
	settings<span class="token punctuation">.</span>doubleBuffering <span class="token operator">=</span> doubleBuff<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">setColorBits</span><span class="token punctuation">(</span><span class="token keyword">int</span> r<span class="token punctuation">,</span> <span class="token keyword">int</span> g<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span>
	settings<span class="token punctuation">.</span>redBits<span class="token operator">=</span>r<span class="token punctuation">;</span>
	settings<span class="token punctuation">.</span>greenBits<span class="token operator">=</span>g<span class="token punctuation">;</span>
	settings<span class="token punctuation">.</span>blueBits<span class="token operator">=</span>b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">setAlphaBits</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span><span class="token punctuation">{</span>
	settings<span class="token punctuation">.</span>alphaBits<span class="token operator">=</span>a<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">setDepthBits</span><span class="token punctuation">(</span><span class="token keyword">int</span> depth<span class="token punctuation">)</span><span class="token punctuation">{</span>
	settings<span class="token punctuation">.</span>depthBits<span class="token operator">=</span>depth<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">setStencilBits</span><span class="token punctuation">(</span><span class="token keyword">int</span> stencil<span class="token punctuation">)</span><span class="token punctuation">{</span>
	settings<span class="token punctuation">.</span>stencilBits<span class="token operator">=</span>stencil<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token macro property">#<span class="token directive keyword">ifdef</span> TARGET_OPENGLES</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">setup</span><span class="token punctuation">(</span><span class="token keyword">const</span> ofGLESWindowSettings <span class="token operator">&</span> settings<span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token macro property">#<span class="token directive keyword">else</span></span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">setup</span><span class="token punctuation">(</span><span class="token keyword">const</span> ofGLWindowSettings <span class="token operator">&</span> settings<span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
	<span class="token keyword">const</span> ofGLFWWindowSettings <span class="token operator">*</span> glSettings <span class="token operator">=</span> <span class="token keyword">dynamic_cast</span><span class="token operator">&lt;</span><span class="token keyword">const</span> ofGLFWWindowSettings<span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token operator">&</span>settings<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>glSettings<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">setup</span><span class="token punctuation">(</span><span class="token operator">*</span>glSettings<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
		<span class="token function">setup</span><span class="token punctuation">(</span><span class="token function">ofGLFWWindowSettings</span><span class="token punctuation">(</span>settings<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">setup</span><span class="token punctuation">(</span><span class="token keyword">const</span> ofGLFWWindowSettings <span class="token operator">&</span> _settings<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>windowP<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">ofLogError</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"window already setup, probably you are mixing old and new style setup"</span><span class="token punctuation">;</span>
		<span class="token function">ofLogError</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"call only ofCreateWindow(settings) or ofSetupOpenGL(...)"</span><span class="token punctuation">;</span>
		<span class="token function">ofLogError</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"calling window->setup() after ofCreateWindow() is not necesary and won't do anything"</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	settings <span class="token operator">=</span> _settings<span class="token punctuation">;</span>

	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">glfwInit</span><span class="token punctuation">(</span> <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">ofLogError</span><span class="token punctuation">(</span><span class="token string">"ofAppGLFWWindow"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"couldn't init GLFW"</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//	ofLogNotice("ofAppGLFWWindow") &lt;&lt; "WINDOW MODE IS " &lt;&lt; screenMode;</span>

	<span class="token function">glfwDefaultWindowHints</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glfwWindowHint</span><span class="token punctuation">(</span>GLFW_RED_BITS<span class="token punctuation">,</span> settings<span class="token punctuation">.</span>redBits<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glfwWindowHint</span><span class="token punctuation">(</span>GLFW_GREEN_BITS<span class="token punctuation">,</span> settings<span class="token punctuation">.</span>greenBits<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glfwWindowHint</span><span class="token punctuation">(</span>GLFW_BLUE_BITS<span class="token punctuation">,</span> settings<span class="token punctuation">.</span>blueBits<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glfwWindowHint</span><span class="token punctuation">(</span>GLFW_ALPHA_BITS<span class="token punctuation">,</span> settings<span class="token punctuation">.</span>alphaBits<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glfwWindowHint</span><span class="token punctuation">(</span>GLFW_DEPTH_BITS<span class="token punctuation">,</span> settings<span class="token punctuation">.</span>depthBits<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glfwWindowHint</span><span class="token punctuation">(</span>GLFW_STENCIL_BITS<span class="token punctuation">,</span> settings<span class="token punctuation">.</span>stencilBits<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glfwWindowHint</span><span class="token punctuation">(</span>GLFW_STEREO<span class="token punctuation">,</span> settings<span class="token punctuation">.</span>stereo<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glfwWindowHint</span><span class="token punctuation">(</span>GLFW_VISIBLE<span class="token punctuation">,</span> GL_FALSE<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">ifndef</span> TARGET_OSX</span>
	<span class="token function">glfwWindowHint</span><span class="token punctuation">(</span>GLFW_AUX_BUFFERS<span class="token punctuation">,</span> settings<span class="token punctuation">.</span>doubleBuffering<span class="token operator">?</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
	<span class="token function">glfwWindowHint</span><span class="token punctuation">(</span>GLFW_SAMPLES<span class="token punctuation">,</span> settings<span class="token punctuation">.</span>numSamples<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glfwWindowHint</span><span class="token punctuation">(</span>GLFW_RESIZABLE<span class="token punctuation">,</span> settings<span class="token punctuation">.</span>resizable<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glfwWindowHint</span><span class="token punctuation">(</span>GLFW_DECORATED<span class="token punctuation">,</span> settings<span class="token punctuation">.</span>decorated<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">#<span class="token directive keyword">ifdef</span> TARGET_OPENGLES</span>
	    <span class="token function">glfwWindowHint</span><span class="token punctuation">(</span>GLFW_CONTEXT_VERSION_MAJOR<span class="token punctuation">,</span> settings<span class="token punctuation">.</span>glesVersion<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">glfwWindowHint</span><span class="token punctuation">(</span>GLFW_CONTEXT_VERSION_MINOR<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">glfwWindowHint</span><span class="token punctuation">(</span>GLFW_CLIENT_API<span class="token punctuation">,</span> GLFW_OPENGL_ES_API<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>glesVersion<span class="token operator">>=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			currentRenderer <span class="token operator">=</span> std<span class="token operator">::</span>make_shared<span class="token operator">&lt;</span>ofGLProgrammableRenderer<span class="token operator">></span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
			currentRenderer <span class="token operator">=</span> std<span class="token operator">::</span>make_shared<span class="token operator">&lt;</span>ofGLRenderer<span class="token operator">></span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
    <span class="token macro property">#<span class="token directive keyword">else</span></span>
	    <span class="token function">glfwWindowHint</span><span class="token punctuation">(</span>GLFW_CLIENT_API<span class="token punctuation">,</span> GLFW_OPENGL_API<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">glfwWindowHint</span><span class="token punctuation">(</span>GLFW_CONTEXT_VERSION_MAJOR<span class="token punctuation">,</span> settings<span class="token punctuation">.</span>glVersionMajor<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">glfwWindowHint</span><span class="token punctuation">(</span>GLFW_CONTEXT_VERSION_MINOR<span class="token punctuation">,</span> settings<span class="token punctuation">.</span>glVersionMinor<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>glVersionMajor<span class="token operator">==</span><span class="token number">3</span> <span class="token operator">&&</span> settings<span class="token punctuation">.</span>glVersionMinor<span class="token operator">>=</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">||</span> settings<span class="token punctuation">.</span>glVersionMajor<span class="token operator">>=</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token function">glfwWindowHint</span><span class="token punctuation">(</span>GLFW_OPENGL_PROFILE<span class="token punctuation">,</span> GLFW_OPENGL_CORE_PROFILE<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>glVersionMajor<span class="token operator">>=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token function">glfwWindowHint</span><span class="token punctuation">(</span>GLFW_OPENGL_FORWARD_COMPAT<span class="token punctuation">,</span> GL_TRUE<span class="token punctuation">)</span><span class="token punctuation">;</span>
			currentRenderer <span class="token operator">=</span> std<span class="token operator">::</span>make_shared<span class="token operator">&lt;</span>ofGLProgrammableRenderer<span class="token operator">></span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
			currentRenderer <span class="token operator">=</span> std<span class="token operator">::</span>make_shared<span class="token operator">&lt;</span>ofGLRenderer<span class="token operator">></span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
    <span class="token macro property">#<span class="token directive keyword">endif</span></span>

	GLFWwindow <span class="token operator">*</span> sharedContext <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>shareContextWith<span class="token punctuation">)</span><span class="token punctuation">{</span>
		sharedContext <span class="token operator">=</span> <span class="token punctuation">(</span>GLFWwindow<span class="token operator">*</span><span class="token punctuation">)</span>settings<span class="token punctuation">.</span>shareContextWith<span class="token operator">-</span><span class="token operator">></span><span class="token function">getWindowContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">if</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>windowMode<span class="token operator">==</span>OF_GAME_MODE<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">int</span> count<span class="token punctuation">;</span>
		GLFWmonitor<span class="token operator">*</span><span class="token operator">*</span> monitors <span class="token operator">=</span> <span class="token function">glfwGetMonitors</span><span class="token punctuation">(</span><span class="token operator">&</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span><span class="token function">isSizeSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			currentW <span class="token operator">=</span> settings<span class="token punctuation">.</span><span class="token function">getWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			currentH <span class="token operator">=</span> settings<span class="token punctuation">.</span><span class="token function">getHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
			<span class="token keyword">auto</span> mode <span class="token operator">=</span> <span class="token function">glfwGetVideoMode</span><span class="token punctuation">(</span>monitors<span class="token punctuation">[</span>settings<span class="token punctuation">.</span>monitor<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			currentW <span class="token operator">=</span> mode<span class="token operator">-</span><span class="token operator">></span>width<span class="token punctuation">;</span>
			currentH <span class="token operator">=</span> mode<span class="token operator">-</span><span class="token operator">></span>height<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>count<span class="token operator">></span>settings<span class="token punctuation">.</span>monitor<span class="token punctuation">)</span><span class="token punctuation">{</span>
			windowP <span class="token operator">=</span> <span class="token function">glfwCreateWindow</span><span class="token punctuation">(</span>currentW<span class="token punctuation">,</span> currentH<span class="token punctuation">,</span> settings<span class="token punctuation">.</span>title<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> monitors<span class="token punctuation">[</span>settings<span class="token punctuation">.</span>monitor<span class="token punctuation">]</span><span class="token punctuation">,</span> sharedContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
			<span class="token function">ofLogError</span><span class="token punctuation">(</span><span class="token string">"ofAppGLFWWindow"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"couldn't find any monitors"</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
		windowP <span class="token operator">=</span> <span class="token function">glfwCreateWindow</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span><span class="token function">getWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> settings<span class="token punctuation">.</span><span class="token function">getHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> settings<span class="token punctuation">.</span>title<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">nullptr</span><span class="token punctuation">,</span> sharedContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>windowP<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token function">ofLogError</span><span class="token punctuation">(</span><span class="token string">"ofAppGLFWWindow"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"couldn't create GLFW window"</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>windowMode<span class="token operator">==</span>OF_FULLSCREEN<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token keyword">auto</span> monitors <span class="token operator">=</span> <span class="token function">glfwGetMonitors</span><span class="token punctuation">(</span><span class="token operator">&</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">auto</span> mode <span class="token operator">=</span> <span class="token function">glfwGetVideoMode</span><span class="token punctuation">(</span>monitors<span class="token punctuation">[</span>settings<span class="token punctuation">.</span>monitor<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			currentW <span class="token operator">=</span> mode<span class="token operator">-</span><span class="token operator">></span>width<span class="token punctuation">;</span>
			currentH <span class="token operator">=</span> mode<span class="token operator">-</span><span class="token operator">></span>height<span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>settings<span class="token punctuation">.</span><span class="token function">isPositionSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>count <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
					<span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
					settings<span class="token punctuation">.</span>monitor <span class="token operator">=</span> <span class="token function">ofClamp</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>monitor<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>count<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token function">glfwGetMonitorPos</span><span class="token punctuation">(</span>monitors<span class="token punctuation">[</span>settings<span class="token punctuation">.</span>monitor<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">&</span>x<span class="token punctuation">,</span><span class="token operator">&</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
					settings<span class="token punctuation">.</span><span class="token function">setPosition</span><span class="token punctuation">(</span>glm<span class="token operator">::</span><span class="token function">vec2</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token function">setWindowPosition</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span><span class="token function">getPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span>settings<span class="token punctuation">.</span><span class="token function">getPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">auto</span> mode <span class="token operator">=</span> <span class="token function">glfwGetVideoMode</span><span class="token punctuation">(</span>monitors<span class="token punctuation">[</span>settings<span class="token punctuation">.</span>monitor<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token macro property">#<span class="token directive keyword">ifdef</span> TARGET_OSX</span>
					    <span class="token comment" spellcheck="true">//for OS X we need to set this first as the window size affects the window positon</span>
					    settings<span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span>mode<span class="token operator">-</span><span class="token operator">></span>width<span class="token punctuation">,</span> mode<span class="token operator">-</span><span class="token operator">></span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token function">setWindowShape</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span><span class="token function">getWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> settings<span class="token punctuation">.</span><span class="token function">getHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token macro property">#<span class="token directive keyword">endif</span></span>
					<span class="token function">setWindowPosition</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span><span class="token function">getPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span>settings<span class="token punctuation">.</span><span class="token function">getPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
					currentW <span class="token operator">=</span> mode<span class="token operator">-</span><span class="token operator">></span>width<span class="token punctuation">;</span>
					currentH <span class="token operator">=</span> mode<span class="token operator">-</span><span class="token operator">></span>height<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
				<span class="token function">setWindowPosition</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span><span class="token function">getPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span>settings<span class="token punctuation">.</span><span class="token function">getPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token macro property">#<span class="token directive keyword">ifdef</span> TARGET_OSX</span>
				    <span class="token keyword">auto</span> size <span class="token operator">=</span> <span class="token function">getScreenSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					settings<span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span>size<span class="token punctuation">.</span>x<span class="token punctuation">,</span> size<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token function">setWindowShape</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span><span class="token function">getWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> settings<span class="token punctuation">.</span><span class="token function">getHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token macro property">#<span class="token directive keyword">endif</span></span>
					currentW <span class="token operator">=</span> settings<span class="token punctuation">.</span><span class="token function">getWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					currentH <span class="token operator">=</span> settings<span class="token punctuation">.</span><span class="token function">getHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
						<span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
						<span class="token function">glfwGetMonitorPos</span><span class="token punctuation">(</span>monitors<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">&</span>x<span class="token punctuation">,</span><span class="token operator">&</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token keyword">auto</span> mode <span class="token operator">=</span> <span class="token function">glfwGetVideoMode</span><span class="token punctuation">(</span>monitors<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token keyword">int</span> w <span class="token operator">=</span> mode<span class="token operator">-</span><span class="token operator">></span>width<span class="token punctuation">;</span>
						<span class="token keyword">int</span> h <span class="token operator">=</span> mode<span class="token operator">-</span><span class="token operator">></span>height<span class="token punctuation">;</span>
						ofRectangle <span class="token function">rect</span><span class="token punctuation">(</span>x<span class="token number">-1</span><span class="token punctuation">,</span>y<span class="token number">-1</span><span class="token punctuation">,</span>w<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>h<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token keyword">if</span><span class="token punctuation">(</span>rect<span class="token punctuation">.</span><span class="token function">inside</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span><span class="token function">getPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
							currentW <span class="token operator">=</span> mode<span class="token operator">-</span><span class="token operator">></span>width<span class="token punctuation">;</span>
							currentH <span class="token operator">=</span> mode<span class="token operator">-</span><span class="token operator">></span>height<span class="token punctuation">;</span>
							<span class="token keyword">break</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span>
					<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
			targetWindowMode <span class="token operator">=</span> settings<span class="token punctuation">.</span>windowMode<span class="token punctuation">;</span>
			settings<span class="token punctuation">.</span>windowMode <span class="token operator">=</span> OF_WINDOW<span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>settings<span class="token punctuation">.</span><span class="token function">isPositionSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token function">setWindowPosition</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span><span class="token function">getPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span>settings<span class="token punctuation">.</span><span class="token function">getPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token function">glfwGetWindowSize</span><span class="token punctuation">(</span> windowP<span class="token punctuation">,</span> <span class="token operator">&</span>currentW<span class="token punctuation">,</span> <span class="token operator">&</span>currentH <span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
        <span class="token macro property">#<span class="token directive keyword">ifdef</span> TARGET_LINUX</span>
		    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>iconSet<span class="token punctuation">)</span><span class="token punctuation">{</span>
				ofPixels iconPixels<span class="token punctuation">;</span>
                <span class="token macro property">#<span class="token directive keyword">ifdef</span> DEBUG</span>
				    iconPixels<span class="token punctuation">.</span><span class="token function">allocate</span><span class="token punctuation">(</span>ofIconDebug<span class="token punctuation">.</span>width<span class="token punctuation">,</span>ofIconDebug<span class="token punctuation">.</span>height<span class="token punctuation">,</span>ofIconDebug<span class="token punctuation">.</span>bytes_per_pixel<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token function">GIMP_IMAGE_RUN_LENGTH_DECODE</span><span class="token punctuation">(</span>iconPixels<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ofIconDebug<span class="token punctuation">.</span>rle_pixel_data<span class="token punctuation">,</span>iconPixels<span class="token punctuation">.</span><span class="token function">getWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span>iconPixels<span class="token punctuation">.</span><span class="token function">getHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ofIconDebug<span class="token punctuation">.</span>bytes_per_pixel<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token macro property">#<span class="token directive keyword">else</span></span>
				    iconPixels<span class="token punctuation">.</span><span class="token function">allocate</span><span class="token punctuation">(</span>ofIcon<span class="token punctuation">.</span>width<span class="token punctuation">,</span>ofIcon<span class="token punctuation">.</span>height<span class="token punctuation">,</span>ofIcon<span class="token punctuation">.</span>bytes_per_pixel<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token function">GIMP_IMAGE_RUN_LENGTH_DECODE</span><span class="token punctuation">(</span>iconPixels<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ofIcon<span class="token punctuation">.</span>rle_pixel_data<span class="token punctuation">,</span>iconPixels<span class="token punctuation">.</span><span class="token function">getWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span>iconPixels<span class="token punctuation">.</span><span class="token function">getHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ofIcon<span class="token punctuation">.</span>bytes_per_pixel<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token macro property">#<span class="token directive keyword">endif</span></span>
				<span class="token function">setWindowIcon</span><span class="token punctuation">(</span>iconPixels<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
        <span class="token macro property">#<span class="token directive keyword">endif</span></span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>iconified<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token function">iconify</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token comment" spellcheck="true">//don't try and show a window if its been requsted to be hidden</span>
	bWindowNeedsShowing <span class="token operator">=</span> settings<span class="token punctuation">.</span>visible<span class="token punctuation">;</span>

	<span class="token function">glfwSetWindowUserPointer</span><span class="token punctuation">(</span>windowP<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	windowW <span class="token operator">=</span> settings<span class="token punctuation">.</span><span class="token function">getWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	windowH <span class="token operator">=</span> settings<span class="token punctuation">.</span><span class="token function">getHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
<span class="token macro property">#<span class="token directive keyword">ifdef</span> TARGET_RASPBERRY_PI</span>
	windowRect<span class="token punctuation">.</span>width <span class="token operator">=</span> windowW<span class="token punctuation">;</span>
	windowRect<span class="token punctuation">.</span>height <span class="token operator">=</span> windowH<span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span> </span>

	<span class="token function">glfwMakeContextCurrent</span><span class="token punctuation">(</span>windowP<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">int</span> framebufferW<span class="token punctuation">,</span> framebufferH<span class="token punctuation">,</span> tmpWindowW<span class="token punctuation">,</span> tmpWindowH<span class="token punctuation">;</span>
	<span class="token function">glfwGetFramebufferSize</span><span class="token punctuation">(</span>windowP<span class="token punctuation">,</span> <span class="token operator">&</span>framebufferW<span class="token punctuation">,</span> <span class="token operator">&</span>framebufferH<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glfwGetWindowSize</span><span class="token punctuation">(</span> windowP<span class="token punctuation">,</span> <span class="token operator">&</span>tmpWindowW<span class="token punctuation">,</span> <span class="token operator">&</span>tmpWindowH <span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment" spellcheck="true">//this lets us detect if the window is running in a retina mode</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span> framebufferW <span class="token operator">!=</span> tmpWindowW<span class="token punctuation">)</span><span class="token punctuation">{</span>
		pixelScreenCoordScale <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>framebufferW <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>windowW<span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span> pixelScreenCoordScale <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
			pixelScreenCoordScale <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">if</span><span class="token punctuation">(</span>targetWindowMode <span class="token operator">==</span> OF_WINDOW<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">auto</span> position <span class="token operator">=</span> <span class="token function">getWindowPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">setWindowShape</span><span class="token punctuation">(</span>windowW<span class="token punctuation">,</span> windowH<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">setWindowPosition</span><span class="token punctuation">(</span>position<span class="token punctuation">.</span>x<span class="token punctuation">,</span> position<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

<span class="token macro property">#<span class="token directive keyword">ifndef</span> TARGET_OPENGLES</span>
	<span class="token keyword">static</span> <span class="token keyword">bool</span> inited <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>inited<span class="token punctuation">)</span><span class="token punctuation">{</span>
		glewExperimental <span class="token operator">=</span> GL_TRUE<span class="token punctuation">;</span>
		GLenum err <span class="token operator">=</span> <span class="token function">glewInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>GLEW_OK <span class="token operator">!=</span> err<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			<span class="token comment" spellcheck="true">/* Problem: glewInit failed, something is seriously wrong. */</span>
			<span class="token function">ofLogError</span><span class="token punctuation">(</span><span class="token string">"ofAppRunner"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"couldn't init GLEW: "</span> <span class="token operator">&lt;&lt;</span> <span class="token function">glewGetErrorString</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		inited <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>

	<span class="token function">ofLogVerbose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"GL Version:"</span> <span class="token operator">&lt;&lt;</span> <span class="token function">glGetString</span><span class="token punctuation">(</span>GL_VERSION<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span><span class="token punctuation">(</span>currentRenderer<span class="token operator">-</span><span class="token operator">></span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span>ofGLProgrammableRenderer<span class="token operator">::</span>TYPE<span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token macro property">#<span class="token directive keyword">ifndef</span> TARGET_OPENGLES</span>
		<span class="token keyword">static_cast</span><span class="token operator">&lt;</span>ofGLProgrammableRenderer<span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">(</span>currentRenderer<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">setup</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>glVersionMajor<span class="token punctuation">,</span>settings<span class="token punctuation">.</span>glVersionMinor<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">else</span></span>
		<span class="token keyword">static_cast</span><span class="token operator">&lt;</span>ofGLProgrammableRenderer<span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">(</span>currentRenderer<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">setup</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>glesVersion<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
		<span class="token keyword">static_cast</span><span class="token operator">&lt;</span>ofGLRenderer<span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">(</span>currentRenderer<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">setVerticalSync</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glfwSetMouseButtonCallback</span><span class="token punctuation">(</span>windowP<span class="token punctuation">,</span> mouse_cb<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glfwSetCursorPosCallback</span><span class="token punctuation">(</span>windowP<span class="token punctuation">,</span> motion_cb<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glfwSetCursorEnterCallback</span><span class="token punctuation">(</span>windowP<span class="token punctuation">,</span> entry_cb<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glfwSetKeyCallback</span><span class="token punctuation">(</span>windowP<span class="token punctuation">,</span> keyboard_cb<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glfwSetCharCallback</span><span class="token punctuation">(</span>windowP<span class="token punctuation">,</span> char_cb<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glfwSetWindowSizeCallback</span><span class="token punctuation">(</span>windowP<span class="token punctuation">,</span> resize_cb<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glfwSetFramebufferSizeCallback</span><span class="token punctuation">(</span> windowP<span class="token punctuation">,</span> framebuffer_size_cb<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glfwSetWindowCloseCallback</span><span class="token punctuation">(</span>windowP<span class="token punctuation">,</span> exit_cb<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">glfwSetScrollCallback</span><span class="token punctuation">(</span>windowP<span class="token punctuation">,</span> scroll_cb<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">if</span> GLFW_VERSION_MAJOR>3 || GLFW_VERSION_MINOR>=1</span>
	    <span class="token function">glfwSetDropCallback</span><span class="token punctuation">(</span> windowP<span class="token punctuation">,</span> drop_cb <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>


<span class="token macro property">#<span class="token directive keyword">ifdef</span> TARGET_LINUX</span>
	<span class="token function">XSetLocaleModifiers</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	xim <span class="token operator">=</span> <span class="token function">XOpenIM</span><span class="token punctuation">(</span><span class="token function">getX11Display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>xim<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment" spellcheck="true">// fallback to internal input method</span>
		<span class="token function">XSetLocaleModifiers</span><span class="token punctuation">(</span><span class="token string">"@im=none"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		xim <span class="token operator">=</span> <span class="token function">XOpenIM</span><span class="token punctuation">(</span><span class="token function">getX11Display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	xic <span class="token operator">=</span> <span class="token function">XCreateIC</span><span class="token punctuation">(</span>xim<span class="token punctuation">,</span>
	        XNInputStyle<span class="token punctuation">,</span>   XIMPreeditNothing <span class="token operator">|</span> XIMStatusNothing<span class="token punctuation">,</span>
	        XNClientWindow<span class="token punctuation">,</span> <span class="token function">getX11Window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	        XNFocusWindow<span class="token punctuation">,</span>  <span class="token function">getX11Window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	    <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
<span class="token punctuation">}</span>

<span class="token macro property">#<span class="token directive keyword">ifdef</span> TARGET_LINUX</span>
<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token keyword">const</span> string <span class="token operator">&</span> path<span class="token punctuation">)</span><span class="token punctuation">{</span>
	ofPixels iconPixels<span class="token punctuation">;</span>
	<span class="token function">ofLoadImage</span><span class="token punctuation">(</span>iconPixels<span class="token punctuation">,</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">setWindowIcon</span><span class="token punctuation">(</span>iconPixels<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token keyword">const</span> ofPixels <span class="token operator">&</span> iconPixels<span class="token punctuation">)</span><span class="token punctuation">{</span>
	iconSet <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">+</span>iconPixels<span class="token punctuation">.</span><span class="token function">getWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span>iconPixels<span class="token punctuation">.</span><span class="token function">getHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	vector<span class="token operator">&lt;</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span><span class="token operator">></span> <span class="token function">buffer</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
	buffer<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>iconPixels<span class="token punctuation">.</span><span class="token function">getWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	buffer<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>iconPixels<span class="token punctuation">.</span><span class="token function">getHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span>size_t i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>iconPixels<span class="token punctuation">.</span><span class="token function">getWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span>iconPixels<span class="token punctuation">.</span><span class="token function">getHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		buffer<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span>  <span class="token operator">=</span> iconPixels<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">4</span><span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">24</span><span class="token punctuation">;</span>
		buffer<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span><span class="token operator">=</span> iconPixels<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">4</span><span class="token operator">+</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">;</span>
		buffer<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span><span class="token operator">=</span> iconPixels<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">4</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">;</span>
		buffer<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span><span class="token operator">=</span> iconPixels<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">4</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">XChangeProperty</span><span class="token punctuation">(</span><span class="token function">getX11Display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getX11Window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">XInternAtom</span><span class="token punctuation">(</span><span class="token function">getX11Display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"_NET_WM_ICON"</span><span class="token punctuation">,</span> False<span class="token punctuation">)</span><span class="token punctuation">,</span> XA_CARDINAL<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span>
	                     PropModeReplace<span class="token punctuation">,</span>  <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span>buffer<span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  length<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">XFlush</span><span class="token punctuation">(</span><span class="token function">getX11Display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>

<span class="token comment" spellcheck="true">//--------------------------------------------</span>
ofCoreEvents <span class="token operator">&</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">*</span>coreEvents<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//--------------------------------------------</span>
shared_ptr<span class="token operator">&lt;</span>ofBaseRenderer<span class="token operator">></span> <span class="token operator">&</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">renderer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> currentRenderer<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//--------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">notifyUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment" spellcheck="true">//show the window right before the first draw call.</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span> bWindowNeedsShowing <span class="token operator">&&</span> windowP <span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">glfwShowWindow</span><span class="token punctuation">(</span>windowP<span class="token punctuation">)</span><span class="token punctuation">;</span>
		bWindowNeedsShowing <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>targetWindowMode<span class="token operator">==</span>OF_FULLSCREEN<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token function">setFullscreen</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

<span class="token macro property">#<span class="token directive keyword">ifdef</span> TARGET_RASPBERRY_PI</span>
    <span class="token comment" spellcheck="true">//needed for rpi. as good values don't come into resize_cb when coming out of fullscreen</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span> needsResizeCheck <span class="token operator">&&</span> windowP <span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">int</span> winW<span class="token punctuation">,</span> winH<span class="token punctuation">;</span>
        <span class="token function">glfwGetWindowSize</span><span class="token punctuation">(</span>windowP<span class="token punctuation">,</span> <span class="token operator">&</span>winW<span class="token punctuation">,</span> <span class="token operator">&</span>winH<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment" spellcheck="true">//wait until the window size is the size it was before going fullscreen</span>
        <span class="token comment" spellcheck="true">//then stop the resize check</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span> winW <span class="token operator">==</span> windowRect<span class="token punctuation">.</span><span class="token function">getWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&&</span> winH <span class="token operator">==</span> windowRect<span class="token punctuation">.</span><span class="token function">getHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token function">resize_cb</span><span class="token punctuation">(</span>windowP<span class="token punctuation">,</span> currentW<span class="token punctuation">,</span> currentH<span class="token punctuation">)</span><span class="token punctuation">;</span>
            needsResizeCheck <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//--------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">pollEvents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">glfwPollEvents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//--------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	currentRenderer<span class="token operator">-</span><span class="token operator">></span><span class="token function">startRender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span> bEnableSetupScreen <span class="token punctuation">)</span> currentRenderer<span class="token operator">-</span><span class="token operator">></span><span class="token function">setupScreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">notifyDraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token macro property">#<span class="token directive keyword">ifdef</span> TARGET_WIN32</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>currentRenderer<span class="token operator">-</span><span class="token operator">></span><span class="token function">getBackgroundAuto</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment" spellcheck="true">// on a PC resizing a window with this method of accumulation (essentially single buffering)</span>
		<span class="token comment" spellcheck="true">// is BAD, so we clear on resize events.</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>nFramesSinceWindowResized <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			currentRenderer<span class="token operator">-</span><span class="token operator">></span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token function">events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFrameNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">3</span> <span class="token operator">||</span> nFramesSinceWindowResized <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&&</span> settings<span class="token punctuation">.</span>doubleBuffering<span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token function">glfwSwapBuffers</span><span class="token punctuation">(</span>windowP<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
				<span class="token function">glFlush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>doubleBuffering<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token function">glfwSwapBuffers</span><span class="token punctuation">(</span>windowP<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token function">glFlush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
    <span class="token macro property">#<span class="token directive keyword">else</span></span>
	    <span class="token keyword">if</span> <span class="token punctuation">(</span>currentRenderer<span class="token operator">-</span><span class="token operator">></span><span class="token function">getBackgroundAuto</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token comment" spellcheck="true">// in accum mode resizing a window is BAD, so we clear on resize events.</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>nFramesSinceWindowResized <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				currentRenderer<span class="token operator">-</span><span class="token operator">></span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>doubleBuffering<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token function">glfwSwapBuffers</span><span class="token punctuation">(</span>windowP<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span><span class="token punctuation">{</span>
			<span class="token function">glFlush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
    <span class="token macro property">#<span class="token directive keyword">endif</span></span>

	currentRenderer<span class="token operator">-</span><span class="token operator">></span><span class="token function">finishRender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	nFramesSinceWindowResized<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token comment" spellcheck="true">//--------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">swapBuffers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">glfwSwapBuffers</span><span class="token punctuation">(</span>windowP<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//--------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">startRender</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">renderer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">startRender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//--------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">finishRender</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">renderer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">finishRender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//--------------------------------------------</span>
<span class="token keyword">bool</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">getWindowShouldClose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token function">glfwWindowShouldClose</span><span class="token punctuation">(</span>windowP<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//--------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">setWindowShouldClose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">glfwSetWindowShouldClose</span><span class="token punctuation">(</span>windowP<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span>string title<span class="token punctuation">)</span><span class="token punctuation">{</span>
	settings<span class="token punctuation">.</span>title <span class="token operator">=</span> title<span class="token punctuation">;</span>
	<span class="token function">glfwSetWindowTitle</span><span class="token punctuation">(</span>windowP<span class="token punctuation">,</span>settings<span class="token punctuation">.</span>title<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">int</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">getPixelScreenCoordScale</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> pixelScreenCoordScale<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
glm<span class="token operator">::</span>vec2 ofAppGLFWWindow<span class="token operator">::</span><span class="token function">getWindowSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>windowMode <span class="token operator">==</span> OF_GAME_MODE<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">const</span> GLFWvidmode <span class="token operator">*</span> desktopMode <span class="token operator">=</span> <span class="token function">glfwGetVideoMode</span><span class="token punctuation">(</span><span class="token function">glfwGetWindowMonitor</span><span class="token punctuation">(</span>windowP<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>desktopMode<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token punctuation">{</span>desktopMode<span class="token operator">-</span><span class="token operator">></span>width<span class="token operator">*</span>pixelScreenCoordScale<span class="token punctuation">,</span> desktopMode<span class="token operator">-</span><span class="token operator">></span>height<span class="token operator">*</span>pixelScreenCoordScale<span class="token punctuation">}</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token punctuation">{</span>currentW<span class="token operator">*</span>pixelScreenCoordScale<span class="token punctuation">,</span> currentH<span class="token operator">*</span>pixelScreenCoordScale<span class="token punctuation">}</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token punctuation">{</span>currentW<span class="token operator">*</span>pixelScreenCoordScale<span class="token punctuation">,</span> currentH<span class="token operator">*</span>pixelScreenCoordScale<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
glm<span class="token operator">::</span>vec2 ofAppGLFWWindow<span class="token operator">::</span><span class="token function">getWindowPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> x<span class="token punctuation">,</span> y<span class="token punctuation">;</span>
	<span class="token function">glfwGetWindowPos</span><span class="token punctuation">(</span>windowP<span class="token punctuation">,</span> <span class="token operator">&</span>x<span class="token punctuation">,</span> <span class="token operator">&</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    x <span class="token operator">*</span><span class="token operator">=</span> pixelScreenCoordScale<span class="token punctuation">;</span>
    y <span class="token operator">*</span><span class="token operator">=</span> pixelScreenCoordScale<span class="token punctuation">;</span>

	<span class="token keyword">if</span><span class="token punctuation">(</span> orientation <span class="token operator">==</span> OF_ORIENTATION_DEFAULT <span class="token operator">||</span> orientation <span class="token operator">==</span> OF_ORIENTATION_180 <span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> glm<span class="token operator">::</span>vec2<span class="token punctuation">{</span>x<span class="token punctuation">,</span>y<span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> glm<span class="token operator">::</span><span class="token function">vec2</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//NOTE: shouldn't this be (y,x) ??????</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">int</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">getCurrentMonitor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> numberOfMonitors<span class="token punctuation">;</span>
	GLFWmonitor<span class="token operator">*</span><span class="token operator">*</span> monitors <span class="token operator">=</span> <span class="token function">glfwGetMonitors</span><span class="token punctuation">(</span><span class="token operator">&</span>numberOfMonitors<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">int</span> xW<span class="token punctuation">;</span>	<span class="token keyword">int</span> yW<span class="token punctuation">;</span>
	<span class="token function">glfwGetWindowPos</span><span class="token punctuation">(</span>windowP<span class="token punctuation">,</span> <span class="token operator">&</span>xW<span class="token punctuation">,</span> <span class="token operator">&</span>yW<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> iC<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> iC <span class="token operator">&lt;</span> numberOfMonitors<span class="token punctuation">;</span> iC<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">int</span> xM<span class="token punctuation">;</span> <span class="token keyword">int</span> yM<span class="token punctuation">;</span>
		<span class="token function">glfwGetMonitorPos</span><span class="token punctuation">(</span>monitors<span class="token punctuation">[</span>iC<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&</span>xM<span class="token punctuation">,</span> <span class="token operator">&</span>yM<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">const</span> GLFWvidmode <span class="token operator">*</span> desktopMode <span class="token operator">=</span> <span class="token function">glfwGetVideoMode</span><span class="token punctuation">(</span>monitors<span class="token punctuation">[</span>iC<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		ofRectangle <span class="token function">monitorRect</span><span class="token punctuation">(</span>xM<span class="token punctuation">,</span> yM<span class="token punctuation">,</span> desktopMode<span class="token operator">-</span><span class="token operator">></span>width<span class="token punctuation">,</span> desktopMode<span class="token operator">-</span><span class="token operator">></span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">bool</span> bPointMatch <span class="token operator">=</span> xW <span class="token operator">>=</span> monitorRect<span class="token punctuation">.</span><span class="token function">getMinX</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&&</span> yW <span class="token operator">>=</span> monitorRect<span class="token punctuation">.</span><span class="token function">getMinY</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&&</span> xW <span class="token operator">&lt;</span> monitorRect<span class="token punctuation">.</span><span class="token function">getMaxX</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&&</span> yW <span class="token operator">&lt;</span> monitorRect<span class="token punctuation">.</span><span class="token function">getMaxY</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment" spellcheck="true">//		if (monitorRect.inside(xW, yW)){</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span> bPointMatch <span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> iC<span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
glm<span class="token operator">::</span>vec2 ofAppGLFWWindow<span class="token operator">::</span><span class="token function">getScreenSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> count<span class="token punctuation">;</span>
	GLFWmonitor<span class="token operator">*</span><span class="token operator">*</span> monitors <span class="token operator">=</span> <span class="token function">glfwGetMonitors</span><span class="token punctuation">(</span><span class="token operator">&</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>count<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">int</span> currentMonitor <span class="token operator">=</span> <span class="token function">getCurrentMonitor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">const</span> GLFWvidmode <span class="token operator">*</span> desktopMode <span class="token operator">=</span> <span class="token function">glfwGetVideoMode</span><span class="token punctuation">(</span>monitors<span class="token punctuation">[</span>currentMonitor<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>desktopMode<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span> orientation <span class="token operator">==</span> OF_ORIENTATION_DEFAULT <span class="token operator">||</span> orientation <span class="token operator">==</span> OF_ORIENTATION_180 <span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token keyword">return</span> <span class="token punctuation">{</span>desktopMode<span class="token operator">-</span><span class="token operator">></span>width<span class="token operator">*</span>pixelScreenCoordScale<span class="token punctuation">,</span> desktopMode<span class="token operator">-</span><span class="token operator">></span>height<span class="token operator">*</span>pixelScreenCoordScale<span class="token punctuation">}</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
				<span class="token keyword">return</span> <span class="token punctuation">{</span>desktopMode<span class="token operator">-</span><span class="token operator">></span>height<span class="token operator">*</span>pixelScreenCoordScale<span class="token punctuation">,</span> desktopMode<span class="token operator">-</span><span class="token operator">></span>width<span class="token operator">*</span>pixelScreenCoordScale<span class="token punctuation">}</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> glm<span class="token operator">::</span><span class="token function">vec2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">int</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">getWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span> orientation <span class="token operator">==</span> OF_ORIENTATION_DEFAULT <span class="token operator">||</span> orientation <span class="token operator">==</span> OF_ORIENTATION_180 <span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> currentW <span class="token operator">*</span> pixelScreenCoordScale<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> currentH <span class="token operator">*</span> pixelScreenCoordScale<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">int</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">getHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span> orientation <span class="token operator">==</span> OF_ORIENTATION_DEFAULT <span class="token operator">||</span> orientation <span class="token operator">==</span> OF_ORIENTATION_180 <span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> currentH <span class="token operator">*</span> pixelScreenCoordScale<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> currentW <span class="token operator">*</span> pixelScreenCoordScale<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
GLFWwindow<span class="token operator">*</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">getGLFWWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> windowP<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
ofWindowMode ofAppGLFWWindow<span class="token operator">::</span><span class="token function">getWindowMode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> settings<span class="token punctuation">.</span>windowMode<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">setWindowPosition</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">glfwSetWindowPos</span><span class="token punctuation">(</span>windowP<span class="token punctuation">,</span>x<span class="token operator">/</span>pixelScreenCoordScale<span class="token punctuation">,</span>y<span class="token operator">/</span>pixelScreenCoordScale<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">setWindowShape</span><span class="token punctuation">(</span><span class="token keyword">int</span> w<span class="token punctuation">,</span> <span class="token keyword">int</span> h<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>windowMode <span class="token operator">==</span> OF_WINDOW<span class="token punctuation">)</span><span class="token punctuation">{</span>
		windowW <span class="token operator">=</span> w<span class="token punctuation">;</span>
		windowH <span class="token operator">=</span> h<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	currentW <span class="token operator">=</span> w<span class="token operator">/</span>pixelScreenCoordScale<span class="token punctuation">;</span>
	currentH <span class="token operator">=</span> h<span class="token operator">/</span>pixelScreenCoordScale<span class="token punctuation">;</span>

    <span class="token macro property">#<span class="token directive keyword">ifdef</span> TARGET_OSX</span>
	    <span class="token keyword">auto</span> pos <span class="token operator">=</span> <span class="token function">getWindowPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">glfwSetWindowSize</span><span class="token punctuation">(</span>windowP<span class="token punctuation">,</span>currentW<span class="token punctuation">,</span>currentH<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span> pos <span class="token operator">!=</span> <span class="token function">getWindowPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token function">setWindowPosition</span><span class="token punctuation">(</span>pos<span class="token punctuation">.</span>x<span class="token punctuation">,</span> pos<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
    <span class="token macro property">#<span class="token directive keyword">else</span></span>
	    <span class="token function">glfwSetWindowSize</span><span class="token punctuation">(</span>windowP<span class="token punctuation">,</span>currentW<span class="token punctuation">,</span>currentH<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">#<span class="token directive keyword">endif</span></span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">hideCursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>windowMode <span class="token operator">==</span> OF_FULLSCREEN <span class="token operator">||</span> settings<span class="token punctuation">.</span>windowMode <span class="token operator">==</span> OF_GAME_MODE<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">glfwSetInputMode</span><span class="token punctuation">(</span>windowP<span class="token punctuation">,</span>GLFW_CURSOR<span class="token punctuation">,</span>GLFW_CURSOR_DISABLED<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
		<span class="token function">glfwSetInputMode</span><span class="token punctuation">(</span>windowP<span class="token punctuation">,</span>GLFW_CURSOR<span class="token punctuation">,</span>GLFW_CURSOR_HIDDEN<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">showCursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">glfwSetInputMode</span><span class="token punctuation">(</span>windowP<span class="token punctuation">,</span>GLFW_CURSOR<span class="token punctuation">,</span>GLFW_CURSOR_NORMAL<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">enableSetupScreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	bEnableSetupScreen <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">disableSetupScreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	bEnableSetupScreen <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">setFullscreen</span><span class="token punctuation">(</span><span class="token keyword">bool</span> fullscreen<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>fullscreen<span class="token punctuation">)</span><span class="token punctuation">{</span>
		targetWindowMode <span class="token operator">=</span> OF_FULLSCREEN<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
		targetWindowMode <span class="token operator">=</span> OF_WINDOW<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment" spellcheck="true">//we only want to change window mode if the requested window is different to the current one.</span>
	<span class="token keyword">bool</span> bChanged <span class="token operator">=</span> targetWindowMode <span class="token operator">!=</span> settings<span class="token punctuation">.</span>windowMode<span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token operator">!</span>bChanged <span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token macro property">#<span class="token directive keyword">ifdef</span> TARGET_LINUX</span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;X11/Xatom.h></span></span>

	Window nativeWin <span class="token operator">=</span> <span class="token function">glfwGetX11Window</span><span class="token punctuation">(</span>windowP<span class="token punctuation">)</span><span class="token punctuation">;</span>
	Display<span class="token operator">*</span> display <span class="token operator">=</span> <span class="token function">glfwGetX11Display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>targetWindowMode<span class="token operator">==</span>OF_FULLSCREEN<span class="token punctuation">)</span><span class="token punctuation">{</span>
		
<span class="token macro property">#<span class="token directive keyword">ifdef</span> TARGET_RASPBERRY_PI</span>
		<span class="token comment" spellcheck="true">// save window shape before going fullscreen</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span> windowP <span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">int</span> tmpW<span class="token punctuation">,</span> tmpH<span class="token punctuation">;</span>
			<span class="token function">glfwGetWindowSize</span><span class="token punctuation">(</span>windowP<span class="token punctuation">,</span> <span class="token operator">&</span>tmpW<span class="token punctuation">,</span> <span class="token operator">&</span>tmpH<span class="token punctuation">)</span><span class="token punctuation">;</span>
			windowRect<span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span>tmpW<span class="token punctuation">,</span> tmpH<span class="token punctuation">)</span><span class="token punctuation">;</span> 
		<span class="token punctuation">}</span>
<span class="token macro property">#<span class="token directive keyword">endif</span> </span>
		
		<span class="token keyword">int</span> monitorCount<span class="token punctuation">;</span>
		GLFWmonitor<span class="token operator">*</span><span class="token operator">*</span> monitors <span class="token operator">=</span> <span class="token function">glfwGetMonitors</span><span class="token punctuation">(</span><span class="token operator">&</span>monitorCount<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span> settings<span class="token punctuation">.</span>multiMonitorFullScreen <span class="token operator">&&</span> monitorCount <span class="token operator">></span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token comment" spellcheck="true">// find the monitors at the edges of the virtual desktop</span>
			<span class="token keyword">int</span> minx<span class="token operator">=</span>numeric_limits<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">::</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">int</span> miny<span class="token operator">=</span>numeric_limits<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">::</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">int</span> maxx<span class="token operator">=</span>numeric_limits<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">::</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">int</span> maxy<span class="token operator">=</span>numeric_limits<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">::</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">int</span> x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>w<span class="token punctuation">,</span>h<span class="token punctuation">;</span>
			<span class="token keyword">int</span> monitorLeft<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> monitorRight<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> monitorTop<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> monitorBottom<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> monitorCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token function">glfwGetMonitorPos</span><span class="token punctuation">(</span>monitors<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">&</span>x<span class="token punctuation">,</span><span class="token operator">&</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">auto</span> videoMode <span class="token operator">=</span> <span class="token function">glfwGetVideoMode</span><span class="token punctuation">(</span>monitors<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				w <span class="token operator">=</span> videoMode<span class="token operator">-</span><span class="token operator">></span>width<span class="token punctuation">;</span>
				h <span class="token operator">=</span> videoMode<span class="token operator">-</span><span class="token operator">></span>height<span class="token punctuation">;</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">&lt;</span>minx<span class="token punctuation">)</span><span class="token punctuation">{</span>
					monitorLeft <span class="token operator">=</span> i<span class="token punctuation">;</span>
					minx <span class="token operator">=</span> x<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>y<span class="token operator">&lt;</span>miny<span class="token punctuation">)</span><span class="token punctuation">{</span>
					monitorTop <span class="token operator">=</span> i<span class="token punctuation">;</span>
					miny <span class="token operator">=</span> y<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">+</span>w<span class="token operator">></span>maxx<span class="token punctuation">)</span><span class="token punctuation">{</span>
					monitorRight <span class="token operator">=</span> i<span class="token punctuation">;</span>
					maxx <span class="token operator">=</span> x<span class="token operator">+</span>w<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>y<span class="token operator">+</span>h<span class="token operator">></span>maxy<span class="token punctuation">)</span><span class="token punctuation">{</span>
					monitorBottom <span class="token operator">=</span> i<span class="token punctuation">;</span>
					maxy <span class="token operator">=</span> y<span class="token operator">+</span>h<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>

			<span class="token comment" spellcheck="true">// send fullscreen_monitors event with the edges monitors</span>
			Atom m_net_fullscreen_monitors<span class="token operator">=</span> <span class="token function">XInternAtom</span><span class="token punctuation">(</span>display<span class="token punctuation">,</span> <span class="token string">"_NET_WM_FULLSCREEN_MONITORS"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			XEvent xev<span class="token punctuation">;</span>

			xev<span class="token punctuation">.</span>xclient<span class="token punctuation">.</span>type <span class="token operator">=</span> ClientMessage<span class="token punctuation">;</span>
			xev<span class="token punctuation">.</span>xclient<span class="token punctuation">.</span>serial <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			xev<span class="token punctuation">.</span>xclient<span class="token punctuation">.</span>send_event <span class="token operator">=</span> True<span class="token punctuation">;</span>
			xev<span class="token punctuation">.</span>xclient<span class="token punctuation">.</span>window <span class="token operator">=</span> nativeWin<span class="token punctuation">;</span>
			xev<span class="token punctuation">.</span>xclient<span class="token punctuation">.</span>message_type <span class="token operator">=</span> m_net_fullscreen_monitors<span class="token punctuation">;</span>
			xev<span class="token punctuation">.</span>xclient<span class="token punctuation">.</span>format <span class="token operator">=</span> <span class="token number">32</span><span class="token punctuation">;</span>

			xev<span class="token punctuation">.</span>xclient<span class="token punctuation">.</span>data<span class="token punctuation">.</span>l<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> monitorTop<span class="token punctuation">;</span>
			xev<span class="token punctuation">.</span>xclient<span class="token punctuation">.</span>data<span class="token punctuation">.</span>l<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> monitorBottom<span class="token punctuation">;</span>
			xev<span class="token punctuation">.</span>xclient<span class="token punctuation">.</span>data<span class="token punctuation">.</span>l<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> monitorLeft<span class="token punctuation">;</span>
			xev<span class="token punctuation">.</span>xclient<span class="token punctuation">.</span>data<span class="token punctuation">.</span>l<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> monitorRight<span class="token punctuation">;</span>
			xev<span class="token punctuation">.</span>xclient<span class="token punctuation">.</span>data<span class="token punctuation">.</span>l<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
			<span class="token function">XSendEvent</span><span class="token punctuation">(</span>display<span class="token punctuation">,</span> <span class="token function">RootWindow</span><span class="token punctuation">(</span>display<span class="token punctuation">,</span> <span class="token function">DefaultScreen</span><span class="token punctuation">(</span>display<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
			           False<span class="token punctuation">,</span> SubstructureRedirectMask <span class="token operator">|</span> SubstructureNotifyMask<span class="token punctuation">,</span> <span class="token operator">&</span>xev<span class="token punctuation">)</span><span class="token punctuation">;</span>
			currentW <span class="token operator">=</span> maxx <span class="token operator">-</span> minx<span class="token punctuation">;</span>
			currentH <span class="token operator">=</span> maxy <span class="token operator">-</span> minx<span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
			<span class="token keyword">auto</span> monitor <span class="token operator">=</span> <span class="token function">glfwGetWindowMonitor</span><span class="token punctuation">(</span>windowP<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>monitor<span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token keyword">auto</span> videoMode <span class="token operator">=</span> <span class="token function">glfwGetVideoMode</span><span class="token punctuation">(</span>monitor<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>videoMode<span class="token punctuation">)</span><span class="token punctuation">{</span>
					currentW <span class="token operator">=</span> videoMode<span class="token operator">-</span><span class="token operator">></span>width<span class="token punctuation">;</span>
					currentH <span class="token operator">=</span> videoMode<span class="token operator">-</span><span class="token operator">></span>height<span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token comment" spellcheck="true">// send fullscreen event</span>
	Atom m_net_state<span class="token operator">=</span> <span class="token function">XInternAtom</span><span class="token punctuation">(</span>display<span class="token punctuation">,</span> <span class="token string">"_NET_WM_STATE"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	Atom m_net_fullscreen<span class="token operator">=</span> <span class="token function">XInternAtom</span><span class="token punctuation">(</span>display<span class="token punctuation">,</span> <span class="token string">"_NET_WM_STATE_FULLSCREEN"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	XEvent xev<span class="token punctuation">;</span>

	xev<span class="token punctuation">.</span>xclient<span class="token punctuation">.</span>type <span class="token operator">=</span> ClientMessage<span class="token punctuation">;</span>
	xev<span class="token punctuation">.</span>xclient<span class="token punctuation">.</span>serial <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	xev<span class="token punctuation">.</span>xclient<span class="token punctuation">.</span>send_event <span class="token operator">=</span> True<span class="token punctuation">;</span>
	xev<span class="token punctuation">.</span>xclient<span class="token punctuation">.</span>window <span class="token operator">=</span> nativeWin<span class="token punctuation">;</span>
	xev<span class="token punctuation">.</span>xclient<span class="token punctuation">.</span>message_type <span class="token operator">=</span> m_net_state<span class="token punctuation">;</span>
	xev<span class="token punctuation">.</span>xclient<span class="token punctuation">.</span>format <span class="token operator">=</span> <span class="token number">32</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>fullscreen<span class="token punctuation">)</span>
		xev<span class="token punctuation">.</span>xclient<span class="token punctuation">.</span>data<span class="token punctuation">.</span>l<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">else</span>
		xev<span class="token punctuation">.</span>xclient<span class="token punctuation">.</span>data<span class="token punctuation">.</span>l<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	xev<span class="token punctuation">.</span>xclient<span class="token punctuation">.</span>data<span class="token punctuation">.</span>l<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> m_net_fullscreen<span class="token punctuation">;</span>
	xev<span class="token punctuation">.</span>xclient<span class="token punctuation">.</span>data<span class="token punctuation">.</span>l<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	xev<span class="token punctuation">.</span>xclient<span class="token punctuation">.</span>data<span class="token punctuation">.</span>l<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	xev<span class="token punctuation">.</span>xclient<span class="token punctuation">.</span>data<span class="token punctuation">.</span>l<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token function">XSendEvent</span><span class="token punctuation">(</span>display<span class="token punctuation">,</span> <span class="token function">RootWindow</span><span class="token punctuation">(</span>display<span class="token punctuation">,</span> <span class="token function">DefaultScreen</span><span class="token punctuation">(</span>display<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	           False<span class="token punctuation">,</span> SubstructureRedirectMask <span class="token operator">|</span> SubstructureNotifyMask<span class="token punctuation">,</span> <span class="token operator">&</span>xev<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment" spellcheck="true">// tell the window manager to bypass composition for this window in fullscreen for speed</span>
	<span class="token comment" spellcheck="true">// it'll probably help solving vsync issues</span>
	Atom m_bypass_compositor <span class="token operator">=</span> <span class="token function">XInternAtom</span><span class="token punctuation">(</span>display<span class="token punctuation">,</span> <span class="token string">"_NET_WM_BYPASS_COMPOSITOR"</span><span class="token punctuation">,</span> False<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">long</span> value <span class="token operator">=</span> fullscreen <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token function">XChangeProperty</span><span class="token punctuation">(</span>display<span class="token punctuation">,</span> nativeWin<span class="token punctuation">,</span> m_bypass_compositor<span class="token punctuation">,</span> XA_CARDINAL<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> PropModeReplace<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&</span>value<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">XFlush</span><span class="token punctuation">(</span>display<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
<span class="token macro property">#<span class="token directive keyword">ifdef</span> TARGET_RASPBERRY_PI </span>
	<span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token operator">!</span>fullscreen <span class="token punctuation">)</span><span class="token punctuation">{</span>
		needsResizeCheck <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> 
	<span class="token punctuation">}</span>
<span class="token macro property">#<span class="token directive keyword">endif</span> </span>
	
<span class="token comment" spellcheck="true">//	setWindowShape(windowW, windowH);</span>

<span class="token macro property">#<span class="token directive keyword">elif</span> defined(TARGET_OSX)</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span> targetWindowMode <span class="token operator">==</span> OF_FULLSCREEN<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment" spellcheck="true">//----------------------------------------------------</span>
		<span class="token punctuation">[</span>NSApp setPresentationOptions<span class="token operator">:</span>NSApplicationPresentationHideMenuBar <span class="token operator">|</span> NSApplicationPresentationHideDock<span class="token punctuation">]</span><span class="token punctuation">;</span>
		NSWindow <span class="token operator">*</span> cocoaWindow <span class="token operator">=</span> <span class="token function">glfwGetCocoaWindow</span><span class="token punctuation">(</span>windowP<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token punctuation">[</span>cocoaWindow setStyleMask<span class="token operator">:</span>NSBorderlessWindowMask<span class="token punctuation">]</span><span class="token punctuation">;</span>

		<span class="token keyword">int</span> monitorCount<span class="token punctuation">;</span>
		GLFWmonitor<span class="token operator">*</span><span class="token operator">*</span> monitors <span class="token operator">=</span> <span class="token function">glfwGetMonitors</span><span class="token punctuation">(</span><span class="token operator">&</span>monitorCount<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">int</span> currentMonitor <span class="token operator">=</span> <span class="token function">getCurrentMonitor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		ofVec3f screenSize <span class="token operator">=</span> <span class="token function">getScreenSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span><span class="token punctuation">(</span> orientation <span class="token operator">==</span> OF_ORIENTATION_90_LEFT <span class="token operator">||</span> orientation <span class="token operator">==</span> OF_ORIENTATION_90_RIGHT <span class="token punctuation">)</span><span class="token punctuation">{</span>
			std<span class="token operator">::</span><span class="token function">swap</span><span class="token punctuation">(</span>screenSize<span class="token punctuation">.</span>x<span class="token punctuation">,</span> screenSize<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		ofRectangle allScreensSpace<span class="token punctuation">;</span>

		<span class="token comment" spellcheck="true">// save window shape before going fullscreen</span>
		<span class="token keyword">auto</span> pos <span class="token operator">=</span> <span class="token function">getWindowPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">auto</span> size <span class="token operator">=</span> <span class="token function">getWindowSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		windowRect<span class="token punctuation">.</span>x <span class="token operator">=</span> pos<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
		windowRect<span class="token punctuation">.</span>y <span class="token operator">=</span> pos<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
		windowRect<span class="token punctuation">.</span>width <span class="token operator">=</span> size<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
		windowRect<span class="token punctuation">.</span>height <span class="token operator">=</span> size<span class="token punctuation">.</span>y<span class="token punctuation">;</span>

		<span class="token keyword">if</span><span class="token punctuation">(</span> settings<span class="token punctuation">.</span>multiMonitorFullScreen <span class="token operator">&&</span> monitorCount <span class="token operator">></span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>

			<span class="token comment" spellcheck="true">//calc the sum Rect of all the monitors</span>
			<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> monitorCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token keyword">const</span> GLFWvidmode <span class="token operator">*</span> desktopMode <span class="token operator">=</span> <span class="token function">glfwGetVideoMode</span><span class="token punctuation">(</span>monitors<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">int</span> x<span class="token punctuation">,</span> y<span class="token punctuation">;</span>
				<span class="token function">glfwGetMonitorPos</span><span class="token punctuation">(</span>monitors<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&</span>x<span class="token punctuation">,</span> <span class="token operator">&</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
				ofRectangle screen <span class="token operator">=</span> <span class="token function">ofRectangle</span><span class="token punctuation">(</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> desktopMode<span class="token operator">-</span><span class="token operator">></span>width<span class="token punctuation">,</span> desktopMode<span class="token operator">-</span><span class="token operator">></span>height <span class="token punctuation">)</span><span class="token punctuation">;</span>
				allScreensSpace <span class="token operator">=</span> allScreensSpace<span class="token punctuation">.</span><span class="token function">getUnion</span><span class="token punctuation">(</span>screen<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token comment" spellcheck="true">//for OS X we need to set this first as the window size affects the window positon</span>
			<span class="token comment" spellcheck="true">//need to account for the pixel density factor when we're getting the values from glfw</span>
			<span class="token function">setWindowShape</span><span class="token punctuation">(</span>allScreensSpace<span class="token punctuation">.</span>width<span class="token operator">*</span>pixelScreenCoordScale<span class="token punctuation">,</span> allScreensSpace<span class="token punctuation">.</span>height<span class="token operator">*</span>pixelScreenCoordScale<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">setWindowPosition</span><span class="token punctuation">(</span>allScreensSpace<span class="token punctuation">.</span>x<span class="token punctuation">,</span> allScreensSpace<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>monitorCount <span class="token operator">></span> <span class="token number">1</span> <span class="token operator">&&</span> currentMonitor <span class="token operator">&lt;</span> monitorCount<span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">int</span> xpos<span class="token punctuation">;</span>
			<span class="token keyword">int</span> ypos<span class="token punctuation">;</span>
			<span class="token function">glfwGetMonitorPos</span><span class="token punctuation">(</span>monitors<span class="token punctuation">[</span>currentMonitor<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&</span>xpos<span class="token punctuation">,</span> <span class="token operator">&</span>ypos<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token comment" spellcheck="true">// Scale (if needed) to physical pixels size, since setWindowPosition</span>
			<span class="token comment" spellcheck="true">// uses physical pixel dimensions. On HIDPI screens pixelScreenCoordScale</span>
			<span class="token comment" spellcheck="true">// is likely to be 2, on "normal" screens pixelScreenCoordScale will be 1:</span>
			xpos <span class="token operator">*</span><span class="token operator">=</span> pixelScreenCoordScale<span class="token punctuation">;</span>
			ypos <span class="token operator">*</span><span class="token operator">=</span> pixelScreenCoordScale<span class="token punctuation">;</span>

			<span class="token comment" spellcheck="true">//we do this as setWindowShape affects the position of the monitor</span>
			<span class="token comment" spellcheck="true">//normally we would just call setWindowShape first, but on multi monitor you see the window bleed onto the second monitor as it first changes shape and is then repositioned.</span>
			<span class="token comment" spellcheck="true">//this first moves it over in X, does the screen resize and then by calling it again its set correctly in y.</span>
			<span class="token function">setWindowPosition</span><span class="token punctuation">(</span>xpos<span class="token punctuation">,</span> ypos<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">setWindowShape</span><span class="token punctuation">(</span>screenSize<span class="token punctuation">.</span>x<span class="token punctuation">,</span> screenSize<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">setWindowPosition</span><span class="token punctuation">(</span>xpos<span class="token punctuation">,</span> ypos<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
			<span class="token comment" spellcheck="true">//for OS X we need to set this first as the window size affects the window positon</span>
			<span class="token function">setWindowShape</span><span class="token punctuation">(</span>screenSize<span class="token punctuation">.</span>x<span class="token punctuation">,</span> screenSize<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">setWindowPosition</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment" spellcheck="true">// make sure to save current pos if not specified in settings</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span> settings<span class="token punctuation">.</span><span class="token function">isPositionSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
			ofVec3f pos <span class="token operator">=</span> <span class="token function">getWindowPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			settings<span class="token punctuation">.</span><span class="token function">setPosition</span><span class="token punctuation">(</span><span class="token function">ofVec2f</span><span class="token punctuation">(</span>pos<span class="token punctuation">.</span>x<span class="token punctuation">,</span> pos<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment" spellcheck="true">//make sure the window is getting the mouse/key events</span>
		<span class="token punctuation">[</span>cocoaWindow makeFirstResponder<span class="token operator">:</span>cocoaWindow<span class="token punctuation">.</span>contentView<span class="token punctuation">]</span><span class="token punctuation">;</span>

	<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span> targetWindowMode <span class="token operator">==</span> OF_WINDOW <span class="token punctuation">)</span><span class="token punctuation">{</span>

		<span class="token comment" spellcheck="true">// set window shape if started in fullscreen</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>windowRect<span class="token punctuation">.</span>width <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&&</span> windowRect<span class="token punctuation">.</span>height <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			windowRect<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token function">getWindowPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>x<span class="token punctuation">;</span>
			windowRect<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token function">getWindowPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>y<span class="token punctuation">;</span>
			windowRect<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token function">getWindowSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>x<span class="token punctuation">;</span>
			windowRect<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token function">getWindowSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>y<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token punctuation">[</span>NSApp setPresentationOptions<span class="token operator">:</span>NSApplicationPresentationDefault<span class="token punctuation">]</span><span class="token punctuation">;</span>
		NSWindow <span class="token operator">*</span> cocoaWindow <span class="token operator">=</span> <span class="token function">glfwGetCocoaWindow</span><span class="token punctuation">(</span>windowP<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">[</span>cocoaWindow setStyleMask<span class="token operator">:</span>NSTitledWindowMask <span class="token operator">|</span> NSClosableWindowMask <span class="token operator">|</span> NSMiniaturizableWindowMask <span class="token operator">|</span> NSResizableWindowMask<span class="token punctuation">]</span><span class="token punctuation">;</span>

		<span class="token function">setWindowShape</span><span class="token punctuation">(</span>windowRect<span class="token punctuation">.</span>width<span class="token punctuation">,</span> windowRect<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">setWindowTitle</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>title<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment" spellcheck="true">//----------------------------------------------------</span>
		<span class="token comment" spellcheck="true">// if we have recorded the screen position, put it there</span>
		<span class="token comment" spellcheck="true">// if not, better to let the system do it (and put it where it wants)</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ofGetFrameNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token function">setWindowPosition</span><span class="token punctuation">(</span>windowRect<span class="token punctuation">.</span>x<span class="token punctuation">,</span> windowRect<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment" spellcheck="true">//----------------------------------------------------</span>
		<span class="token comment" spellcheck="true">//make sure the window is getting the mouse/key events</span>
		<span class="token punctuation">[</span>cocoaWindow makeFirstResponder<span class="token operator">:</span>cocoaWindow<span class="token punctuation">.</span>contentView<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token macro property">#<span class="token directive keyword">elif</span> defined(TARGET_WIN32)</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span> targetWindowMode <span class="token operator">==</span> OF_FULLSCREEN<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment" spellcheck="true">// save window shape before going fullscreen</span>
		<span class="token keyword">auto</span> pos <span class="token operator">=</span> <span class="token function">getWindowPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">auto</span> size <span class="token operator">=</span> <span class="token function">getWindowSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		windowRect<span class="token punctuation">.</span>x <span class="token operator">=</span> pos<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
		windowRect<span class="token punctuation">.</span>y <span class="token operator">=</span> pos<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
		windowRect<span class="token punctuation">.</span>width <span class="token operator">=</span> size<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
		windowRect<span class="token punctuation">.</span>height <span class="token operator">=</span> size<span class="token punctuation">.</span>y<span class="token punctuation">;</span>

		<span class="token comment" spellcheck="true">//----------------------------------------------------</span>
		HWND hwnd <span class="token operator">=</span> <span class="token function">glfwGetWin32Window</span><span class="token punctuation">(</span>windowP<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token function">SetWindowLong</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> GWL_EXSTYLE<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">SetWindowLong</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> GWL_STYLE<span class="token punctuation">,</span> WS_POPUP <span class="token operator">|</span> WS_CLIPCHILDREN <span class="token operator">|</span> WS_CLIPSIBLINGS<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">SetWindowPos</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> HWND_TOPMOST<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> SWP_NOMOVE <span class="token operator">|</span> SWP_NOSIZE <span class="token operator">|</span> SWP_FRAMECHANGED <span class="token operator">|</span> SWP_SHOWWINDOW<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">float</span> fullscreenW <span class="token operator">=</span> <span class="token function">getScreenSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>x<span class="token punctuation">;</span>
		<span class="token keyword">float</span> fullscreenH <span class="token operator">=</span> <span class="token function">getScreenSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>y<span class="token punctuation">;</span>

		<span class="token keyword">if</span><span class="token punctuation">(</span> orientation <span class="token operator">==</span> OF_ORIENTATION_90_LEFT <span class="token operator">||</span> orientation <span class="token operator">==</span> OF_ORIENTATION_90_RIGHT <span class="token punctuation">)</span><span class="token punctuation">{</span>
			std<span class="token operator">::</span><span class="token function">swap</span><span class="token punctuation">(</span>fullscreenW<span class="token punctuation">,</span> fullscreenH<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">int</span> xpos <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token keyword">int</span> ypos <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span><span class="token punctuation">(</span> settings<span class="token punctuation">.</span>multiMonitorFullScreen <span class="token punctuation">)</span><span class="token punctuation">{</span>

			<span class="token keyword">int</span> minX <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token keyword">int</span> maxX <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token keyword">int</span> minY <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token keyword">int</span> maxY <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token keyword">int</span> monitorCount<span class="token punctuation">;</span>
			GLFWmonitor<span class="token operator">*</span><span class="token operator">*</span> monitors <span class="token operator">=</span> <span class="token function">glfwGetMonitors</span><span class="token punctuation">(</span><span class="token operator">&</span>monitorCount<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">int</span> tempXPos <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token keyword">int</span> tempYPos <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
			<span class="token comment" spellcheck="true">//lets find the total width of all the monitors</span>
			<span class="token comment" spellcheck="true">//and we'll make the window height the height of the largest monitor.</span>
			<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> monitorCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token keyword">const</span> GLFWvidmode <span class="token operator">*</span> desktopMode <span class="token operator">=</span> <span class="token function">glfwGetVideoMode</span><span class="token punctuation">(</span>monitors<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token function">glfwGetMonitorPos</span><span class="token punctuation">(</span>monitors<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&</span>tempXPos<span class="token punctuation">,</span> <span class="token operator">&</span>tempYPos<span class="token punctuation">)</span><span class="token punctuation">;</span>
				minX <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>tempXPos<span class="token punctuation">,</span>minX<span class="token punctuation">)</span><span class="token punctuation">;</span>
				minY <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>tempYPos<span class="token punctuation">,</span>minY<span class="token punctuation">)</span><span class="token punctuation">;</span>
				maxX <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>maxX<span class="token punctuation">,</span>tempXPos <span class="token operator">+</span> desktopMode<span class="token operator">-</span><span class="token operator">></span>width<span class="token punctuation">)</span><span class="token punctuation">;</span>
				maxY <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>maxY<span class="token punctuation">,</span>tempYPos <span class="token operator">+</span> desktopMode<span class="token operator">-</span><span class="token operator">></span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>

				xpos <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>xpos<span class="token punctuation">,</span>tempXPos<span class="token punctuation">)</span><span class="token punctuation">;</span>
				ypos <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>ypos<span class="token punctuation">,</span>tempYPos<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			fullscreenW <span class="token operator">=</span> maxX<span class="token operator">-</span>minX<span class="token punctuation">;</span>
			fullscreenH <span class="token operator">=</span> maxY<span class="token operator">-</span>minY<span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>

			<span class="token keyword">int</span> monitorCount<span class="token punctuation">;</span>
			GLFWmonitor<span class="token operator">*</span><span class="token operator">*</span> monitors <span class="token operator">=</span> <span class="token function">glfwGetMonitors</span><span class="token punctuation">(</span><span class="token operator">&</span>monitorCount<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">int</span> currentMonitor <span class="token operator">=</span> <span class="token function">getCurrentMonitor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">glfwGetMonitorPos</span><span class="token punctuation">(</span>monitors<span class="token punctuation">[</span>currentMonitor<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">&</span>xpos<span class="token punctuation">,</span> <span class="token operator">&</span>ypos<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token punctuation">}</span>

		<span class="token function">SetWindowPos</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> HWND_TOPMOST<span class="token punctuation">,</span> xpos<span class="token punctuation">,</span> ypos<span class="token punctuation">,</span> fullscreenW<span class="token punctuation">,</span> fullscreenH<span class="token punctuation">,</span> SWP_SHOWWINDOW<span class="token punctuation">)</span><span class="token punctuation">;</span>
		currentW <span class="token operator">=</span> fullscreenW<span class="token punctuation">;</span>
		currentH <span class="token operator">=</span> fullscreenH<span class="token punctuation">;</span>

	<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span> targetWindowMode <span class="token operator">==</span> OF_WINDOW <span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment" spellcheck="true">// set window shape if started in fullscreen</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>windowRect<span class="token punctuation">.</span>width <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&&</span> windowRect<span class="token punctuation">.</span>height <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			windowRect<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token function">getWindowPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>x<span class="token punctuation">;</span>
			windowRect<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token function">getWindowPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>y<span class="token punctuation">;</span>
			windowRect<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token function">getWindowSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>x<span class="token punctuation">;</span>
			windowRect<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token function">getWindowSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>y<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		HWND hwnd <span class="token operator">=</span> <span class="token function">glfwGetWin32Window</span><span class="token punctuation">(</span>windowP<span class="token punctuation">)</span><span class="token punctuation">;</span>

		DWORD EX_STYLE <span class="token operator">=</span> WS_EX_OVERLAPPEDWINDOW<span class="token punctuation">;</span>
		DWORD STYLE <span class="token operator">=</span> WS_OVERLAPPED <span class="token operator">|</span> WS_CAPTION <span class="token operator">|</span> WS_SYSMENU <span class="token operator">|</span> WS_MINIMIZEBOX <span class="token operator">|</span> WS_MAXIMIZEBOX <span class="token operator">|</span> WS_CLIPCHILDREN <span class="token operator">|</span> WS_CLIPSIBLINGS <span class="token operator">|</span> WS_SIZEBOX<span class="token punctuation">;</span>

		<span class="token function">ChangeDisplaySettings</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">SetWindowLong</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> GWL_EXSTYLE<span class="token punctuation">,</span> EX_STYLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">SetWindowLong</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> GWL_STYLE<span class="token punctuation">,</span> STYLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">SetWindowPos</span><span class="token punctuation">(</span>hwnd<span class="token punctuation">,</span> HWND_NOTOPMOST<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> SWP_NOMOVE <span class="token operator">|</span> SWP_NOSIZE <span class="token operator">|</span> SWP_FRAMECHANGED <span class="token operator">|</span> SWP_SHOWWINDOW<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment" spellcheck="true">//not sure why this is - but if we don't do this the window shrinks by 4 pixels in x and y</span>
		<span class="token comment" spellcheck="true">//should look for a better fix.</span>
		<span class="token function">setWindowPosition</span><span class="token punctuation">(</span>windowRect<span class="token punctuation">.</span>x<span class="token number">-2</span><span class="token punctuation">,</span> windowRect<span class="token punctuation">.</span>y<span class="token number">-2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">setWindowShape</span><span class="token punctuation">(</span>windowRect<span class="token punctuation">.</span>width<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">,</span> windowRect<span class="token punctuation">.</span>height<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>

	settings<span class="token punctuation">.</span>windowMode <span class="token operator">=</span> targetWindowMode<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">toggleFullscreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>settings<span class="token punctuation">.</span>windowMode <span class="token operator">==</span> OF_GAME_MODE<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>


	<span class="token keyword">if</span> <span class="token punctuation">(</span>settings<span class="token punctuation">.</span>windowMode <span class="token operator">==</span> OF_WINDOW<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">setFullscreen</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		<span class="token function">setFullscreen</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">setOrientation</span><span class="token punctuation">(</span>ofOrientation orientation<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token operator">-</span><span class="token operator">></span>orientation <span class="token operator">=</span> orientation<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
ofOrientation ofAppGLFWWindow<span class="token operator">::</span><span class="token function">getOrientation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> orientation<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">rotateMouseXY</span><span class="token punctuation">(</span>ofOrientation orientation<span class="token punctuation">,</span> <span class="token keyword">int</span> w<span class="token punctuation">,</span> <span class="token keyword">int</span> h<span class="token punctuation">,</span> <span class="token keyword">double</span> <span class="token operator">&</span>x<span class="token punctuation">,</span> <span class="token keyword">double</span> <span class="token operator">&</span>y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">int</span> savedY<span class="token punctuation">;</span>
	<span class="token keyword">switch</span><span class="token punctuation">(</span>orientation<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">case</span> OF_ORIENTATION_180<span class="token operator">:</span>
			x <span class="token operator">=</span> w <span class="token operator">-</span> x<span class="token punctuation">;</span>
			y <span class="token operator">=</span> h <span class="token operator">-</span> y<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>

		<span class="token keyword">case</span> OF_ORIENTATION_90_RIGHT<span class="token operator">:</span>
			savedY <span class="token operator">=</span> y<span class="token punctuation">;</span>
			y <span class="token operator">=</span> x<span class="token punctuation">;</span>
			x <span class="token operator">=</span> w<span class="token operator">-</span>savedY<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>

		<span class="token keyword">case</span> OF_ORIENTATION_90_LEFT<span class="token operator">:</span>
			savedY <span class="token operator">=</span> y<span class="token punctuation">;</span>
			y <span class="token operator">=</span> h <span class="token operator">-</span> x<span class="token punctuation">;</span>
			x <span class="token operator">=</span> savedY<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>

		<span class="token keyword">case</span> OF_ORIENTATION_DEFAULT<span class="token operator">:</span>
		<span class="token keyword">default</span><span class="token operator">:</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
ofAppGLFWWindow <span class="token operator">*</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">setCurrent</span><span class="token punctuation">(</span>GLFWwindow<span class="token operator">*</span> windowP<span class="token punctuation">)</span><span class="token punctuation">{</span>
	ofAppGLFWWindow <span class="token operator">*</span> instance <span class="token operator">=</span> <span class="token keyword">static_cast</span><span class="token operator">&lt;</span>ofAppGLFWWindow <span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token function">glfwGetWindowUserPointer</span><span class="token punctuation">(</span>windowP<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	shared_ptr<span class="token operator">&lt;</span>ofMainLoop<span class="token operator">></span> mainLoop <span class="token operator">=</span> <span class="token function">ofGetMainLoop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>mainLoop<span class="token punctuation">)</span><span class="token punctuation">{</span>
		mainLoop<span class="token operator">-</span><span class="token operator">></span><span class="token function">setCurrentWindow</span><span class="token punctuation">(</span>instance<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	instance<span class="token operator">-</span><span class="token operator">></span><span class="token function">makeCurrent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> instance<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">namespace</span><span class="token punctuation">{</span>
<span class="token keyword">int</span> <span class="token function">glfwtToOFModifiers</span><span class="token punctuation">(</span><span class="token keyword">int</span> mods<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> modifiers <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>mods <span class="token operator">&</span> GLFW_MOD_SHIFT<span class="token punctuation">)</span><span class="token punctuation">{</span>
		modifiers <span class="token operator">|</span><span class="token operator">=</span> OF_KEY_SHIFT<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>mods <span class="token operator">&</span> GLFW_MOD_ALT<span class="token punctuation">)</span><span class="token punctuation">{</span>
		modifiers <span class="token operator">|</span><span class="token operator">=</span> OF_KEY_ALT<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>mods <span class="token operator">&</span> GLFW_MOD_CONTROL<span class="token punctuation">)</span><span class="token punctuation">{</span>
		modifiers <span class="token operator">|</span><span class="token operator">=</span> OF_KEY_CONTROL<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>mods <span class="token operator">&</span> GLFW_MOD_SUPER<span class="token punctuation">)</span><span class="token punctuation">{</span>
		modifiers <span class="token operator">|</span><span class="token operator">=</span> OF_KEY_SUPER<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> modifiers<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token function">keycodeToUnicode</span><span class="token punctuation">(</span>ofAppGLFWWindow <span class="token operator">*</span> window<span class="token punctuation">,</span> <span class="token keyword">int</span> scancode<span class="token punctuation">,</span> <span class="token keyword">int</span> modifier<span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token macro property">#<span class="token directive keyword">ifdef</span> TARGET_LINUX</span>
	XkbStateRec xkb_state <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token function">XkbGetState</span><span class="token punctuation">(</span>window<span class="token operator">-</span><span class="token operator">></span><span class="token function">getX11Display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> XkbUseCoreKbd<span class="token punctuation">,</span> <span class="token operator">&</span>xkb_state<span class="token punctuation">)</span><span class="token punctuation">;</span>
	XEvent ev <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	ev<span class="token punctuation">.</span>xkey<span class="token punctuation">.</span>keycode <span class="token operator">=</span> scancode<span class="token punctuation">;</span>
	ev<span class="token punctuation">.</span>xkey<span class="token punctuation">.</span>state <span class="token operator">=</span> xkb_state<span class="token punctuation">.</span>mods <span class="token operator">&</span> <span class="token operator">~</span>ControlMask<span class="token punctuation">;</span>
	ev<span class="token punctuation">.</span>xkey<span class="token punctuation">.</span>display <span class="token operator">=</span> window<span class="token operator">-</span><span class="token operator">></span><span class="token function">getX11Display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	ev<span class="token punctuation">.</span>xkey<span class="token punctuation">.</span>type <span class="token operator">=</span> KeyPress<span class="token punctuation">;</span>
	KeySym keysym <span class="token operator">=</span> NoSymbol<span class="token punctuation">;</span>
	<span class="token keyword">int</span> status<span class="token punctuation">;</span>
	<span class="token keyword">char</span> buffer<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span><span class="token operator">*</span> chars <span class="token operator">=</span> buffer<span class="token punctuation">;</span>
	<span class="token keyword">auto</span> count <span class="token operator">=</span> <span class="token function">Xutf8LookupString</span><span class="token punctuation">(</span>window<span class="token operator">-</span><span class="token operator">></span><span class="token function">getX11XIC</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&</span>ev<span class="token punctuation">.</span>xkey<span class="token punctuation">,</span> chars<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&</span>keysym<span class="token punctuation">,</span> <span class="token operator">&</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>count <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&&</span> <span class="token punctuation">(</span>status <span class="token operator">==</span> XLookupChars <span class="token operator">||</span> status <span class="token operator">==</span> XLookupBoth<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> status <span class="token operator">==</span> XLookupKeySym<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span> c <span class="token operator">=</span> <span class="token operator">&</span>chars<span class="token punctuation">;</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">int</span> ch <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> offsets<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span>
		<span class="token punctuation">{</span>
		    <span class="token number">0x00000000u</span><span class="token punctuation">,</span> <span class="token number">0x00003080u</span><span class="token punctuation">,</span> <span class="token number">0x000e2080u</span><span class="token punctuation">,</span>
		    <span class="token number">0x03c82080u</span><span class="token punctuation">,</span> <span class="token number">0xfa082080u</span><span class="token punctuation">,</span> <span class="token number">0x82082080u</span>
		<span class="token punctuation">}</span><span class="token punctuation">;</span>

		<span class="token keyword">do</span>
		<span class="token punctuation">{</span>
			ch <span class="token operator">=</span> <span class="token punctuation">(</span>ch <span class="token operator">&lt;&lt;</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token operator">*</span><span class="token operator">*</span>c<span class="token punctuation">;</span>
			<span class="token punctuation">(</span><span class="token operator">*</span>c<span class="token punctuation">)</span><span class="token operator">++</span><span class="token punctuation">;</span>
			count<span class="token operator">++</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token operator">*</span>c <span class="token operator">&</span> <span class="token number">0xc0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0x80</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">if</span><span class="token punctuation">(</span>count<span class="token operator">></span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> ch <span class="token operator">-</span> offsets<span class="token punctuation">[</span>count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
<span class="token macro property">#<span class="token directive keyword">ifdef</span> TARGET_WIN32</span>
	<span class="token keyword">static</span> WCHAR buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">static</span> BYTE keyboardState<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token function">GetKeyboardState</span><span class="token punctuation">(</span> keyboardState <span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment" spellcheck="true">// Careful: keycode arrives translated into GLFW key codes,</span>
	<span class="token comment" spellcheck="true">// but keycode needs to be a virtual key (VK_...) so we're</span>
	<span class="token comment" spellcheck="true">// in deep troble, since this information has been removed</span>
	<span class="token comment" spellcheck="true">// by GLFW...</span>
	<span class="token comment" spellcheck="true">//</span>
	<span class="token comment" spellcheck="true">// The way around this is to ask the operating system</span>
	<span class="token comment" spellcheck="true">// nicely to create a virtual key for us, based on</span>
	<span class="token comment" spellcheck="true">// the scancode and the currently bound keyboard layout.</span>
	<span class="token comment" spellcheck="true">// https://msdn.microsoft.com/en-us/library/windows/desktop/ms646306(v=vs.85).aspx</span>
	<span class="token comment" spellcheck="true">//</span>
	<span class="token comment" spellcheck="true">// create a "fake" virtual key</span>

	UINT fakeVirtualKey <span class="token operator">=</span> <span class="token function">MapVirtualKey</span><span class="token punctuation">(</span> scancode<span class="token punctuation">,</span> MAPVK_VSC_TO_VK_EX <span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token function">ToUnicode</span><span class="token punctuation">(</span> fakeVirtualKey<span class="token punctuation">,</span> scancode<span class="token punctuation">,</span> keyboardState<span class="token punctuation">,</span> buf <span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span> ret <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>
<span class="token macro property">#<span class="token directive keyword">ifdef</span> TARGET_OSX</span>
	<span class="token keyword">static</span> UInt32 deadKeyState <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">static</span> UniChar characters<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">static</span> UniCharCount characterCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token keyword">typedef</span> <span class="token keyword">struct</span> __TISInputSource<span class="token operator">*</span>  TISInputSourceRef<span class="token punctuation">;</span>
	<span class="token keyword">typedef</span> <span class="token function">TISInputSourceRef</span> <span class="token punctuation">(</span><span class="token operator">*</span>pFnGetInputSource<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// define function pointer that may return a input source ref, no arguments</span>
	<span class="token keyword">typedef</span> <span class="token keyword">void</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token operator">*</span>pFnGetInputSourceProperty<span class="token punctuation">)</span><span class="token punctuation">(</span>TISInputSourceRef<span class="token punctuation">,</span>CFStringRef<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">typedef</span> <span class="token function">UInt8</span> <span class="token punctuation">(</span><span class="token operator">*</span>pFnGetKeyboardType<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">static</span> <span class="token keyword">const</span> CFBundleRef tisBundle <span class="token operator">=</span> <span class="token function">CFBundleGetBundleWithIdentifier</span><span class="token punctuation">(</span><span class="token function">CFSTR</span><span class="token punctuation">(</span><span class="token string">"com.apple.HIToolbox"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment" spellcheck="true">// We need to call some system methods, following GLFW's example</span>
	<span class="token comment" spellcheck="true">// in their OS X version of ```_glfwPlatformGetKeyName```.</span>
	<span class="token comment" spellcheck="true">//</span>
	<span class="token comment" spellcheck="true">// We know these methods must be available, since GLFW uses them</span>
	<span class="token comment" spellcheck="true">// internally.</span>
	<span class="token comment" spellcheck="true">//</span>
	<span class="token comment" spellcheck="true">// The most important method is ```UCKeyTranslate``` - everything</span>
	<span class="token comment" spellcheck="true">// else here is just a royal preparation party to feed it with the</span>
	<span class="token comment" spellcheck="true">// correct parameters.</span>
	<span class="token comment" spellcheck="true">//</span>
	<span class="token comment" spellcheck="true">// Since these methods are hidden deep within Carbon,</span>
	<span class="token comment" spellcheck="true">// we have to first request function pointers to make</span>
	<span class="token comment" spellcheck="true">// them callable.</span>
	<span class="token comment" spellcheck="true">//</span>
	<span class="token comment" spellcheck="true">// We do this only the first time, then we're re-using them,</span>
	<span class="token comment" spellcheck="true">// that's why these elements are marked static, and static const.</span>
	<span class="token comment" spellcheck="true">//</span>
	<span class="token keyword">static</span> pFnGetInputSource         getInputSource         <span class="token operator">=</span> <span class="token punctuation">(</span>pFnGetInputSource<span class="token punctuation">)</span><span class="token function">CFBundleGetFunctionPointerForName</span><span class="token punctuation">(</span>tisBundle<span class="token punctuation">,</span> <span class="token function">CFSTR</span><span class="token punctuation">(</span><span class="token string">"TISCopyCurrentKeyboardLayoutInputSource"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">static</span> pFnGetKeyboardType        getKeyboardType        <span class="token operator">=</span> <span class="token punctuation">(</span>pFnGetKeyboardType<span class="token punctuation">)</span><span class="token function">CFBundleGetFunctionPointerForName</span><span class="token punctuation">(</span>tisBundle<span class="token punctuation">,</span><span class="token function">CFSTR</span><span class="token punctuation">(</span><span class="token string">"LMGetKbdType"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">static</span> pFnGetInputSourceProperty getInputSourceProperty <span class="token operator">=</span> <span class="token punctuation">(</span>pFnGetInputSourceProperty<span class="token punctuation">)</span><span class="token function">CFBundleGetFunctionPointerForName</span><span class="token punctuation">(</span>tisBundle<span class="token punctuation">,</span> <span class="token function">CFSTR</span><span class="token punctuation">(</span><span class="token string">"TISGetInputSourceProperty"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">static</span> <span class="token keyword">const</span> TISInputSourceRef sourceRef <span class="token operator">=</span> <span class="token function">getInputSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// note that for the first time, this creates a copy on the heap, then we're re-using it.</span>

	<span class="token keyword">static</span> <span class="token keyword">const</span> CFStringRef<span class="token operator">*</span> kPropertyUnicodeKeyLayoutData <span class="token operator">=</span> <span class="token punctuation">(</span>CFStringRef<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">CFBundleGetDataPointerForName</span><span class="token punctuation">(</span>tisBundle<span class="token punctuation">,</span> <span class="token function">CFSTR</span><span class="token punctuation">(</span><span class="token string">"kTISPropertyUnicodeKeyLayoutData"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">static</span> <span class="token keyword">const</span> CFStringRef kTISPropertyUnicodeKeyLayoutData <span class="token operator">=</span> <span class="token operator">*</span> kPropertyUnicodeKeyLayoutData<span class="token punctuation">;</span>
	<span class="token keyword">static</span> <span class="token keyword">const</span> CFDataRef UnicodeKeyLayoutData <span class="token operator">=</span> <span class="token punctuation">(</span>CFDataRef<span class="token punctuation">)</span><span class="token function">getInputSourceProperty</span><span class="token punctuation">(</span>sourceRef<span class="token punctuation">,</span> kTISPropertyUnicodeKeyLayoutData<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">static</span> <span class="token keyword">const</span> UCKeyboardLayout<span class="token operator">*</span> pKeyboardLayout <span class="token operator">=</span> <span class="token punctuation">(</span>UCKeyboardLayout<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">CFDataGetBytePtr</span><span class="token punctuation">(</span>UnicodeKeyLayoutData<span class="token punctuation">)</span><span class="token punctuation">;</span>

	UInt32 mod_OSX <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">{</span>
		<span class="token comment" spellcheck="true">// We have to translate the GLFW modifier bitflags back to OS X,</span>
		<span class="token comment" spellcheck="true">// so that SHIFT, CONTROL, etc can be taken into account when</span>
		<span class="token comment" spellcheck="true">// calculating the unicode codepoint.</span>

		<span class="token comment" spellcheck="true">// UCKeyTranslate expects the Carbon-era modifier mask values,</span>
		<span class="token comment" spellcheck="true">// so use these instead of the NSEventModifierFlag enums</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>modifier <span class="token operator">&</span> GLFW_MOD_SHIFT<span class="token punctuation">)</span>
			mod_OSX <span class="token operator">|</span><span class="token operator">=</span> <span class="token number">512</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Carbon shiftKey value</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>modifier <span class="token operator">&</span> GLFW_MOD_CONTROL<span class="token punctuation">)</span>
			mod_OSX <span class="token operator">|</span><span class="token operator">=</span> <span class="token number">4096</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Carbon controlKey value</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>modifier <span class="token operator">&</span> GLFW_MOD_ALT<span class="token punctuation">)</span>
			mod_OSX <span class="token operator">|</span><span class="token operator">=</span> <span class="token number">2048</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Carbon optionKey value</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>modifier <span class="token operator">&</span> GLFW_MOD_SUPER<span class="token punctuation">)</span>
			mod_OSX <span class="token operator">|</span><span class="token operator">=</span> <span class="token number">256</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Carbon cmdKey</span>

		<span class="token comment" spellcheck="true">// shift into 1 byte as per the Apple docs</span>
		mod_OSX <span class="token operator">=</span> <span class="token punctuation">(</span>mod_OSX <span class="token operator">>></span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&</span> <span class="token number">0xFF</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment" spellcheck="true">// All this yak shaving was necessary to feed this diva of a function call:</span>
	<span class="token comment" spellcheck="true">// https://developer.apple.com/library/mac/documentation/Carbon/Reference/Unicode_Utilities_Ref/index.html#//apple_ref/c/func/UCKeyTranslate</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>noErr <span class="token operator">==</span> <span class="token function">UCKeyTranslate</span><span class="token punctuation">(</span>pKeyboardLayout<span class="token punctuation">,</span>
	                   scancode<span class="token punctuation">,</span>
	                   kUCKeyActionDisplay<span class="token punctuation">,</span>
	                   mod_OSX<span class="token punctuation">,</span>
	                   <span class="token function">getKeyboardType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	                   kUCKeyTranslateNoDeadKeysBit<span class="token punctuation">,</span>
	                   <span class="token operator">&</span>deadKeyState<span class="token punctuation">,</span>
	                   <span class="token keyword">sizeof</span><span class="token punctuation">(</span>characters<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>characters<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	                   <span class="token operator">&</span>characterCount<span class="token punctuation">,</span>
	                   characters<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token comment" spellcheck="true">// if successful, first character contains codepoint</span>
		<span class="token keyword">return</span> characters<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token macro property">#<span class="token directive keyword">endif</span></span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">mouse_cb</span><span class="token punctuation">(</span>GLFWwindow<span class="token operator">*</span> windowP_<span class="token punctuation">,</span> <span class="token keyword">int</span> button<span class="token punctuation">,</span> <span class="token keyword">int</span> state<span class="token punctuation">,</span> <span class="token keyword">int</span> mods<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	ofAppGLFWWindow <span class="token operator">*</span> instance <span class="token operator">=</span> <span class="token function">setCurrent</span><span class="token punctuation">(</span>windowP_<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token macro property">#<span class="token directive keyword">ifdef</span> TARGET_OSX</span>
	<span class="token comment" spellcheck="true">//we do this as unlike glut, glfw doesn't report right click for ctrl click or middle click for alt click</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span> instance<span class="token operator">-</span><span class="token operator">></span><span class="token function">events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getKeyPressed</span><span class="token punctuation">(</span>OF_KEY_CONTROL<span class="token punctuation">)</span> <span class="token operator">&&</span> button <span class="token operator">==</span> GLFW_MOUSE_BUTTON_LEFT<span class="token punctuation">)</span><span class="token punctuation">{</span>
		button <span class="token operator">=</span> GLFW_MOUSE_BUTTON_RIGHT<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span> instance<span class="token operator">-</span><span class="token operator">></span><span class="token function">events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getKeyPressed</span><span class="token punctuation">(</span>OF_KEY_ALT<span class="token punctuation">)</span> <span class="token operator">&&</span> button <span class="token operator">==</span> GLFW_MOUSE_BUTTON_LEFT<span class="token punctuation">)</span><span class="token punctuation">{</span>
		button <span class="token operator">=</span> GLFW_MOUSE_BUTTON_MIDDLE<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>

	<span class="token keyword">switch</span><span class="token punctuation">(</span>button<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">case</span> GLFW_MOUSE_BUTTON_LEFT<span class="token operator">:</span>
		button <span class="token operator">=</span> OF_MOUSE_BUTTON_LEFT<span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> GLFW_MOUSE_BUTTON_RIGHT<span class="token operator">:</span>
		button <span class="token operator">=</span> OF_MOUSE_BUTTON_RIGHT<span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token keyword">case</span> GLFW_MOUSE_BUTTON_MIDDLE<span class="token operator">:</span>
		button <span class="token operator">=</span> OF_MOUSE_BUTTON_MIDDLE<span class="token punctuation">;</span>
		<span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	instance<span class="token operator">-</span><span class="token operator">></span>buttonInUse <span class="token operator">=</span> button<span class="token punctuation">;</span>


	ofMouseEventArgs<span class="token operator">::</span>Type action<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>state <span class="token operator">==</span> GLFW_PRESS<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		action <span class="token operator">=</span> ofMouseEventArgs<span class="token operator">::</span>Pressed<span class="token punctuation">;</span>
		instance<span class="token operator">-</span><span class="token operator">></span>buttonPressed<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		action <span class="token operator">=</span> ofMouseEventArgs<span class="token operator">::</span>Released<span class="token punctuation">;</span>
		instance<span class="token operator">-</span><span class="token operator">></span>buttonPressed<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">int</span> modifiers <span class="token operator">=</span> <span class="token function">glfwtToOFModifiers</span><span class="token punctuation">(</span>mods<span class="token punctuation">)</span><span class="token punctuation">;</span>

	ofMouseEventArgs <span class="token function">args</span><span class="token punctuation">(</span>action<span class="token punctuation">,</span> instance<span class="token operator">-</span><span class="token operator">></span><span class="token function">events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMouseX</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> instance<span class="token operator">-</span><span class="token operator">></span><span class="token function">events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMouseY</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> button<span class="token punctuation">,</span> modifiers<span class="token punctuation">)</span><span class="token punctuation">;</span>

	instance<span class="token operator">-</span><span class="token operator">></span><span class="token function">events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">notifyMouseEvent</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">motion_cb</span><span class="token punctuation">(</span>GLFWwindow<span class="token operator">*</span> windowP_<span class="token punctuation">,</span> <span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">double</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	ofAppGLFWWindow <span class="token operator">*</span> instance <span class="token operator">=</span> <span class="token function">setCurrent</span><span class="token punctuation">(</span>windowP_<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">rotateMouseXY</span><span class="token punctuation">(</span>instance<span class="token operator">-</span><span class="token operator">></span>orientation<span class="token punctuation">,</span> instance<span class="token operator">-</span><span class="token operator">></span><span class="token function">getWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> instance<span class="token operator">-</span><span class="token operator">></span><span class="token function">getHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>

	ofMouseEventArgs<span class="token operator">::</span>Type action<span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>instance<span class="token operator">-</span><span class="token operator">></span>buttonPressed<span class="token punctuation">)</span><span class="token punctuation">{</span>
		action <span class="token operator">=</span> ofMouseEventArgs<span class="token operator">::</span>Moved<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
		action <span class="token operator">=</span> ofMouseEventArgs<span class="token operator">::</span>Dragged<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	ofMouseEventArgs <span class="token function">args</span><span class="token punctuation">(</span>action<span class="token punctuation">,</span>
	    x<span class="token operator">*</span>instance<span class="token operator">-</span><span class="token operator">></span>pixelScreenCoordScale<span class="token punctuation">,</span>
	    y<span class="token operator">*</span>instance<span class="token operator">-</span><span class="token operator">></span>pixelScreenCoordScale<span class="token punctuation">,</span>
	    instance<span class="token operator">-</span><span class="token operator">></span>buttonInUse<span class="token punctuation">,</span>
	    instance<span class="token operator">-</span><span class="token operator">></span><span class="token function">events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getModifiers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	instance<span class="token operator">-</span><span class="token operator">></span><span class="token function">events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">notifyMouseEvent</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">entry_cb</span><span class="token punctuation">(</span>GLFWwindow <span class="token operator">*</span>windowP_<span class="token punctuation">,</span> <span class="token keyword">int</span> entered<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	ofAppGLFWWindow <span class="token operator">*</span> instance <span class="token operator">=</span> <span class="token function">setCurrent</span><span class="token punctuation">(</span>windowP_<span class="token punctuation">)</span><span class="token punctuation">;</span>
	ofMouseEventArgs<span class="token operator">::</span>Type action<span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>entered<span class="token punctuation">)</span><span class="token punctuation">{</span>
		action <span class="token operator">=</span> ofMouseEventArgs<span class="token operator">::</span>Entered<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
		action <span class="token operator">=</span> ofMouseEventArgs<span class="token operator">::</span>Exited<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	ofMouseEventArgs <span class="token function">args</span><span class="token punctuation">(</span>action<span class="token punctuation">,</span>
	    instance<span class="token operator">-</span><span class="token operator">></span><span class="token function">events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMouseX</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	    instance<span class="token operator">-</span><span class="token operator">></span><span class="token function">events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMouseY</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	    instance<span class="token operator">-</span><span class="token operator">></span>buttonInUse<span class="token punctuation">,</span>
	    instance<span class="token operator">-</span><span class="token operator">></span><span class="token function">events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getModifiers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	instance<span class="token operator">-</span><span class="token operator">></span><span class="token function">events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">notifyMouseEvent</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">scroll_cb</span><span class="token punctuation">(</span>GLFWwindow<span class="token operator">*</span> windowP_<span class="token punctuation">,</span> <span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">double</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	ofAppGLFWWindow <span class="token operator">*</span> instance <span class="token operator">=</span> <span class="token function">setCurrent</span><span class="token punctuation">(</span>windowP_<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">rotateMouseXY</span><span class="token punctuation">(</span>instance<span class="token operator">-</span><span class="token operator">></span>orientation<span class="token punctuation">,</span> instance<span class="token operator">-</span><span class="token operator">></span><span class="token function">getWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> instance<span class="token operator">-</span><span class="token operator">></span><span class="token function">getHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>

	ofMouseEventArgs <span class="token function">args</span><span class="token punctuation">(</span>ofMouseEventArgs<span class="token operator">::</span>Scrolled<span class="token punctuation">,</span>
	    instance<span class="token operator">-</span><span class="token operator">></span><span class="token function">events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMouseX</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	    instance<span class="token operator">-</span><span class="token operator">></span><span class="token function">events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMouseY</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	    instance<span class="token operator">-</span><span class="token operator">></span>buttonInUse<span class="token punctuation">,</span>
	    instance<span class="token operator">-</span><span class="token operator">></span><span class="token function">events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getModifiers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	args<span class="token punctuation">.</span>scrollX <span class="token operator">=</span> x<span class="token punctuation">;</span>
	args<span class="token punctuation">.</span>scrollY <span class="token operator">=</span> y<span class="token punctuation">;</span>
	instance<span class="token operator">-</span><span class="token operator">></span><span class="token function">events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">notifyMouseEvent</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">drop_cb</span><span class="token punctuation">(</span>GLFWwindow<span class="token operator">*</span> windowP_<span class="token punctuation">,</span> <span class="token keyword">int</span> numFiles<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">*</span> dropString<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	ofAppGLFWWindow <span class="token operator">*</span> instance <span class="token operator">=</span> <span class="token function">setCurrent</span><span class="token punctuation">(</span>windowP_<span class="token punctuation">)</span><span class="token punctuation">;</span>
	ofDragInfo drag<span class="token punctuation">;</span>
	drag<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token punctuation">{</span>instance<span class="token operator">-</span><span class="token operator">></span><span class="token function">events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMouseX</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> instance<span class="token operator">-</span><span class="token operator">></span><span class="token function">events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMouseY</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	drag<span class="token punctuation">.</span>files<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span>numFiles<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>drag<span class="token punctuation">.</span>files<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		drag<span class="token punctuation">.</span>files<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> std<span class="token operator">::</span>filesystem<span class="token operator">::</span><span class="token function">path</span><span class="token punctuation">(</span>dropString<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	instance<span class="token operator">-</span><span class="token operator">></span><span class="token function">events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">notifyDragEvent</span><span class="token punctuation">(</span>drag<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">error_cb</span><span class="token punctuation">(</span><span class="token keyword">int</span> errorCode<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> errorDescription<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">ofLogError</span><span class="token punctuation">(</span><span class="token string">"ofAppGLFWWindow"</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> errorCode <span class="token operator">&lt;&lt;</span> <span class="token string">": "</span> <span class="token operator">&lt;&lt;</span> errorDescription<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">keyboard_cb</span><span class="token punctuation">(</span>GLFWwindow<span class="token operator">*</span> windowP_<span class="token punctuation">,</span> <span class="token keyword">int</span> keycode<span class="token punctuation">,</span> <span class="token keyword">int</span> scancode<span class="token punctuation">,</span> <span class="token keyword">int</span> action<span class="token punctuation">,</span> <span class="token keyword">int</span> mods<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">int</span> key <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	uint32_t codepoint <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	ofAppGLFWWindow <span class="token operator">*</span> instance <span class="token operator">=</span> <span class="token function">setCurrent</span><span class="token punctuation">(</span>windowP_<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">switch</span> <span class="token punctuation">(</span>keycode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">case</span> GLFW_KEY_ESCAPE<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_ESC<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_F1<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_F1<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_F2<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_F2<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_F3<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_F3<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_F4<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_F4<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_F5<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_F5<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_F6<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_F6<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_F7<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_F7<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_F8<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_F8<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_F9<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_F9<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_F10<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_F10<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_F11<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_F11<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_F12<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_F12<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_LEFT<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_LEFT<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_RIGHT<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_RIGHT<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_UP<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_UP<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_DOWN<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_DOWN<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_PAGE_UP<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_PAGE_UP<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_PAGE_DOWN<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_PAGE_DOWN<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_HOME<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_HOME<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_END<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_END<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_INSERT<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_INSERT<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_LEFT_SHIFT<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_LEFT_SHIFT<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_LEFT_CONTROL<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_LEFT_CONTROL<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_LEFT_ALT<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_LEFT_ALT<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_LEFT_SUPER<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_LEFT_SUPER<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_RIGHT_SHIFT<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_RIGHT_SHIFT<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_RIGHT_CONTROL<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_RIGHT_CONTROL<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_RIGHT_ALT<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_RIGHT_ALT<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_RIGHT_SUPER<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_RIGHT_SUPER<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_BACKSPACE<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_BACKSPACE<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_DELETE<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_DEL<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_ENTER<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_RETURN<span class="token punctuation">;</span>
			codepoint <span class="token operator">=</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_KP_ENTER<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_RETURN<span class="token punctuation">;</span>
			codepoint <span class="token operator">=</span> <span class="token string">'\n'</span><span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_TAB<span class="token operator">:</span>
			key <span class="token operator">=</span> OF_KEY_TAB<span class="token punctuation">;</span>
			codepoint <span class="token operator">=</span> <span class="token string">'\t'</span><span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_KP_0<span class="token operator">:</span>
			key <span class="token operator">=</span> codepoint <span class="token operator">=</span> <span class="token string">'0'</span><span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_KP_1<span class="token operator">:</span>
			key <span class="token operator">=</span> codepoint <span class="token operator">=</span> <span class="token string">'1'</span><span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_KP_2<span class="token operator">:</span>
			key <span class="token operator">=</span> codepoint <span class="token operator">=</span> <span class="token string">'2'</span><span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_KP_3<span class="token operator">:</span>
			key <span class="token operator">=</span> codepoint <span class="token operator">=</span> <span class="token string">'3'</span><span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_KP_4<span class="token operator">:</span>
			key <span class="token operator">=</span> codepoint <span class="token operator">=</span> <span class="token string">'4'</span><span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_KP_5<span class="token operator">:</span>
			key <span class="token operator">=</span> codepoint <span class="token operator">=</span> <span class="token string">'5'</span><span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_KP_6<span class="token operator">:</span>
			key <span class="token operator">=</span> codepoint <span class="token operator">=</span> <span class="token string">'6'</span><span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_KP_7<span class="token operator">:</span>
			key <span class="token operator">=</span> codepoint <span class="token operator">=</span> <span class="token string">'7'</span><span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_KP_8<span class="token operator">:</span>
			key <span class="token operator">=</span> codepoint <span class="token operator">=</span> <span class="token string">'8'</span><span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_KP_9<span class="token operator">:</span>
			key <span class="token operator">=</span> codepoint <span class="token operator">=</span> <span class="token string">'9'</span><span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_KP_DIVIDE<span class="token operator">:</span>
			key <span class="token operator">=</span> codepoint <span class="token operator">=</span> <span class="token string">'/'</span><span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_KP_MULTIPLY<span class="token operator">:</span>
			key <span class="token operator">=</span> codepoint <span class="token operator">=</span> <span class="token string">'*'</span><span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_KP_SUBTRACT<span class="token operator">:</span>
			key <span class="token operator">=</span> codepoint <span class="token operator">=</span> <span class="token string">'-'</span><span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_KP_ADD<span class="token operator">:</span>
			key <span class="token operator">=</span> codepoint <span class="token operator">=</span> <span class="token string">'+'</span><span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_KP_DECIMAL<span class="token operator">:</span>
			key <span class="token operator">=</span> codepoint <span class="token operator">=</span> <span class="token string">'.'</span><span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> GLFW_KEY_KP_EQUAL<span class="token operator">:</span>
			key <span class="token operator">=</span> codepoint <span class="token operator">=</span> <span class="token string">'='</span><span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">default</span><span class="token operator">:</span>
			codepoint <span class="token operator">=</span> <span class="token function">keycodeToUnicode</span><span class="token punctuation">(</span>instance<span class="token punctuation">,</span> scancode<span class="token punctuation">,</span> mods<span class="token punctuation">)</span><span class="token punctuation">;</span>
			key <span class="token operator">=</span> codepoint<span class="token punctuation">;</span>
		    <span class="token keyword">break</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">int</span> modifiers <span class="token operator">=</span> <span class="token function">glfwtToOFModifiers</span><span class="token punctuation">(</span>mods<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span><span class="token punctuation">(</span>action <span class="token operator">==</span> GLFW_PRESS<span class="token punctuation">)</span><span class="token punctuation">{</span>
		ofKeyEventArgs <span class="token function">keyE</span><span class="token punctuation">(</span>ofKeyEventArgs<span class="token operator">::</span>Pressed<span class="token punctuation">,</span>key<span class="token punctuation">,</span>keycode<span class="token punctuation">,</span>scancode<span class="token punctuation">,</span>codepoint<span class="token punctuation">,</span>modifiers<span class="token punctuation">)</span><span class="token punctuation">;</span>
		instance<span class="token operator">-</span><span class="token operator">></span><span class="token function">events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">notifyKeyEvent</span><span class="token punctuation">(</span>keyE<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>action <span class="token operator">==</span> GLFW_REPEAT<span class="token punctuation">)</span><span class="token punctuation">{</span>
		ofKeyEventArgs <span class="token function">keyE</span><span class="token punctuation">(</span>ofKeyEventArgs<span class="token operator">::</span>Pressed<span class="token punctuation">,</span>key<span class="token punctuation">,</span>keycode<span class="token punctuation">,</span>scancode<span class="token punctuation">,</span>codepoint<span class="token punctuation">,</span>modifiers<span class="token punctuation">)</span><span class="token punctuation">;</span>
		keyE<span class="token punctuation">.</span>isRepeat <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
		instance<span class="token operator">-</span><span class="token operator">></span><span class="token function">events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">notifyKeyEvent</span><span class="token punctuation">(</span>keyE<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>action <span class="token operator">==</span> GLFW_RELEASE<span class="token punctuation">)</span><span class="token punctuation">{</span>
		ofKeyEventArgs <span class="token function">keyE</span><span class="token punctuation">(</span>ofKeyEventArgs<span class="token operator">::</span>Released<span class="token punctuation">,</span>key<span class="token punctuation">,</span>keycode<span class="token punctuation">,</span>scancode<span class="token punctuation">,</span>codepoint<span class="token punctuation">,</span>modifiers<span class="token punctuation">)</span><span class="token punctuation">;</span>
		instance<span class="token operator">-</span><span class="token operator">></span><span class="token function">events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">notifyKeyEvent</span><span class="token punctuation">(</span>keyE<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">char_cb</span><span class="token punctuation">(</span>GLFWwindow<span class="token operator">*</span> windowP_<span class="token punctuation">,</span> uint32_t key<span class="token punctuation">)</span><span class="token punctuation">{</span>
	ofAppGLFWWindow <span class="token operator">*</span> instance <span class="token operator">=</span> <span class="token function">setCurrent</span><span class="token punctuation">(</span>windowP_<span class="token punctuation">)</span><span class="token punctuation">;</span>
	instance<span class="token operator">-</span><span class="token operator">></span><span class="token function">events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>charEvent<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">resize_cb</span><span class="token punctuation">(</span>GLFWwindow<span class="token operator">*</span> windowP_<span class="token punctuation">,</span> <span class="token keyword">int</span> w<span class="token punctuation">,</span> <span class="token keyword">int</span> h<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	ofAppGLFWWindow <span class="token operator">*</span> instance <span class="token operator">=</span> <span class="token function">setCurrent</span><span class="token punctuation">(</span>windowP_<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment" spellcheck="true">// Detect if the window is running in a retina mode</span>

	<span class="token keyword">int</span> framebufferW<span class="token punctuation">,</span> framebufferH<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// &lt;- physical pixel extents</span>
	<span class="token function">glfwGetFramebufferSize</span><span class="token punctuation">(</span>windowP_<span class="token punctuation">,</span> <span class="token operator">&</span>framebufferW<span class="token punctuation">,</span> <span class="token operator">&</span>framebufferH<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">int</span> windowW<span class="token punctuation">,</span> windowH<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// &lt;- screen coordinates, which may be scaled</span>
	<span class="token function">glfwGetWindowSize</span><span class="token punctuation">(</span>windowP_<span class="token punctuation">,</span> <span class="token operator">&</span>windowW<span class="token punctuation">,</span> <span class="token operator">&</span>windowH<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment" spellcheck="true">// Find scale factor needed to transform from screen coordinates</span>
	<span class="token comment" spellcheck="true">// to physical pixel coordinates</span>
	instance<span class="token operator">-</span><span class="token operator">></span>pixelScreenCoordScale <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>framebufferW <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>windowW<span class="token punctuation">;</span>

	<span class="token keyword">if</span><span class="token punctuation">(</span>instance<span class="token operator">-</span><span class="token operator">></span>settings<span class="token punctuation">.</span>windowMode <span class="token operator">==</span> OF_WINDOW<span class="token punctuation">)</span><span class="token punctuation">{</span>
		instance<span class="token operator">-</span><span class="token operator">></span>windowW <span class="token operator">=</span> framebufferW<span class="token punctuation">;</span>
		instance<span class="token operator">-</span><span class="token operator">></span>windowH <span class="token operator">=</span> framebufferH<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	instance<span class="token operator">-</span><span class="token operator">></span>currentW <span class="token operator">=</span> windowW<span class="token punctuation">;</span>
	instance<span class="token operator">-</span><span class="token operator">></span>currentH <span class="token operator">=</span> windowH<span class="token punctuation">;</span>
	instance<span class="token operator">-</span><span class="token operator">></span><span class="token function">events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">notifyWindowResized</span><span class="token punctuation">(</span>framebufferW<span class="token punctuation">,</span> framebufferH<span class="token punctuation">)</span><span class="token punctuation">;</span>
	instance<span class="token operator">-</span><span class="token operator">></span>nFramesSinceWindowResized <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">framebuffer_size_cb</span><span class="token punctuation">(</span>GLFWwindow<span class="token operator">*</span> windowP_<span class="token punctuation">,</span> <span class="token keyword">int</span> w<span class="token punctuation">,</span> <span class="token keyword">int</span> h<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">resize_cb</span><span class="token punctuation">(</span>windowP_<span class="token punctuation">,</span> w<span class="token punctuation">,</span> h<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//--------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">exit_cb</span><span class="token punctuation">(</span>GLFWwindow<span class="token operator">*</span> windowP_<span class="token punctuation">)</span><span class="token punctuation">{</span>
	ofAppGLFWWindow <span class="token operator">*</span> instance <span class="token operator">=</span> <span class="token function">setCurrent</span><span class="token punctuation">(</span>windowP_<span class="token punctuation">)</span><span class="token punctuation">;</span>
	instance<span class="token operator">-</span><span class="token operator">></span><span class="token function">events</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">notifyExit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">setVerticalSync</span><span class="token punctuation">(</span><span class="token keyword">bool</span> bVerticalSync<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>bVerticalSync<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">glfwSwapInterval</span><span class="token punctuation">(</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
		<span class="token function">glfwSwapInterval</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">setClipboardString</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&</span> text<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">glfwSetClipboardString</span><span class="token punctuation">(</span>ofAppGLFWWindow<span class="token operator">::</span>windowP<span class="token punctuation">,</span> text<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
string ofAppGLFWWindow<span class="token operator">::</span><span class="token function">getClipboardString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> clipboard <span class="token operator">=</span> <span class="token function">glfwGetClipboardString</span><span class="token punctuation">(</span>ofAppGLFWWindow<span class="token operator">::</span>windowP<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>clipboard<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> clipboard<span class="token punctuation">;</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">listVideoModes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">glfwInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> numModes<span class="token punctuation">;</span>
	<span class="token keyword">const</span> GLFWvidmode <span class="token operator">*</span> vidModes <span class="token operator">=</span> <span class="token function">glfwGetVideoModes</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">,</span> <span class="token operator">&</span>numModes <span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>numModes<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token function">ofLogNotice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> vidModes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>width <span class="token operator">&lt;&lt;</span> <span class="token string">" x "</span> <span class="token operator">&lt;&lt;</span> vidModes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>height
		<span class="token operator">&lt;&lt;</span> vidModes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>redBits<span class="token operator">+</span>vidModes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>greenBits<span class="token operator">+</span>vidModes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>blueBits <span class="token operator">&lt;&lt;</span> <span class="token string">"bit"</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">listMonitors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">glfwInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> count<span class="token punctuation">;</span>
	<span class="token keyword">const</span> <span class="token keyword">auto</span> monitors <span class="token operator">=</span> <span class="token function">glfwGetMonitors</span><span class="token punctuation">(</span><span class="token operator">&</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>count<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">auto</span> monitor <span class="token operator">=</span> monitors<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token keyword">int</span> w<span class="token punctuation">,</span>h<span class="token punctuation">,</span>x<span class="token punctuation">,</span>y<span class="token punctuation">;</span>
		<span class="token function">glfwGetMonitorPhysicalSize</span><span class="token punctuation">(</span>monitor<span class="token punctuation">,</span><span class="token operator">&</span>w<span class="token punctuation">,</span><span class="token operator">&</span>h<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">glfwGetMonitorPos</span><span class="token punctuation">(</span>monitor<span class="token punctuation">,</span><span class="token operator">&</span>x<span class="token punctuation">,</span><span class="token operator">&</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">ofLogNotice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> i <span class="token operator">&lt;&lt;</span> <span class="token string">": "</span> <span class="token operator">&lt;&lt;</span> <span class="token function">glfwGetMonitorName</span><span class="token punctuation">(</span>monitor<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">", physical size: "</span> <span class="token operator">&lt;&lt;</span> w <span class="token operator">&lt;&lt;</span> <span class="token string">"x"</span> <span class="token operator">&lt;&lt;</span> h <span class="token operator">&lt;&lt;</span> <span class="token string">"mm at "</span> <span class="token operator">&lt;&lt;</span> x <span class="token operator">&lt;&lt;</span> <span class="token string">", "</span> <span class="token operator">&lt;&lt;</span> y<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">bool</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">isWindowIconified</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token function">glfwGetWindowAttrib</span><span class="token punctuation">(</span>windowP<span class="token punctuation">,</span> GLFW_ICONIFIED<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">bool</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">isWindowActive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token comment" spellcheck="true">//	return glfwGetWindowParam(GLFW_ACTIVE);</span>
	<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">bool</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">isWindowResizeable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">!</span><span class="token function">glfwGetWindowAttrib</span><span class="token punctuation">(</span>windowP<span class="token punctuation">,</span> GLFW_RESIZABLE<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">//------------------------------------------------------------</span>
<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">iconify</span><span class="token punctuation">(</span><span class="token keyword">bool</span> bIconify<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>bIconify<span class="token punctuation">)</span>
		<span class="token function">glfwIconifyWindow</span><span class="token punctuation">(</span>windowP<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">else</span>
		<span class="token function">glfwRestoreWindow</span><span class="token punctuation">(</span>windowP<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>



<span class="token keyword">void</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">makeCurrent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">glfwMakeContextCurrent</span><span class="token punctuation">(</span>windowP<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token macro property">#<span class="token directive keyword">if</span> defined(TARGET_LINUX)</span>
Display<span class="token operator">*</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">getX11Display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token function">glfwGetX11Display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

Window ofAppGLFWWindow<span class="token operator">::</span><span class="token function">getX11Window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token function">glfwGetX11Window</span><span class="token punctuation">(</span>windowP<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

XIC	ofAppGLFWWindow<span class="token operator">::</span><span class="token function">getX11XIC</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> xic<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>

<span class="token macro property">#<span class="token directive keyword">if</span> defined(TARGET_LINUX) && !defined(TARGET_OPENGLES)</span>
GLXContext ofAppGLFWWindow<span class="token operator">::</span><span class="token function">getGLXContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token function">glfwGetGLXContext</span><span class="token punctuation">(</span>windowP<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>

<span class="token macro property">#<span class="token directive keyword">if</span> defined(TARGET_LINUX) && defined(TARGET_OPENGLES)</span>
EGLDisplay ofAppGLFWWindow<span class="token operator">::</span><span class="token function">getEGLDisplay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token function">glfwGetEGLDisplay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

EGLContext ofAppGLFWWindow<span class="token operator">::</span><span class="token function">getEGLContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token function">glfwGetEGLContext</span><span class="token punctuation">(</span>windowP<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

EGLSurface ofAppGLFWWindow<span class="token operator">::</span><span class="token function">getEGLSurface</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token function">glfwGetEGLSurface</span><span class="token punctuation">(</span>windowP<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>

<span class="token macro property">#<span class="token directive keyword">if</span> defined(TARGET_OSX)</span>
<span class="token keyword">void</span> <span class="token operator">*</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">getNSGLContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token function">glfwGetNSGLContext</span><span class="token punctuation">(</span>windowP<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token operator">*</span> ofAppGLFWWindow<span class="token operator">::</span><span class="token function">getCocoaWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token function">glfwGetCocoaWindow</span><span class="token punctuation">(</span>windowP<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>

<span class="token macro property">#<span class="token directive keyword">if</span> defined(TARGET_WIN32)</span>
HGLRC ofAppGLFWWindow<span class="token operator">::</span><span class="token function">getWGLContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token function">glfwGetWGLContext</span><span class="token punctuation">(</span>windowP<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

HWND ofAppGLFWWindow<span class="token operator">::</span><span class="token function">getWin32Window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token function">glfwGetWin32Window</span><span class="token punctuation">(</span>windowP<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token macro property">#<span class="token directive keyword">endif</span></span>
</code></pre></div></div></div></div></div></div></div></div><script defer src="/_nuxt/payloads/1586012716389/openframeworks/app/ofAppGLFWWindow_cpp/payload.js"></script><script src="/_nuxt/5f71eaca0bd2f1a0f939.js" defer></script><script src="/_nuxt/35a90d914f539af1362f.js" defer></script><script src="/_nuxt/906a3ca0fb13ed3c6651.js" defer></script><script src="/_nuxt/b673915e8a08acf593e8.js" defer></script><script src="/_nuxt/bf355f21967a23c26c07.js" defer></script>
  </body>
</html>
